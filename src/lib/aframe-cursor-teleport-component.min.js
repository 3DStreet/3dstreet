!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(this,(function(){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("cursor-teleport",{schema:{cameraHead:{type:"string",default:""},cameraRig:{type:"string",default:""},collisionEntities:{type:"string",default:""},ignoreEntities:{type:"string",default:""},landingMaxAngle:{default:"45",min:0,max:360},landingNormal:{type:"vec3",default:"0 1 0"}},init:function(){console.log("Fixed self"),teleporter=this,teleporter.mobile=AFRAME.utils.device.isMobile(),teleporter.scene=this.el.sceneEl,teleporter.canvas=teleporter.scene.renderer.domElement,document.querySelector(this.data.cameraHead).object3D.traverse((function(e){e instanceof THREE.Camera&&(teleporter.cam=e)})),teleporter.camPos=new THREE.Vector3,teleporter.camRig=document.querySelector(this.data.cameraRig).object3D,teleporter.camPos=teleporter.camRig.position,teleporter.rayCaster=new THREE.Raycaster,teleporter.referenceNormal=new THREE.Vector3,teleporter.rayCastObjects=[],teleporter.referenceNormal.copy(this.data.landingNormal);var e=new THREE.RingGeometry(.25,.3,32,1);e.rotateX(-Math.PI/2),e.translate(0,.02,0);var t=new THREE.MeshBasicMaterial({color:7818734}),r=new THREE.Mesh(e,t),o=new THREE.CylinderGeometry(.3,.3,.5,32,1,!0);o.translate(0,.25,0);const n=(new THREE.TextureLoader).load("data:image/png;base64,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");var a=new THREE.MeshBasicMaterial({color:7818734,side:"double",map:n,transparent:!0,depthTest:!1}),i=new THREE.Mesh(o,a);const s=new THREE.Group;function l(e,t){var r=e.getBoundingClientRect();return null!=t.clientX?{x:t.clientX-r.left,y:t.clientY-r.top}:null!=t.touches[0]?{x:t.touches[0].clientX-r.left,y:t.touches[0].clientY-r.top}:void 0}function p(e){var t=l(teleporter.canvas,e);teleporter.mouseX=t.x,teleporter.mouseY=t.y}function c(e){teleporter.updateRaycastObjects();var t=l(teleporter.canvas,e);teleporter.mouseX=t.x,teleporter.mouseY=t.y,teleporter.mouseXOrig=t.x,teleporter.mouseYOrig=t.y}function u(e){if(teleporter.mouseX==teleporter.mouseXOrig&&teleporter.mouseY==teleporter.mouseYOrig){var t=teleporter.getTeleportPosition(teleporter.mouseX,teleporter.mouseY);t&&(teleporter.teleportIndicator.position.x=t.x,teleporter.teleportIndicator.position.y=t.y,teleporter.teleportIndicator.position.z=t.z,teleporter.transition(t))}}s.add(r),s.add(i),teleporter.teleportIndicator=s,teleporter.scene.object3D.add(teleporter.teleportIndicator),teleporter.transitioning=!1,teleporter.transitionProgress=0,teleporter.transitionSpeed=.01,teleporter.transitionCamPosStart=new THREE.Vector3,teleporter.transitionCamPosEnd=new THREE.Vector3,teleporter.updateRaycastObjects=function(){if(teleporter.rayCastObjects=[],""!=this.data.collisionEntities){teleporter.scene.querySelectorAll(this.data.collisionEntities).forEach(e=>{e.object3D.traverse((function(e){e instanceof THREE.Mesh&&(e.userData.collision=!0,teleporter.rayCastObjects.push(e))}))})}else{var e=new THREE.PlaneGeometry(500,500,1);e.rotateX(-Math.PI/2);var t=new THREE.MeshNormalMaterial,r=new THREE.Mesh(e,t);r.userData.collision=!0,teleporter.rayCastObjects.push(r)}""!=this.data.ignoreEntities&&teleporter.scene.querySelectorAll(this.data.ignoreEntities).forEach(e=>{e.object3D.traverse((function(e){e instanceof THREE.Mesh&&teleporter.rayCastObjects.push(e)}))})},teleporter.getTeleportPosition=function(e,t){if(0!=teleporter.rayCastObjects.length){if(teleporter.hasOwnProperty("cam")&&teleporter.hasOwnProperty("canvas")){var r=teleporter.cam,o=teleporter.canvas.getBoundingClientRect(),n=new THREE.Vector2;n.x=e/(o.right-o.left)*2-1,n.y=-t/(o.bottom-o.top)*2+1,teleporter.rayCaster.setFromCamera(n,r);var a=teleporter.rayCaster.intersectObjects(teleporter.rayCastObjects);return!(0==a.length||!teleporter.isValidNormalsAngle(a[0].face.normal))&&(1==a[0].object.userData.collision&&a[0].point)}return!1}return!1},teleporter.isValidNormalsAngle=function(e){var t=teleporter.referenceNormal.angleTo(e);return THREE.Math.RAD2DEG*t<=this.data.landingMaxAngle},teleporter.transition=function(e){teleporter.transitionProgress=0,teleporter.transitionCamPosEnd.x=e.x,teleporter.transitionCamPosEnd.y=e.y,teleporter.transitionCamPosEnd.z=e.z,teleporter.transitionCamPosStart.x=teleporter.camPos.x,teleporter.transitionCamPosStart.y=teleporter.camPos.y,teleporter.transitionCamPosStart.z=teleporter.camPos.z,teleporter.transitioning=!0},teleporter.updateRaycastObjects(),teleporter.canvas.addEventListener("mousedown",c,!1),teleporter.canvas.addEventListener("mousemove",p,!1),teleporter.canvas.addEventListener("mouseup",u,!1),teleporter.canvas.addEventListener("touchstart",c,!1),teleporter.canvas.addEventListener("touchmove",p,!1),teleporter.canvas.addEventListener("touchend",u,!1),teleporter.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1}},tick:function(){if(!teleporter.transitioning&&!teleporter.mobile){var e=teleporter.getTeleportPosition(teleporter.mouseX,teleporter.mouseY);!teleporter.mobile&&e&&(teleporter.teleportIndicator.position.x=e.x,teleporter.teleportIndicator.position.y=e.y,teleporter.teleportIndicator.position.z=e.z)}teleporter.transitioning&&(teleporter.transitionProgress+=teleporter.transitionSpeed,teleporter.camPos.x=teleporter.transitionCamPosStart.x+(teleporter.transitionCamPosEnd.x-teleporter.transitionCamPosStart.x)*teleporter.easeInOutQuad(teleporter.transitionProgress),teleporter.camPos.y=teleporter.transitionCamPosStart.y+(teleporter.transitionCamPosEnd.y-teleporter.transitionCamPosStart.y)*teleporter.easeInOutQuad(teleporter.transitionProgress),teleporter.camPos.z=teleporter.transitionCamPosStart.z+(teleporter.transitionCamPosEnd.z-teleporter.transitionCamPosStart.z)*teleporter.easeInOutQuad(teleporter.transitionProgress),teleporter.transitionProgress>=1&&(teleporter.transitioning=!1))}})}])}));