{"version":3,"file":"aframe-street-component.js","mappings":"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","sources":["webpack://3dstreet/webpack/universalModuleDefinition","webpack://3dstreet/./node_modules/aframe-atlas-uvs-component/index.js","webpack://3dstreet/./src/aframe-streetmix-parsers.js","webpack://3dstreet/./src/assets.js","webpack://3dstreet/./src/components/create-from-json.js","webpack://3dstreet/./src/components/gltf-part.js","webpack://3dstreet/./src/components/notify.js","webpack://3dstreet/./src/components/ocean.js","webpack://3dstreet/./src/components/screentock.js","webpack://3dstreet/./src/components/street-geo.js","webpack://3dstreet/./src/components/streetplan-loader.js","webpack://3dstreet/./src/components/svg-extruder.js","webpack://3dstreet/./src/json-utils_1.1.js","webpack://3dstreet/./src/lib/SVGLoader.js","webpack://3dstreet/./src/lib/aframe-cursor-teleport-component.min.js","webpack://3dstreet/./src/lib/animation-mixer.js","webpack://3dstreet/./src/lib/notyf.min.js","webpack://3dstreet/./src/segments-variants.js","webpack://3dstreet/./src/streetplan/conversion-map.js","webpack://3dstreet/./src/streetplan/streetplan-utils.js","webpack://3dstreet/./src/tested/aframe-streetmix-parsers-tested.js","webpack://3dstreet/./src/tested/create-from-json-utils-tested.js","webpack://3dstreet/./src/tested/streetmix-utils.js","webpack://3dstreet/webpack/bootstrap","webpack://3dstreet/webpack/runtime/node module decorator","webpack://3dstreet/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, () => {\nreturn ","// For aux use.\r\nvar uvs = [\r\n  new THREE.Vector2(),\r\n  new THREE.Vector2(),\r\n  new THREE.Vector2(),\r\n  new THREE.Vector2()\r\n];\r\n\r\n/**\r\n * 1-indexed.\r\n */\r\nAFRAME.registerComponent('atlas-uvs', {\r\n  dependencies: ['geometry'],\r\n\r\n  schema: {\r\n    totalColumns: {type: 'int', default: 1},\r\n    totalRows: {type: 'int', default: 1},\r\n    column: {type: 'int', default: 1},\r\n    row: {type: 'int', default: 1}\r\n  },\r\n\r\n  update: function () {\r\n    const data = this.data;\r\n    const uvs = getGridUvs(data.row - 1, data.column - 1, data.totalRows, data.totalColumns);\r\n\r\n    const geometry = this.el.getObject3D('mesh').geometry;\r\n\r\n    var float32Array = new Float32Array([uvs[0].x, uvs[0].y, uvs[3].x, uvs[3].y, uvs[1].x, uvs[1].y, uvs[2].x, uvs[2].y]);\r\n    geometry.setAttribute('uv', new THREE.BufferAttribute(float32Array, 2));\r\n    geometry.uvsNeedUpdate = true;\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent('dynamic-texture-atlas', {\r\n  schema: {\r\n    canvasId: {default: 'dynamicAtlas'},\r\n    canvasHeight: {default: 1024},\r\n    canvasWidth: {default: 1024},\r\n    debug: {default: false},\r\n    numColumns: {default: 8},\r\n    numRows: {default: 8}\r\n  },\r\n\r\n  multiple: true,\r\n\r\n  init: function () {\r\n    const canvas = this.canvas = document.createElement('canvas');\r\n    canvas.id = this.data.canvasId;\r\n    canvas.height = this.data.canvasHeight;\r\n    canvas.width = this.data.canvasWidth;\r\n    this.ctx = canvas.getContext('2d');\r\n    document.body.appendChild(canvas);\r\n\r\n    if (this.data.debug) {\r\n      canvas.style.left = 0;\r\n      canvas.style.top = 0;\r\n      canvas.style.position = 'fixed';\r\n      canvas.style.zIndex = 9999999999;\r\n    }\r\n  },\r\n\r\n  drawTexture: function (image, row, column, width, height) {\r\n    const canvas = this.canvas;\r\n    const data = this.data;\r\n\r\n    if (!image.complete) {\r\n      image.onload = () => { this.drawTexture(image, row, column); }\r\n    }\r\n\r\n    const gridHeight = height || (canvas.height / data.numRows);\r\n    const gridWidth = width || (canvas.width / data.numColumns);\r\n\r\n    // image, dx, dy, dwidth, dheight\r\n    this.ctx.drawImage(image, gridWidth * row, gridWidth * column, gridWidth, gridHeight);\r\n\r\n    // Return UVs.\r\n    return getGridUvs(row, column, data.numRows, data.numColumns);\r\n  }\r\n});\r\n\r\n/**\r\n * Return UVs for an texture within an atlas, given the row and column info.\r\n */\r\nfunction getGridUvs (row, column, totalRows, totalColumns) {\r\n  const columnWidth = 1 / totalColumns;\r\n  const rowHeight = 1 / totalRows;\r\n\r\n  // create a Map called `uvs` to hold the 4 UV pairs\r\n  uvs[0].set(columnWidth * column,\r\n             rowHeight * row + rowHeight);\r\n  uvs[1].set(columnWidth * column,\r\n             rowHeight * row);\r\n  uvs[2].set(columnWidth * column + columnWidth,\r\n             rowHeight * row);\r\n  uvs[3].set(columnWidth * column + columnWidth,\r\n             rowHeight * row + rowHeight);\r\n  return uvs;\r\n}\r\nmodule.exports.getGridUvs = getGridUvs;\r\n","/* global THREE */\n\n// Orientation - default model orientation is \"outbound\" (away from camera)\nvar streetmixParsersTested = require('./tested/aframe-streetmix-parsers-tested');\nvar { segmentVariants } = require('./segments-variants.js');\n\nfunction cloneMixinAsChildren({\n  objectMixinId = '',\n  parentEl = null,\n  step = 15,\n  radius = 60,\n  rotation = '0 0 0',\n  positionXYString = '0 0',\n  length = undefined,\n  randomY = false\n}) {\n  for (let j = radius * -1; j <= radius; j = j + step) {\n    const placedObjectEl = document.createElement('a-entity');\n    placedObjectEl.setAttribute('mixin', objectMixinId);\n    placedObjectEl.setAttribute('class', objectMixinId);\n    placedObjectEl.setAttribute('position', positionXYString + ' ' + j);\n\n    if (length) {\n      placedObjectEl.addEventListener('loaded', (evt) => {\n        evt.target.setAttribute('geometry', 'height', length);\n        evt.target.setAttribute('atlas-uvs', 'c', 1);\n      });\n    }\n\n    if (randomY) {\n      placedObjectEl.setAttribute(\n        'rotation',\n        '0 ' + Math.floor(randomTestable() * 361) + ' 0'\n      );\n    } else {\n      placedObjectEl.setAttribute('rotation', rotation);\n    }\n    // add the new elmement to DOM\n    parentEl.append(placedObjectEl);\n    // could be good to use geometry merger https://github.com/supermedium/superframe/tree/master/components/geometry-merger\n  }\n}\n\nfunction randomTestable() {\n  return Math.random();\n}\n\n// this function takes a list of segments and adds lane markings or \"separator segments\"\n// these are 0 width segments inserted into the street json prior to rendering\n// the basic logic is: if there are two adjacent \"lane-ish\" segments, then add lane separators\nfunction insertSeparatorSegments(segments) {\n  // first, let's define what is a lane that will likely need adajcent striping?\n  function isLaneIsh(typeString) {\n    return (\n      typeString.slice(typeString.length - 4) === 'lane' ||\n      typeString === 'light-rail' ||\n      typeString === 'streetcar' ||\n      typeString === 'flex-zone'\n    );\n  }\n\n  // then let's go through the segments array and build a new one with inserted separators\n  const newValues = segments.reduce(\n    (newArray, currentValue, currentIndex, arr) => {\n      // don't insert a lane marker before the first segment\n      if (currentIndex === 0) {\n        return newArray.concat(currentValue);\n      }\n\n      const previousValue = arr[currentIndex - 1];\n\n      // if both adjacent lanes are \"laneish\"\n      if (isLaneIsh(currentValue.type) && isLaneIsh(previousValue.type)) {\n        // if in doubt start with a solid line\n        var variantString = 'solid';\n\n        // if adjacent lane types are identical, then used dashed lines\n        if (currentValue.type === previousValue.type) {\n          variantString = 'dashed';\n        }\n\n        // Or, if either is a drive lane or turn lane then use dashed\n        // Using dash vs solid for turn lanes along approach to intersections may need to be user defined\n        if (\n          (currentValue.type === 'drive-lane' &&\n            previousValue.type === 'turn-lane') ||\n          (previousValue.type === 'drive-lane' &&\n            currentValue.type === 'turn-lane')\n        ) {\n          variantString = 'dashed';\n        }\n\n        // if adjacent segments in opposite directions then use double yellow\n        if (\n          currentValue.variantString.split('|')[0] !==\n          previousValue.variantString.split('|')[0]\n        ) {\n          variantString = 'doubleyellow';\n          // if adjacenet segments are both bike lanes, then use yellow short dash\n          if (\n            currentValue.type === 'bike-lane' &&\n            previousValue.type === 'bike-lane'\n          ) {\n            variantString = 'shortdashedyellow';\n          }\n          if (\n            currentValue.type === 'flex-zone' ||\n            previousValue.type === 'flex-zone'\n          ) {\n            variantString = 'solid';\n          }\n        }\n\n        // special case -- if either lanes are turn lane shared, then use solid and long dash\n        if (\n          currentValue.type === 'turn-lane' &&\n          currentValue.variantString.split('|')[1] === 'shared'\n        ) {\n          variantString = 'soliddashedyellow';\n        } else if (\n          previousValue.type === 'turn-lane' &&\n          previousValue.variantString.split('|')[1] === 'shared'\n        ) {\n          variantString = 'soliddashedyellowinverted';\n        }\n\n        // if adjacent to parking lane with markings, do not draw white line\n        if (\n          currentValue.type === 'parking-lane' ||\n          previousValue.type === 'parking-lane'\n        ) {\n          variantString = 'invisible';\n        }\n\n        newArray.push({\n          type: 'separator',\n          variantString: variantString,\n          width: 0,\n          elevation: currentValue.elevation\n        });\n      }\n\n      // if a *lane segment and divider are adjacent, use a solid separator\n      if (\n        (isLaneIsh(currentValue.type) && previousValue.type === 'divider') ||\n        (isLaneIsh(previousValue.type) && currentValue.type === 'divider')\n      ) {\n        newArray.push({\n          type: 'separator',\n          variantString: 'solid',\n          width: 0,\n          elevation: currentValue.elevation\n        });\n      }\n\n      newArray.push(currentValue);\n      return newArray;\n    },\n    []\n  );\n\n  // console.log('newValues =', newValues)\n  // console.log(segments);\n\n  return newValues;\n}\n\nfunction createStencilsParentElement(position) {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'stencils-parent');\n  placedObjectEl.setAttribute('position', position); // position=\"1.043 0.100 -3.463\"\n  return placedObjectEl;\n}\n\nfunction createRailsElement(length, railsPosX) {\n  const placedObjectEl = document.createElement('a-entity');\n  const railsGeometry = {\n    primitive: 'box',\n    depth: length,\n    width: 0.1,\n    height: 0.2\n  };\n  const railsMaterial = {\n    // TODO: Add environment map for reflection on metal rails\n    color: '#8f8f8f',\n    metalness: 1,\n    emissive: '#828282',\n    emissiveIntensity: 0.5,\n    roughness: 0.1\n  };\n  placedObjectEl.setAttribute('geometry', railsGeometry);\n  placedObjectEl.setAttribute('material', railsMaterial);\n  placedObjectEl.setAttribute('class', 'rails');\n  placedObjectEl.setAttribute('shadow', 'receive:true; cast: true');\n  placedObjectEl.setAttribute('position', railsPosX + ' 0.2 0'); // position=\"1.043 0.100 -3.463\"\n\n  return placedObjectEl;\n}\n\nfunction createTracksParentElement(length, objectMixinId) {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'track-parent');\n  placedObjectEl.setAttribute('position', '0 -0.2 0'); // position=\"1.043 0.100 -3.463\"\n  // add rails\n  const railsWidth = {\n    // width as measured from center of rail, so 1/2 actual width\n    tram: 0.7175, // standard gauge 1,435 mm\n    trolley: 0.5335 // sf cable car rail gauge 1,067 mm\n  };\n  const railsPosX = railsWidth[objectMixinId];\n  placedObjectEl.append(createRailsElement(length, railsPosX));\n  placedObjectEl.append(createRailsElement(length, -railsPosX));\n\n  return placedObjectEl;\n}\n\nfunction createSafehitsParentElement() {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'safehit-parent');\n  return placedObjectEl;\n}\n\nfunction createParentElement(className) {\n  const parentEl = document.createElement('a-entity');\n  parentEl.setAttribute('class', className);\n  return parentEl;\n}\n\nfunction createDividerVariant(variantName, clonedObjectRadius, step = 2.25) {\n  const dividerParentEl = createParentElement(`dividers-${variantName}-parent`);\n  cloneMixinAsChildren({\n    objectMixinId: `dividers-${variantName}`,\n    parentEl: dividerParentEl,\n    step: step,\n    radius: clonedObjectRadius\n  });\n  return dividerParentEl;\n}\n\nfunction createClonedVariants(\n  variantName,\n  clonedObjectRadius,\n  step = 2.25,\n  rotation = '0 0 0'\n) {\n  const dividerParentEl = createParentElement(`${variantName}-parent`);\n  cloneMixinAsChildren({\n    objectMixinId: variantName,\n    parentEl: dividerParentEl,\n    step: step,\n    radius: clonedObjectRadius,\n    rotation: rotation\n  });\n  return dividerParentEl;\n}\n\nfunction getRandomIntInclusive(min, max) {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1) + min);\n}\n\nfunction getRandomArbitrary(min, max) {\n  return Math.random() * (max - min) + min;\n}\n\nfunction getZPositions(start, end, step) {\n  const len = Math.floor((end - start) / step) + 1;\n  var arr = Array(len)\n    .fill()\n    .map((_, idx) => start + idx * step);\n  return arr.sort(() => 0.5 - Math.random());\n}\n\nfunction createSidewalkClonedVariants(\n  segmentWidthInMeters,\n  density,\n  elevationPosY = 0,\n  streetLength,\n  direction = 'random',\n  animated = false\n) {\n  const xValueRange = [\n    -(0.37 * segmentWidthInMeters),\n    0.37 * segmentWidthInMeters\n  ];\n  const zValueRange = getZPositions(\n    -0.5 * streetLength,\n    0.5 * streetLength,\n    1.5\n  );\n  const densityFactors = {\n    empty: 0,\n    sparse: 0.03,\n    normal: 0.125,\n    dense: 0.25\n  };\n  const totalPedestrianNumber = parseInt(\n    densityFactors[density] * streetLength,\n    10\n  );\n  const dividerParentEl = createParentElement('pedestrians-parent');\n  dividerParentEl.setAttribute('position', { y: elevationPosY });\n  // Randomly generate avatars\n  for (let i = 0; i < totalPedestrianNumber; i++) {\n    const variantName =\n      animated === true\n        ? 'a_char' + String(getRandomIntInclusive(1, 8))\n        : 'char' + String(getRandomIntInclusive(1, 16));\n    const xVal = getRandomArbitrary(xValueRange[0], xValueRange[1]);\n    const zVal = zValueRange.pop();\n    const yVal = 0;\n    // y = 0.2 for sidewalk elevation\n    const placedObjectEl = document.createElement('a-entity');\n    let animationDirection = 'inbound';\n    placedObjectEl.setAttribute('position', { x: xVal, y: yVal, z: zVal });\n    placedObjectEl.setAttribute('mixin', variantName);\n    // Roughly 50% of traffic will be incoming\n    if (Math.random() < 0.5 && direction === 'random') {\n      placedObjectEl.setAttribute('rotation', '0 180 0');\n      animationDirection = 'outbound';\n    }\n\n    if (animated) {\n      addLinearStreetAnimation(\n        placedObjectEl,\n        1.4,\n        streetLength,\n        xVal,\n        yVal,\n        zVal,\n        animationDirection\n      );\n    }\n    dividerParentEl.append(placedObjectEl);\n  }\n\n  return dividerParentEl;\n}\n\nfunction getBikeLaneMixin(variant) {\n  if (variant === 'red') {\n    return 'surface-red bike-lane';\n  }\n  if (variant === 'blue') {\n    return 'surface-blue bike-lane';\n  }\n  if (variant === 'green') {\n    return 'surface-green bike-lane';\n  }\n  return 'bike-lane';\n}\n\nfunction getBusLaneMixin(variant) {\n  if ((variant === 'colored') | (variant === 'red')) {\n    return 'surface-red bus-lane';\n  }\n  if (variant === 'blue') {\n    return 'surface-blue bus-lane';\n  }\n  if (variant === 'grass') {\n    return 'surface-green bus-lane';\n  }\n  return 'bus-lane';\n}\n\nfunction getDimensions(object3d) {\n  var box = new THREE.Box3().setFromObject(object3d);\n  var x = box.max.x - box.min.x;\n  var y = box.max.y - box.min.y;\n  var z = box.max.z - box.min.z;\n\n  return { x, y, z };\n}\n\nfunction getStartEndPosition(streetLength, objectLength) {\n  // get the start and end position for placing an object on a line\n  // computed by length of the street and object's length\n  const start = -0.5 * streetLength + 0.5 * objectLength;\n  const end = 0.5 * streetLength - 0.5 * objectLength;\n  return { start, end };\n}\n\nfunction randomPosition(entity, axis, length, objSizeAttr = undefined) {\n  // place randomly an element on a line length='length' on the axis 'axis'\n  // Need to call from 'model-loaded' event if objSizeAttr is undefined\n  // existEnts - array with existing entities (for prevent intersection)\n  const newObject = entity.object3D;\n  const objSize = objSizeAttr || getDimensions(newObject)[axis];\n  const { start, end } = getStartEndPosition(length, objSize);\n  const setFunc = `set${axis.toUpperCase()}`;\n  const newPosition = getRandomArbitrary(start, end);\n  newObject.position[setFunc](newPosition);\n  return newPosition;\n}\n\nfunction createChooChooElement(\n  variantList,\n  objectMixinId,\n  length,\n  showVehicles\n) {\n  if (!showVehicles) {\n    return;\n  }\n  const rotationY = variantList[0] === 'inbound' ? 0 : 180;\n  const placedObjectEl = document.createElement('a-entity');\n  const tramLength = 23;\n  placedObjectEl.setAttribute('rotation', '0 ' + rotationY + ' 0');\n  placedObjectEl.setAttribute('mixin', objectMixinId);\n  placedObjectEl.setAttribute('class', objectMixinId);\n  const positionZ = randomPosition(placedObjectEl, 'z', length, tramLength);\n  placedObjectEl.setAttribute('position', '0 0 ' + positionZ);\n  return placedObjectEl;\n}\n\nfunction createBusElement(variantList, length, showVehicles) {\n  if (!showVehicles) {\n    return;\n  }\n  const rotationY = variantList[0] === 'inbound' ? 0 : 180;\n  const busParentEl = document.createElement('a-entity');\n  const busLength = 12;\n  const busObjectEl = document.createElement('a-entity');\n  busObjectEl.setAttribute('rotation', '0 ' + rotationY + ' 0');\n  busObjectEl.setAttribute('mixin', 'bus');\n  const positionZ = randomPosition(busObjectEl, 'z', length, busLength);\n  busObjectEl.setAttribute('position', '0 0 ' + positionZ);\n  busParentEl.append(busObjectEl);\n\n  return busParentEl;\n}\n\nfunction addLinearStreetAnimation(\n  reusableObjectEl,\n  speed,\n  streetLength,\n  xPos,\n  yVal = 0,\n  zPos,\n  direction\n) {\n  const totalStreetDuration = (streetLength / speed) * 1000; // time in milliseconds\n  const halfStreet =\n    direction === 'outbound' ? -streetLength / 2 : streetLength / 2;\n  const startingDistanceToTravel = Math.abs(halfStreet - zPos);\n  const startingDuration = (startingDistanceToTravel / speed) * 1000;\n\n  const animationAttrs1 = {\n    property: 'position',\n    easing: 'linear',\n    loop: 'false',\n    from: { x: xPos, y: yVal, z: zPos },\n    to: { z: halfStreet },\n    dur: startingDuration\n  };\n  const animationAttrs2 = {\n    property: 'position',\n    easing: 'linear',\n    loop: 'true',\n    from: { x: xPos, y: yVal, z: -halfStreet },\n    to: { x: xPos, y: yVal, z: halfStreet },\n    delay: startingDuration,\n    dur: totalStreetDuration\n  };\n  reusableObjectEl.setAttribute('animation__1', animationAttrs1);\n  reusableObjectEl.setAttribute('animation__2', animationAttrs2);\n\n  return reusableObjectEl;\n}\n\nfunction createDriveLaneElement(\n  variantList,\n  segmentWidthInMeters,\n  streetLength,\n  animated = false,\n  showVehicles = true,\n  count = 1,\n  carStep = undefined\n) {\n  if (!showVehicles) {\n    return;\n  }\n  let speed = 0;\n  let [lineVariant, direction, carType] = variantList;\n  if (variantList.length === 2) {\n    carType = direction;\n    direction = lineVariant;\n  }\n\n  const rotationVariants = {\n    inbound: 0,\n    outbound: 180,\n    sideways: {\n      left: -90,\n      right: 90\n    },\n    'angled-front-left': -60,\n    'angled-front-right': 60,\n    'angled-rear-left': -120,\n    'angled-rear-right': 120\n  };\n  let rotationY;\n  if (lineVariant === 'sideways') {\n    rotationY = rotationVariants['sideways'][direction];\n  } else {\n    rotationY = rotationVariants[lineVariant];\n  }\n\n  if (carType === 'pedestrian') {\n    return createSidewalkClonedVariants(\n      segmentWidthInMeters,\n      'normal',\n      0,\n      streetLength,\n      direction,\n      animated\n    );\n  }\n\n  const driveLaneParentEl = document.createElement('a-entity');\n\n  if (variantList.length === 1) {\n    // if there is no cars\n    return driveLaneParentEl;\n  }\n\n  const carParams = {\n    car: {\n      mixin: 'sedan-rig',\n      wheelDiameter: 0.76,\n      length: 5.17,\n      width: 2\n    },\n    microvan: {\n      mixin: 'suv-rig',\n      wheelDiameter: 0.84,\n      length: 5,\n      width: 2\n    },\n    truck: {\n      mixin: 'box-truck-rig',\n      wheelDiameter: 1.05,\n      length: 6.95,\n      width: 2.5\n    },\n    // autonomous vehicle\n    av: {\n      mixin: 'self-driving-cruise-car-rig',\n      wheelDiameter: 0.76,\n      length: 5.17,\n      width: 2\n    }\n  };\n\n  // default drive-lane variant if selected variant (carType) is not supported\n  if (!carParams[carType]) {\n    carType = 'car';\n  }\n  function createCar(positionZ = undefined, carType = 'car') {\n    const params = carParams[carType];\n\n    const reusableObjectEl = document.createElement('a-entity');\n\n    if (!positionZ) {\n      positionZ = randomPosition(\n        reusableObjectEl,\n        'z',\n        streetLength,\n        params['length']\n      );\n    }\n    reusableObjectEl.setAttribute('position', `0 0 ${positionZ}`);\n    reusableObjectEl.setAttribute('mixin', params['mixin']);\n    reusableObjectEl.setAttribute('rotation', `0 ${rotationY} 0`);\n\n    if (animated) {\n      speed = 5; // meters per second\n      reusableObjectEl.setAttribute('wheel', {\n        speed: speed,\n        wheelDiameter: params['wheelDiameter']\n      });\n      addLinearStreetAnimation(\n        reusableObjectEl,\n        speed,\n        streetLength,\n        0,\n        0,\n        positionZ,\n        direction\n      );\n    }\n    driveLaneParentEl.append(reusableObjectEl);\n    return reusableObjectEl;\n  }\n\n  // create one or more randomly placed cars\n\n  if (count > 1) {\n    const halfStreet = streetLength / 2;\n    const halfParkingLength = carStep / 2 + carStep;\n    const allPlaces = getZPositions(\n      -halfStreet + halfParkingLength,\n      halfStreet - halfParkingLength,\n      carStep\n    );\n    const randPlaces = allPlaces.slice(0, count);\n    const carSizeZ =\n      lineVariant === 'sideways' || lineVariant.includes('angled')\n        ? 'width'\n        : 'length';\n\n    const carSizeValueZ = carParams[carType][carSizeZ];\n\n    randPlaces.forEach((randPositionZ) => {\n      const maxDist = carStep - carSizeValueZ - 0.2;\n      // randOffset is for randomly displacement in a parking space (+/- maxDist)\n      const randOffset = -maxDist / 2 + maxDist * Math.random();\n      if (maxDist > 0) {\n        // if the car fits in the parking space\n        const positionZ = randPositionZ + randOffset;\n        createCar(positionZ, carType);\n      }\n    });\n  } else {\n    createCar(undefined, carType);\n  }\n\n  return driveLaneParentEl;\n}\n\nfunction createFoodTruckElement(variantList, length) {\n  const foodTruckParentEl = document.createElement('a-entity');\n\n  const reusableObjectEl = document.createElement('a-entity');\n  const foodTruckLength = 7;\n  const rotationY = variantList[0] === 'left' ? 0 : 180;\n  reusableObjectEl.setAttribute('rotation', '0 ' + rotationY + ' 0');\n  reusableObjectEl.setAttribute('mixin', 'food-trailer-rig');\n\n  const positionZ = randomPosition(\n    reusableObjectEl,\n    'z',\n    length,\n    foodTruckLength\n  );\n  reusableObjectEl.setAttribute('positon', '0 0 ' + positionZ);\n  foodTruckParentEl.append(reusableObjectEl);\n\n  return foodTruckParentEl;\n}\n\nfunction createMagicCarpetElement(showVehicles) {\n  if (!showVehicles) {\n    return;\n  }\n  const magicCarpetParentEl = document.createElement('a-entity');\n\n  const reusableObjectEl1 = document.createElement('a-entity');\n  reusableObjectEl1.setAttribute('position', '0 1.75 0');\n  reusableObjectEl1.setAttribute('rotation', '0 0 0');\n  reusableObjectEl1.setAttribute('mixin', 'magic-carpet');\n  magicCarpetParentEl.append(reusableObjectEl1);\n  const reusableObjectEl2 = document.createElement('a-entity');\n  reusableObjectEl2.setAttribute('position', '0 1.75 0');\n  reusableObjectEl2.setAttribute('rotation', '0 0 0');\n  reusableObjectEl2.setAttribute('mixin', 'Character_1_M');\n  magicCarpetParentEl.append(reusableObjectEl2);\n\n  return magicCarpetParentEl;\n}\n\nfunction randPlacedElements(streetLength, objLength, count) {\n  const placeLength = objLength / 2 + objLength;\n  const allPlaces = getZPositions(\n    -streetLength / 2 + placeLength / 2,\n    streetLength / 2 - placeLength / 2,\n    placeLength\n  );\n  return allPlaces.slice(0, count);\n}\n\nfunction createOutdoorDining(length, posY) {\n  const outdoorDiningParentEl = document.createElement('a-entity');\n  const outdorDiningLength = 2.27;\n\n  const randPlaces = randPlacedElements(length, outdorDiningLength, 5);\n  randPlaces.forEach((randPosZ) => {\n    const reusableObjectEl = document.createElement('a-entity');\n    reusableObjectEl.setAttribute('mixin', 'outdoor_dining');\n\n    // const positionZ = randomPosition(reusableObjectEl, 'z', length, outdorDiningLength);\n    reusableObjectEl.setAttribute('position', { y: posY, z: randPosZ });\n    outdoorDiningParentEl.append(reusableObjectEl);\n  });\n\n  return outdoorDiningParentEl;\n}\n\nfunction createMicroMobilityElement(\n  variantList,\n  segmentType,\n  posY = 0,\n  length,\n  showVehicles,\n  animated = false\n) {\n  if (!showVehicles) {\n    return;\n  }\n  const microMobilityParentEl = document.createElement('a-entity');\n\n  const bikeLength = 2.03;\n  const bikeCount = getRandomIntInclusive(2, 5);\n\n  const cyclistMixins = [\n    'cyclist-cargo',\n    'cyclist1',\n    'cyclist2',\n    'cyclist3',\n    'cyclist-dutch',\n    'cyclist-kid'\n  ];\n\n  const countCyclist = cyclistMixins.length;\n  let mixinId = 'Bicycle_1';\n  const randPlaces = randPlacedElements(length, bikeLength, bikeCount);\n  randPlaces.forEach((randPosZ) => {\n    const reusableObjectEl = document.createElement('a-entity');\n    const rotationY = variantList[0] === 'inbound' ? 0 : 180;\n    reusableObjectEl.setAttribute('rotation', '0 ' + rotationY + ' 0');\n    reusableObjectEl.setAttribute('position', { y: posY, z: randPosZ });\n\n    if (animated) {\n      reusableObjectEl.setAttribute('animation-mixer', '');\n      const speed = 5;\n      addLinearStreetAnimation(\n        reusableObjectEl,\n        speed,\n        length,\n        0,\n        posY,\n        randPosZ,\n        variantList[0]\n      );\n    }\n    if (segmentType === 'bike-lane') {\n      mixinId = cyclistMixins[getRandomIntInclusive(0, countCyclist)];\n    } else {\n      mixinId = 'ElectricScooter_1';\n    }\n\n    reusableObjectEl.setAttribute('mixin', mixinId);\n    microMobilityParentEl.append(reusableObjectEl);\n  });\n\n  return microMobilityParentEl;\n}\n\nfunction createFlexZoneElement(variantList, length, showVehicles = true) {\n  if (!showVehicles) {\n    return;\n  }\n  const flexZoneParentEl = document.createElement('a-entity');\n  const carLength = 5;\n  const carCount = getRandomIntInclusive(2, 4);\n  const randPlaces = randPlacedElements(length, carLength, carCount);\n  randPlaces.forEach((randPosZ) => {\n    const reusableObjectEl = document.createElement('a-entity');\n    const rotationY = variantList[1] === 'inbound' ? 0 : 180;\n    reusableObjectEl.setAttribute('rotation', '0 ' + rotationY + ' 0');\n    if (variantList[0] === 'taxi') {\n      reusableObjectEl.setAttribute('mixin', 'sedan-taxi-rig');\n    } else if (variantList[0] === 'rideshare') {\n      reusableObjectEl.setAttribute('mixin', 'sedan-rig');\n    }\n    reusableObjectEl.setAttribute('position', { z: randPosZ });\n    flexZoneParentEl.append(reusableObjectEl);\n  });\n\n  return flexZoneParentEl;\n}\n\nfunction createWayfindingElements() {\n  const wayfindingParentEl = document.createElement('a-entity');\n  let reusableObjectEl;\n\n  reusableObjectEl = document.createElement('a-entity');\n  reusableObjectEl.setAttribute('position', '0 1 0');\n  reusableObjectEl.setAttribute('mixin', 'wayfinding-box');\n  wayfindingParentEl.append(reusableObjectEl);\n\n  reusableObjectEl = document.createElement('a-entity');\n  reusableObjectEl.setAttribute('position', '0 1.2 0.06');\n  reusableObjectEl.setAttribute(\n    'geometry',\n    'primitive: plane; width: 0.8; height: 1.6'\n  );\n  reusableObjectEl.setAttribute('material', 'src:#wayfinding-map');\n  wayfindingParentEl.append(reusableObjectEl);\n\n  reusableObjectEl = document.createElement('a-entity');\n  reusableObjectEl.setAttribute('position', '0 1.2 -0.06');\n  reusableObjectEl.setAttribute('rotation', '0 180 0');\n  reusableObjectEl.setAttribute(\n    'geometry',\n    'primitive: plane; width: 0.8; height: 1.6'\n  );\n  reusableObjectEl.setAttribute('material', 'src:#wayfinding-map');\n  wayfindingParentEl.append(reusableObjectEl);\n\n  return wayfindingParentEl;\n}\n\nfunction createBenchesParentElement() {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'bench-parent');\n  // y = 0.2 for sidewalk elevation\n  placedObjectEl.setAttribute('position', '0 0.2 3.5');\n  return placedObjectEl;\n}\n\nfunction createBikeRacksParentElement(posY) {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'bikerack-parent');\n  placedObjectEl.setAttribute('position', { y: posY, z: -3.5 });\n  return placedObjectEl;\n}\n\nfunction createBikeShareStationElement(variantList, posY) {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'bikeshare');\n  placedObjectEl.setAttribute('mixin', 'bikeshare');\n  const rotationCloneY = variantList[0] === 'left' ? 90 : 270;\n  placedObjectEl.setAttribute('rotation', '0 ' + rotationCloneY + ' 0');\n  placedObjectEl.setAttribute('position', { y: posY });\n  return placedObjectEl;\n}\n\nfunction createParkletElement(length, variantList) {\n  const parkletParent = document.createElement('a-entity');\n  const parkletLength = 4.03;\n  const parkletCount = 3;\n  const randPlaces = randPlacedElements(length, parkletLength, parkletCount);\n  randPlaces.forEach((randPosZ) => {\n    const placedObjectEl = document.createElement('a-entity');\n    placedObjectEl.setAttribute('class', 'parklet');\n    placedObjectEl.setAttribute('position', { x: 0, y: 0.02, z: randPosZ });\n    placedObjectEl.setAttribute('mixin', 'parklet');\n    const rotationY = variantList[0] === 'left' ? 90 : 270;\n    placedObjectEl.setAttribute('rotation', { y: rotationY });\n    parkletParent.append(placedObjectEl);\n  });\n  return parkletParent;\n}\n\nfunction createTreesParentElement() {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'tree-parent');\n  // y = 0.2 for sidewalk elevation\n  placedObjectEl.setAttribute('position', '0 0.2 7');\n  return placedObjectEl;\n}\n\nfunction createLampsParentElement() {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'lamp-parent');\n  // y = 0.2 for sidewalk elevation\n  placedObjectEl.setAttribute('position', '0 0.2 0'); // position=\"1.043 0.100 -3.463\"\n  return placedObjectEl;\n}\n\nfunction createBusStopElement(rotationBusStopY, posY) {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'bus-stop');\n  placedObjectEl.setAttribute('rotation', '0 ' + rotationBusStopY + ' 0');\n  placedObjectEl.setAttribute('mixin', 'bus-stop');\n  placedObjectEl.setAttribute('position', { y: posY });\n  return placedObjectEl;\n}\n\nfunction createBrtStationElement() {\n  const placedObjectEl = document.createElement('a-entity');\n  placedObjectEl.setAttribute('class', 'brt-station');\n  placedObjectEl.setAttribute('mixin', 'brt-station');\n  return placedObjectEl;\n}\n\n// offset to center the street around global x position of 0\nfunction createCenteredStreetElement(segments) {\n  const streetEl = document.createElement('a-entity');\n  const streetWidth = segments.reduce(\n    (streetWidth, segmentData) => streetWidth + segmentData.width,\n    0\n  );\n  const offset = 0 - streetWidth / 2;\n  streetEl.setAttribute('position', offset + ' 0 0');\n  return streetEl;\n}\n\nfunction createSegmentElement(\n  segmentWidthInMeters,\n  positionY,\n  mixinId,\n  length,\n  repeatCount,\n  elevation = 0\n) {\n  var segmentEl = document.createElement('a-entity');\n  const heightLevels = [0.2, 0.4, 0.6];\n  const height = heightLevels[elevation];\n  if (elevation === 0) {\n    positionY = -0.1;\n  } else if (elevation === 2) {\n    positionY = 0.1;\n  }\n\n  segmentEl.setAttribute(\n    'geometry',\n    `primitive: box; \n    height: ${height}; \n    depth: ${length};\n    width: ${segmentWidthInMeters};`\n  );\n\n  segmentEl.setAttribute('position', { y: positionY });\n  segmentEl.setAttribute('mixin', mixinId);\n\n  if (repeatCount.length !== 0) {\n    segmentEl.setAttribute(\n      'material',\n      `repeat: ${repeatCount[0]} ${repeatCount[1]}`\n    );\n  }\n\n  return segmentEl;\n}\n\nfunction createSeparatorElement(\n  positionY,\n  rotationY,\n  mixinId,\n  length,\n  repeatCount,\n  elevation = 0\n) {\n  var segmentEl = document.createElement('a-entity');\n  const scaleY = length / 150;\n  const scalePlane = '1 ' + scaleY + ' 1';\n\n  segmentEl.setAttribute('rotation', '270 ' + rotationY + ' 0');\n  segmentEl.setAttribute('scale', scalePlane);\n\n  segmentEl.setAttribute('position', '0 ' + positionY + ' 0');\n  segmentEl.setAttribute('mixin', mixinId);\n\n  if (repeatCount.length !== 0) {\n    segmentEl.setAttribute(\n      'material',\n      `repeat: ${repeatCount[0]} ${repeatCount[1]}`\n    );\n  }\n\n  return segmentEl;\n}\n\n// show warning message if segment or variantString are not supported\nfunction supportCheck(segmentType, segmentVariantString) {\n  if (segmentType === 'separator') return;\n  // variants supported in 3DStreet\n  const supportedVariants = segmentVariants[segmentType];\n  if (!supportedVariants) {\n    STREET.notify.warningMessage(\n      `The '${segmentType}' segment type is not yet supported in 3DStreet`\n    );\n    console.log(\n      `The '${segmentType}' segment type is not yet supported in 3DStreet`\n    );\n  } else if (!supportedVariants.includes(segmentVariantString)) {\n    STREET.notify.warningMessage(\n      `The '${segmentVariantString}' variant of segment '${segmentType}' is not yet supported in 3DStreet`\n    );\n    console.log(\n      `The '${segmentVariantString}' variant of segment '${segmentType}' is not yet supported in 3DStreet`\n    );\n  }\n}\n\n// OLD: takes a street's `segments` (array) from streetmix and a `streetElementId` (string) and places objects to make up a street with all segments\n// NEW: takes a `segments` (array) from streetmix and return an element and its children which represent the 3D street scene\nfunction processSegments(\n  segments,\n  showStriping,\n  length,\n  globalAnimated,\n  showVehicles\n) {\n  var clonedObjectRadius = length / 2;\n  //  Adjust clonedObjectRadius so that objects do not repeat\n  if (length > 12) {\n    clonedObjectRadius = (length - 12) / 2;\n  }\n  // add additional 0-width segments for stripes (painted markers)\n  if (showStriping) {\n    segments = insertSeparatorSegments(segments);\n  }\n\n  // create and center offset to center the street around global x position of 0\n  var streetParentEl = createCenteredStreetElement(segments);\n  streetParentEl.classList.add('street-parent');\n  streetParentEl.setAttribute('data-layer-name', 'Street Segments Container');\n\n  var cumulativeWidthInMeters = 0;\n  for (var i = 0; i < segments.length; i++) {\n    var segmentParentEl = document.createElement('a-entity');\n    segmentParentEl.classList.add('segment-parent-' + i);\n\n    var segmentWidthInMeters = segments[i].width;\n    // console.log('Type: ' + segments[i].type + '; Width: ' + segmentWidthInFeet + 'ft / ' + segmentWidthInMeters + 'm');\n\n    cumulativeWidthInMeters = cumulativeWidthInMeters + segmentWidthInMeters;\n    var segmentPositionX = cumulativeWidthInMeters - 0.5 * segmentWidthInMeters;\n    var positionY = 0;\n\n    // get variantString\n    var variantList = segments[i].variantString\n      ? segments[i].variantString.split('|')\n      : '';\n\n    // show warning message if segment or variantString are not supported\n    supportCheck(segments[i].type, segments[i].variantString);\n\n    // elevation property from streetmix segment\n    const elevation = segments[i].elevation;\n\n    const elevationLevels = [0, 0.2, 0.4];\n    const elevationPosY = elevationLevels[elevation];\n\n    // add y elevation position as a data attribute to segment entity\n    segmentParentEl.setAttribute('data-elevation-posY', elevationPosY);\n\n    // Note: segment 3d models are outbound by default\n    // If segment variant inbound, rotate segment model by 180 degrees\n    var rotationY =\n      variantList[0] === 'inbound' || variantList[1] === 'inbound' ? 180 : 0;\n    var isOutbound =\n      variantList[0] === 'outbound' || variantList[1] === 'outbound' ? 1 : -1;\n\n    // the A-Frame mixin ID is often identical to the corresponding streetmix segment \"type\" by design, let's start with that\n    var groundMixinId = segments[i].type;\n\n    // repeat value for material property - repeatCount[0] is x texture repeat and repeatCount[1] is y texture repeat\n    const repeatCount = [];\n\n    // look at segment type and variant(s) to determine specific cases\n    if (segments[i].type === 'drive-lane' && variantList[1] === 'sharrow') {\n      // make a parent entity for the stencils\n      const stencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015\n      });\n      // clone a bunch of stencil entities (note: this is not draw call efficient)\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils sharrow',\n        parentEl: stencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 10,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(stencilsParentEl);\n    } else if (\n      segments[i].type === 'bike-lane' ||\n      segments[i].type === 'scooter'\n    ) {\n      // make a parent entity for the stencils\n      const stencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015\n      });\n      // get the mixin id for a bike lane\n      groundMixinId = getBikeLaneMixin(variantList[1]);\n      // clone a bunch of stencil entities (note: this is not draw call efficient)\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils bike-arrow',\n        parentEl: stencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 20,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(stencilsParentEl);\n      segmentParentEl.append(\n        createMicroMobilityElement(\n          variantList,\n          segments[i].type,\n          elevationPosY,\n          length,\n          showVehicles,\n          globalAnimated\n        )\n      );\n    } else if (\n      segments[i].type === 'light-rail' ||\n      segments[i].type === 'streetcar'\n    ) {\n      // get the mixin id for a bus lane\n      groundMixinId = getBusLaneMixin(variantList[1]);\n      // get the mixin id for the vehicle (is it a trolley or a tram?)\n      var objectMixinId = segments[i].type === 'streetcar' ? 'trolley' : 'tram';\n      // create and append a train element\n      segmentParentEl.append(\n        createChooChooElement(variantList, objectMixinId, length, showVehicles)\n      );\n      // make the parent for all the objects to be cloned\n      const tracksParentEl = createTracksParentElement(length, objectMixinId);\n      // add these trains to the segment parent\n      segmentParentEl.append(tracksParentEl);\n    } else if (segments[i].type === 'turn-lane') {\n      groundMixinId = 'drive-lane'; // use normal drive lane road material\n      var markerMixinId = variantList[1]; // set the mixin of the road markings to match the current variant name\n\n      // Fix streetmix inbound turn lane orientation (change left to right) per: https://github.com/streetmix/streetmix/issues/683\n      if (variantList[0] === 'inbound') {\n        markerMixinId = markerMixinId.replace(/left|right/g, function (m) {\n          return m === 'left' ? 'right' : 'left';\n        });\n      }\n      if (variantList[1] === 'shared') {\n        markerMixinId = 'left';\n      }\n      if (variantList[1] === 'left-right-straight') {\n        markerMixinId = 'all';\n      }\n      var mixinString = 'stencils ' + markerMixinId;\n\n      // make the parent for all the objects to be cloned\n      const stencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015\n      });\n      cloneMixinAsChildren({\n        objectMixinId: mixinString,\n        parentEl: stencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 15,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(stencilsParentEl);\n      if (variantList[1] === 'shared') {\n        // add an additional marking to represent the opposite turn marking stencil (rotated 180º)\n        const stencilsParentEl = createStencilsParentElement({\n          y: elevationPosY + 0.015,\n          z: -3 * isOutbound\n        });\n        cloneMixinAsChildren({\n          objectMixinId: mixinString,\n          parentEl: stencilsParentEl,\n          rotation: '-90 ' + (rotationY + 180) + ' 0',\n          step: 15,\n          radius: clonedObjectRadius\n        });\n        // add this stencil stuff to the segment parent\n        segmentParentEl.append(stencilsParentEl);\n      }\n    } else if (segments[i].type === 'divider' && variantList[0] === 'bollard') {\n      groundMixinId = 'divider';\n      // make some safehits\n      const safehitsParentEl = createSafehitsParentElement();\n      cloneMixinAsChildren({\n        objectMixinId: 'safehit',\n        parentEl: safehitsParentEl,\n        step: 4,\n        radius: clonedObjectRadius\n      });\n      // add the safehits to the segment parent\n      segmentParentEl.append(safehitsParentEl);\n      repeatCount[0] = 1;\n      repeatCount[1] = parseInt(length) / 4;\n    } else if (segments[i].type === 'divider' && variantList[0] === 'flowers') {\n      groundMixinId = 'grass';\n      segmentParentEl.append(\n        createDividerVariant('flowers', clonedObjectRadius, 2.25)\n      );\n    } else if (\n      segments[i].type === 'divider' &&\n      variantList[0] === 'planting-strip'\n    ) {\n      groundMixinId = 'grass';\n      segmentParentEl.append(\n        createDividerVariant('planting-strip', clonedObjectRadius, 2.25)\n      );\n    } else if (\n      segments[i].type === 'divider' &&\n      variantList[0] === 'planter-box'\n    ) {\n      groundMixinId = 'grass';\n      segmentParentEl.append(\n        createDividerVariant('planter-box', clonedObjectRadius, 2.45)\n      );\n    } else if (\n      segments[i].type === 'divider' &&\n      variantList[0] === 'palm-tree'\n    ) {\n      groundMixinId = 'grass';\n      const treesParentEl = createTreesParentElement();\n      cloneMixinAsChildren({\n        objectMixinId: 'palm-tree',\n        parentEl: treesParentEl,\n        randomY: true,\n        radius: clonedObjectRadius\n      });\n      segmentParentEl.append(treesParentEl);\n    } else if (\n      segments[i].type === 'divider' &&\n      variantList[0] === 'big-tree'\n    ) {\n      groundMixinId = 'grass';\n      const treesParentEl = createTreesParentElement();\n      cloneMixinAsChildren({\n        objectMixinId: 'tree3',\n        parentEl: treesParentEl,\n        randomY: true,\n        radius: clonedObjectRadius\n      });\n      segmentParentEl.append(treesParentEl);\n    } else if (segments[i].type === 'divider' && variantList[0] === 'bush') {\n      groundMixinId = 'grass';\n      segmentParentEl.append(\n        createDividerVariant('bush', clonedObjectRadius, 2.25)\n      );\n    } else if (segments[i].type === 'divider' && variantList[0] === 'dome') {\n      groundMixinId = 'divider';\n      segmentParentEl.append(\n        createDividerVariant('dome', clonedObjectRadius, 2.25)\n      );\n      repeatCount[0] = 1;\n      repeatCount[1] = parseInt(length) / 4;\n    } else if (segments[i].type === 'divider') {\n      groundMixinId = 'divider';\n      repeatCount[0] = 1;\n      repeatCount[1] = parseInt(length) / 4;\n    } else if (\n      segments[i].type === 'temporary' &&\n      variantList[0] === 'barricade'\n    ) {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(\n        createClonedVariants('temporary-barricade', clonedObjectRadius, 2.25)\n      );\n    } else if (\n      segments[i].type === 'temporary' &&\n      variantList[0] === 'traffic-cone'\n    ) {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(\n        createClonedVariants('temporary-traffic-cone', clonedObjectRadius, 2.25)\n      );\n    } else if (\n      segments[i].type === 'temporary' &&\n      variantList[0] === 'jersey-barrier-plastic'\n    ) {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(\n        createClonedVariants(\n          'temporary-jersey-barrier-plastic',\n          clonedObjectRadius,\n          2.25\n        )\n      );\n    } else if (\n      segments[i].type === 'temporary' &&\n      variantList[0] === 'jersey-barrier-concrete'\n    ) {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(\n        createClonedVariants(\n          'temporary-jersey-barrier-concrete',\n          clonedObjectRadius,\n          2.93\n        )\n      );\n    } else if (\n      segments[i].type === 'bus-lane' ||\n      segments[i].type === 'brt-lane'\n    ) {\n      groundMixinId = getBusLaneMixin(variantList[1]);\n\n      segmentParentEl.append(\n        createBusElement(variantList, length, showVehicles)\n      );\n\n      // create parent for the bus lane stencils to rotate the phrase instead of the word\n      let reusableObjectStencilsParentEl;\n\n      reusableObjectStencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015\n      });\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils word-bus',\n        parentEl: reusableObjectStencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 50,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(reusableObjectStencilsParentEl);\n\n      reusableObjectStencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015,\n        z: 10\n      });\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils word-taxi',\n        parentEl: reusableObjectStencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 50,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(reusableObjectStencilsParentEl);\n\n      reusableObjectStencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015,\n        z: 20\n      });\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils word-only',\n        parentEl: reusableObjectStencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 50,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(reusableObjectStencilsParentEl);\n    } else if (segments[i].type === 'drive-lane') {\n      const isAnimated = variantList[2] === 'animated' || globalAnimated;\n      const count = getRandomIntInclusive(2, 3);\n      const carStep = 7.3;\n      segmentParentEl.append(\n        createDriveLaneElement(\n          variantList,\n          segmentWidthInMeters,\n          length,\n          isAnimated,\n          showVehicles,\n          count,\n          carStep\n        )\n      );\n    } else if (segments[i].type === 'food-truck') {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(createFoodTruckElement(variantList, length));\n    } else if (segments[i].type === 'flex-zone') {\n      groundMixinId = 'bright-lane';\n      segmentParentEl.append(\n        createFlexZoneElement(variantList, length, showVehicles)\n      );\n\n      let reusableObjectStencilsParentEl;\n\n      reusableObjectStencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015,\n        z: 5\n      });\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils word-loading-small',\n        parentEl: reusableObjectStencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 50,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(reusableObjectStencilsParentEl);\n\n      reusableObjectStencilsParentEl = createStencilsParentElement({\n        y: elevationPosY + 0.015,\n        z: -5\n      });\n      cloneMixinAsChildren({\n        objectMixinId: 'stencils word-only-small',\n        parentEl: reusableObjectStencilsParentEl,\n        rotation: '-90 ' + rotationY + ' 0',\n        step: 50,\n        radius: clonedObjectRadius\n      });\n      // add this stencil stuff to the segment parent\n      segmentParentEl.append(reusableObjectStencilsParentEl);\n    } else if (segments[i].type === 'sidewalk' && variantList[0] !== 'empty') {\n      // handles variantString with value sparse, normal, or dense sidewalk\n      const isAnimated = variantList[1] === 'animated' || globalAnimated;\n      segmentParentEl.append(\n        createSidewalkClonedVariants(\n          segmentWidthInMeters,\n          variantList[0],\n          elevationPosY,\n          length,\n          'random',\n          isAnimated\n        )\n      );\n    } else if (segments[i].type === 'sidewalk-wayfinding') {\n      segmentParentEl.append(createWayfindingElements());\n    } else if (segments[i].type === 'sidewalk-bench') {\n      // make the parent for all the benches\n      const benchesParentEl = createBenchesParentElement();\n\n      const rotationCloneY = variantList[0] === 'right' ? -90 : 90;\n      if (variantList[0] === 'center') {\n        cloneMixinAsChildren({\n          objectMixinId: 'bench_orientation_center',\n          parentEl: benchesParentEl,\n          rotation: '0 ' + rotationCloneY + ' 0',\n          radius: clonedObjectRadius\n        });\n        // add benches to the segment parent\n        segmentParentEl.append(benchesParentEl);\n      } else {\n        // `right` or `left` bench\n        cloneMixinAsChildren({\n          objectMixinId: 'bench',\n          parentEl: benchesParentEl,\n          rotation: '0 ' + rotationCloneY + ' 0',\n          radius: clonedObjectRadius\n        });\n        // add benches to the segment parent\n        segmentParentEl.append(benchesParentEl);\n      }\n    } else if (segments[i].type === 'sidewalk-bike-rack') {\n      // make the parent for all the bike racks\n      const bikeRacksParentEl = createBikeRacksParentElement(elevationPosY);\n\n      const rotationCloneY = variantList[1] === 'sidewalk-parallel' ? 90 : 0;\n      cloneMixinAsChildren({\n        objectMixinId: 'bikerack',\n        parentEl: bikeRacksParentEl,\n        rotation: '0 ' + rotationCloneY + ' 0',\n        radius: clonedObjectRadius\n      });\n      // add bike racks to the segment parent\n      segmentParentEl.append(bikeRacksParentEl);\n    } else if (segments[i].type === 'magic-carpet') {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(createMagicCarpetElement(showVehicles));\n    } else if (segments[i].type === 'outdoor-dining') {\n      groundMixinId = variantList[1] === 'road' ? 'drive-lane' : 'sidewalk';\n      segmentParentEl.append(createOutdoorDining(length, elevationPosY));\n    } else if (segments[i].type === 'parklet') {\n      groundMixinId = 'drive-lane';\n      segmentParentEl.append(createParkletElement(length, variantList));\n    } else if (segments[i].type === 'bikeshare') {\n      // make the parent for all the stations\n      segmentParentEl.append(\n        createBikeShareStationElement(variantList, elevationPosY)\n      );\n    } else if (segments[i].type === 'utilities') {\n      var rotation = variantList[0] === 'right' ? '0 180 0' : '0 0 0';\n      const utilityPoleElems = createClonedVariants(\n        'utility_pole',\n        clonedObjectRadius,\n        15,\n        rotation\n      );\n      segmentParentEl.append(utilityPoleElems);\n    } else if (segments[i].type === 'sidewalk-tree') {\n      // make the parent for all the trees\n      const treesParentEl = createTreesParentElement();\n      if (variantList[0] === 'palm-tree') {\n        objectMixinId = 'palm-tree';\n      } else {\n        objectMixinId = 'tree3';\n      }\n      // clone a bunch of trees under the parent\n      cloneMixinAsChildren({\n        objectMixinId: objectMixinId,\n        parentEl: treesParentEl,\n        randomY: true,\n        radius: clonedObjectRadius\n      });\n      segmentParentEl.append(treesParentEl);\n    } else if (\n      segments[i].type === 'sidewalk-lamp' &&\n      (variantList[1] === 'modern' || variantList[1] === 'pride')\n    ) {\n      // Make the parent object for all the lamps\n      const lampsParentEl = createLampsParentElement();\n      if (variantList[0] === 'both') {\n        cloneMixinAsChildren({\n          objectMixinId: 'lamp-modern-double',\n          parentEl: lampsParentEl,\n          rotation: '0 0 0',\n          radius: clonedObjectRadius\n        });\n        segmentParentEl.append(lampsParentEl);\n      } else {\n        var rotationCloneY = variantList[0] === 'right' ? 0 : 180;\n        cloneMixinAsChildren({\n          objectMixinId: 'lamp-modern',\n          parentEl: lampsParentEl,\n          rotation: '0 ' + rotationCloneY + ' 0',\n          radius: clonedObjectRadius\n        });\n        segmentParentEl.append(lampsParentEl);\n      }\n      // Add the pride flags to the lamp posts\n      if (\n        variantList[1] === 'pride' &&\n        (variantList[0] === 'right' || variantList[0] === 'both')\n      ) {\n        cloneMixinAsChildren({\n          objectMixinId: 'pride-flag',\n          parentEl: lampsParentEl,\n          positionXYString: '0.409 5',\n          radius: clonedObjectRadius\n        });\n      }\n      if (\n        variantList[1] === 'pride' &&\n        (variantList[0] === 'left' || variantList[0] === 'both')\n      ) {\n        cloneMixinAsChildren({\n          objectMixinId: 'pride-flag',\n          parentEl: lampsParentEl,\n          rotation: '0 -180 0',\n          positionXYString: '-0.409 5',\n          radius: clonedObjectRadius\n        });\n      }\n    } else if (\n      segments[i].type === 'sidewalk-lamp' &&\n      variantList[1] === 'traditional'\n    ) {\n      // make the parent for all the lamps\n      const lampsParentEl = createLampsParentElement();\n      // clone a bunch of lamps under the parent\n      cloneMixinAsChildren({\n        objectMixinId: 'lamp-traditional',\n        parentEl: lampsParentEl,\n        radius: clonedObjectRadius\n      });\n      segmentParentEl.append(lampsParentEl);\n    } else if (segments[i].type === 'transit-shelter') {\n      var rotationBusStopY = variantList[0] === 'left' ? 90 : 270;\n      segmentParentEl.append(\n        createBusStopElement(rotationBusStopY, elevationPosY)\n      );\n    } else if (segments[i].type === 'brt-station') {\n      segmentParentEl.append(createBrtStationElement());\n    } else if (\n      segments[i].type === 'separator' &&\n      variantList[0] === 'dashed'\n    ) {\n      groundMixinId = 'markings dashed-stripe';\n      positionY = elevationPosY + 0.01; // make sure the lane marker is above the asphalt\n      // for all markings material property repeat = \"1 25\". So every 150/25=6 meters put a dash\n      repeatCount[0] = 1;\n      repeatCount[1] = parseInt(length / 6);\n    } else if (segments[i].type === 'separator' && variantList[0] === 'solid') {\n      groundMixinId = 'markings solid-stripe';\n      positionY = elevationPosY + 0.01; // make sure the lane marker is above the asphalt\n    } else if (\n      segments[i].type === 'separator' &&\n      variantList[0] === 'doubleyellow'\n    ) {\n      groundMixinId = 'markings solid-doubleyellow';\n      positionY = elevationPosY + 0.01; // make sure the lane marker is above the asphalt\n    } else if (\n      segments[i].type === 'separator' &&\n      variantList[0] === 'shortdashedyellow'\n    ) {\n      groundMixinId = 'markings yellow short-dashed-stripe';\n      positionY = elevationPosY + 0.01; // make sure the lane marker is above the asphalt\n      // for short-dashed-stripe every 3 meters put a dash\n      repeatCount[0] = 1;\n      repeatCount[1] = parseInt(length / 3);\n    } else if (\n      segments[i].type === 'separator' &&\n      variantList[0] === 'soliddashedyellow'\n    ) {\n      groundMixinId = 'markings yellow solid-dashed';\n      positionY = elevationPosY + 0.01; // make sure the lane marker is above the asphalt\n    } else if (\n      segments[i].type === 'separator' &&\n      variantList[0] === 'soliddashedyellowinverted'\n    ) {\n      groundMixinId = 'markings yellow solid-dashed';\n      positionY = elevationPosY + 0.01; // make sure the lane marker is above the asphalt\n      rotationY = '180';\n      repeatCount[0] = 1;\n      repeatCount[1] = parseInt(length / 6);\n    } else if (segments[i].type === 'parking-lane') {\n      let reusableObjectStencilsParentEl;\n\n      groundMixinId = 'bright-lane';\n      let parkingMixin = 'stencils parking-t';\n\n      const carCount = 5;\n      let carStep = 6;\n\n      const rotationVars = {\n        outbound: 90,\n        inbound: 90,\n        sideways: 0,\n        'angled-front-left': 30,\n        'angled-front-right': -30,\n        'angled-rear-left': -30,\n        'angled-rear-right': 30\n      };\n      let markingsRotZ = rotationVars[variantList[0]];\n      let markingLength;\n\n      // calculate position X and rotation Z for T-markings\n      let markingPosX = segmentWidthInMeters / 2;\n      if (markingsRotZ === 90 && variantList[1] === 'right') {\n        markingsRotZ = -90;\n        markingPosX = -markingPosX + 0.75;\n      } else {\n        markingPosX = markingPosX - 0.75;\n      }\n\n      if (variantList[0] === 'sideways' || variantList[0].includes('angled')) {\n        carStep = 3;\n        markingLength = segmentWidthInMeters;\n        markingPosX = 0;\n        parkingMixin = 'markings solid-stripe';\n      }\n      const markingPosXY = markingPosX + ' 0';\n      const clonedStencilRadius = length / 2 - carStep;\n\n      segmentParentEl.append(\n        createDriveLaneElement(\n          [...variantList, 'car'],\n          segmentWidthInMeters,\n          length,\n          false,\n          showVehicles,\n          carCount,\n          carStep\n        )\n      );\n      if (variantList[1] === 'left') {\n        reusableObjectStencilsParentEl = createStencilsParentElement({\n          y: elevationPosY + 0.015\n        });\n        cloneMixinAsChildren({\n          objectMixinId: parkingMixin,\n          parentEl: reusableObjectStencilsParentEl,\n          positionXYString: markingPosXY,\n          rotation: '-90 ' + '90 ' + markingsRotZ,\n          length: markingLength,\n          step: carStep,\n          radius: clonedStencilRadius\n        });\n      } else {\n        reusableObjectStencilsParentEl = createStencilsParentElement({\n          y: elevationPosY + 0.015\n        });\n        cloneMixinAsChildren({\n          objectMixinId: parkingMixin,\n          parentEl: reusableObjectStencilsParentEl,\n          positionXYString: markingPosXY,\n          rotation: '-90 ' + '90 ' + markingsRotZ,\n          length: markingLength,\n          step: carStep,\n          radius: clonedStencilRadius\n        });\n      }\n      // add the stencils to the segment parent\n      segmentParentEl.append(reusableObjectStencilsParentEl);\n    }\n\n    if (streetmixParsersTested.isSidewalk(segments[i].type)) {\n      groundMixinId = 'sidewalk';\n      repeatCount[0] = segmentWidthInMeters / 1.5;\n      // every 2 meters repeat sidewalk texture\n      repeatCount[1] = parseInt(length / 2);\n    }\n\n    // add new object\n    if (segments[i].type !== 'separator') {\n      segmentParentEl.append(\n        createSegmentElement(\n          segmentWidthInMeters,\n          positionY,\n          groundMixinId,\n          length,\n          repeatCount,\n          elevation\n        )\n      );\n    } else {\n      segmentParentEl.append(\n        createSeparatorElement(\n          positionY,\n          rotationY,\n          groundMixinId,\n          length,\n          repeatCount,\n          elevation\n        )\n      );\n    }\n    // returns JSON output instead\n    // append the new surfaceElement to the segmentParentEl\n    streetParentEl.append(segmentParentEl);\n    segmentParentEl.setAttribute('position', segmentPositionX + ' 0 0');\n    segmentParentEl.setAttribute(\n      'data-layer-name',\n      'Segment • ' + segments[i].type + ', ' + variantList[0]\n    );\n  }\n  // create new brown box to represent ground underneath street\n  const dirtBox = document.createElement('a-box');\n  const xPos = cumulativeWidthInMeters / 2;\n  dirtBox.setAttribute('position', `${xPos} -1.1 0`); // what is x? x = 0 - cumulativeWidthInMeters / 2\n  dirtBox.setAttribute('height', 2); // height is 2 meters from y of -0.1 to -y of 2.1\n  dirtBox.setAttribute('width', cumulativeWidthInMeters);\n  dirtBox.setAttribute('depth', length - 0.2); // depth is length - 0.1 on each side\n  dirtBox.setAttribute('material', 'color: #664B00;');\n  dirtBox.setAttribute('data-layer-name', 'Underground');\n  streetParentEl.append(dirtBox);\n  return streetParentEl;\n}\nmodule.exports.processSegments = processSegments;\n\n// test - for streetObject of street 44 and buildingElementId render 2 building sides\nfunction processBuildings(left, right, streetWidth, showGround, length) {\n  const buildingElement = document.createElement('a-entity');\n  const clonedObjectRadius = 0.45 * length;\n  buildingElement.classList.add('buildings-parent');\n  buildingElement.setAttribute(\n    'data-layer-name',\n    'Buildings & Blocks Container'\n  );\n  buildingElement.setAttribute('position', '0 0.2 0');\n  const buildingsArray = [left, right];\n\n  // TODO: Sound temporarily disabled\n  // var ambientSoundJSONString = JSON.stringify(streetmixParsersTested.getAmbientSoundJSON(buildingsArray));\n  // var soundParentEl = document.createElement('a-entity');\n  // soundParentEl.setAttribute('create-from-json', 'jsonString', ambientSoundJSONString);\n  // buildingElement.appendChild(soundParentEl);\n\n  function createBuilding(buildingType, sideMultiplier) {\n    // Make buildings\n    const buildingsArray = streetmixParsersTested.createBuildingsArray(\n      length,\n      buildingType\n    );\n    const buildingJSONString = JSON.stringify(buildingsArray);\n    const placedObjectEl = document.createElement('a-entity');\n\n    placedObjectEl.setAttribute('rotation', '0 ' + 90 * sideMultiplier + ' 0');\n    placedObjectEl.setAttribute(\n      'create-from-json',\n      'jsonString',\n      buildingJSONString\n    );\n    return placedObjectEl;\n  }\n\n  // possible 'block' type input values: grass, fence, narrow, wide, waterfront, residential, parking-lot, (new: archway, wall sp?)\n  buildingsArray.forEach((currentValue, index) => {\n    if (currentValue.length === 0) {\n      return;\n    } // if empty string then skip\n    const side = index === 0 ? 'left' : 'right';\n    const sideMultiplier = side === 'left' ? -1 : 1;\n\n    const groundPositionX = (length / 4 + streetWidth / 2) * sideMultiplier;\n    const buildingPositionX = (150 / 2 + streetWidth / 2) * sideMultiplier;\n\n    // this is the logic to make the ground box\n    if (showGround) {\n      const variantToMaterialMapping = {\n        grass: 'ground-grass-material',\n        fence: 'ground-grass-material',\n        'parking-lot': 'ground-parking-lot-material',\n        residential: 'ground-grass-material',\n        narrow: 'ground-asphalt-material',\n        wide: 'ground-asphalt-material',\n        arcade: 'ground-tiled-concrete-material',\n        'compound-wall': 'ground-asphalt-material'\n      };\n\n      let groundParentEl;\n      if (currentValue === 'waterfront') {\n        groundParentEl = document.createElement('a-ocean-box');\n        groundParentEl.setAttribute('geometry', {\n          primitive: 'box',\n          depth: length,\n          width: length / 2,\n          height: 2,\n          segmentsHeight: 1,\n          segmentsDepth: 10,\n          segmentsWidth: 10\n        });\n        groundParentEl.setAttribute('position', { y: -3 });\n      } else {\n        groundParentEl = document.createElement('a-box');\n        groundParentEl.setAttribute('depth', length);\n        groundParentEl.setAttribute('height', 2);\n        groundParentEl.setAttribute('width', length / 2);\n        groundParentEl.setAttribute('shadow', '');\n        // groundParentEl.setAttribute('material', 'src:#grass-texture;repeat:5 5;roughness:0.8;');\n        groundParentEl.setAttribute(\n          'mixin',\n          variantToMaterialMapping[currentValue]\n        ); // case grass, fence\n        groundParentEl.setAttribute('position', { y: -1 });\n      }\n\n      if (side === 'right') {\n        // groundParentEl.setAttribute('position', groundPositionX + ' -1 0');\n        groundParentEl.setAttribute('position', { x: groundPositionX });\n      } else {\n        groundParentEl.setAttribute('position', { x: groundPositionX });\n      }\n      groundParentEl.classList.add('ground-' + side);\n      groundParentEl.setAttribute(\n        'data-layer-name',\n        'Ground ' + side + ' • ' + currentValue\n      );\n      buildingElement.appendChild(groundParentEl);\n    }\n\n    // make building\n    const buildingPos = {\n      x: buildingPositionX,\n      y: 0,\n      z: index === 1 ? length / 2 : -length / 2\n    };\n\n    switch (currentValue) {\n      case 'narrow':\n      case 'wide':\n        buildingPos.x += sideMultiplier * -72;\n        break;\n      case 'residential':\n        buildingPos.x += sideMultiplier * -64;\n        buildingPos.y = -0.58;\n        // the grass should be slightly lower than the path - 0.17 instead of 0.2 for other buildings\n        buildingElement.setAttribute('position', '0 0.17 0');\n        break;\n      case 'arcade':\n        buildingPos.x += sideMultiplier * -70.5;\n    }\n    const newBuildings = createBuilding(currentValue, sideMultiplier);\n    newBuildings.setAttribute(\n      'data-layer-name',\n      'Buildings ' + side + ' • ' + currentValue\n    );\n\n    newBuildings.setAttribute('position', buildingPos);\n    buildingElement.append(newBuildings);\n\n    if (currentValue === 'waterfront' || currentValue === 'compound-wall') {\n      const objectPositionX = buildingPositionX - (sideMultiplier * 150) / 2;\n      const placedObjectEl = document.createElement('a-entity');\n      placedObjectEl.setAttribute('class', 'seawall-parent');\n      placedObjectEl.setAttribute('position', { x: objectPositionX, z: 4.5 }); // position=\"1.043 0.100 -3.463\"\n      let rotationCloneY;\n      if (currentValue === 'compound-wall') {\n        placedObjectEl.setAttribute('position', { y: 3 });\n        placedObjectEl.setAttribute('position', {\n          x: objectPositionX + 1.5 * sideMultiplier\n        });\n        rotationCloneY = side === 'left' ? 90 : -90;\n      } else {\n        rotationCloneY = side === 'left' ? -90 : 90;\n      }\n      placedObjectEl.classList.add('seawall-parent-' + side);\n      buildingElement.appendChild(placedObjectEl);\n      // clone a bunch of seawalls under the parent\n      cloneMixinAsChildren({\n        objectMixinId: 'seawall',\n        parentEl: placedObjectEl,\n        rotation: '0 ' + rotationCloneY + ' 0',\n        step: 15,\n        radius: clonedObjectRadius\n      });\n    }\n\n    if (currentValue === 'fence' || currentValue === 'parking-lot') {\n      const objectPositionX = buildingPositionX - (sideMultiplier * 150) / 2;\n      // make the parent for all the objects to be cloned\n      const placedObjectEl = document.createElement('a-entity');\n      placedObjectEl.setAttribute('class', 'fence-parent');\n      placedObjectEl.setAttribute('position', objectPositionX + ' 0 4.625'); // position=\"1.043 0.100 -3.463\"\n      placedObjectEl.classList.add('fence-parent-' + buildingPositionX);\n      // clone a bunch of fences under the parent\n      const rotationCloneY = side === 'right' ? -90 : 90;\n      cloneMixinAsChildren({\n        objectMixinId: 'fence',\n        parentEl: placedObjectEl,\n        rotation: '0 ' + rotationCloneY + ' 0',\n        step: 9.25,\n        radius: clonedObjectRadius\n      });\n      buildingElement.appendChild(placedObjectEl);\n    }\n  });\n  return buildingElement;\n}\nmodule.exports.processBuildings = processBuildings;\n","/* global AFRAME, customElements */\n\nfunction buildAssetHTML(assetUrl, categories) {\n  // if (!assetUrl) assetUrl = 'https://assets.3dstreet.app/';\n  console.log('[street]', 'Using street assets from', assetUrl);\n  const surfacesRoughness = 0.8;\n  var assetsObj = {\n    'sidewalk-props': `\n        <!-- sidewalk props -->\n        <img id=\"wayfinding-map\" src=\"${assetUrl}objects/wayfinding.jpg\" crossorigin=\"anonymous\" />\n        <a-asset-item id=\"streetProps\" src=\"${assetUrl}sets/street-props/gltf-exports/draco/street-props.glb\"></a-asset-item>\n        <a-asset-item id=\"brt-station-model\" src=\"${assetUrl}sets/brt-station/gltf-exports/draco/brt-station.glb\"></a-asset-item>\n        <a-mixin shadow id=\"brt-station\" gltf-model=\"#brt-station-model\" ></a-mixin>\n        <a-mixin shadow id=\"outdoor_dining\" gltf-part=\"src: #streetProps; part: outdoor_dining\"></a-mixin>\n        <a-mixin shadow id=\"bench_orientation_center\" gltf-part=\"src: #streetProps; part: bench_orientation_center\"></a-mixin>\n        <a-mixin shadow id=\"parklet\" gltf-part=\"src: #streetProps; part: parklet\"></a-mixin>\n        <a-mixin shadow id=\"utility_pole\" gltf-part=\"src: #streetProps; part: utility_pole\"></a-mixin>\n        <a-mixin shadow id=\"lamp-modern\" gltf-part=\"src: #streetProps; part: street-light\"></a-mixin>\n        <a-mixin shadow id=\"lamp-modern-double\" gltf-part=\"src: #streetProps; part: street-light-double\"></a-mixin>\n        <a-mixin shadow id=\"bikerack\" gltf-part=\"src: #streetProps; part: bike_rack\"></a-mixin>\n        <a-mixin shadow id=\"bikeshare\" gltf-part=\"src: #streetProps; part: bike_share\"></a-mixin>\n        <a-mixin shadow id=\"lamp-traditional\" gltf-part=\"src: #streetProps; part: lamp_post_traditional\" scale=\"2 2 2\"></a-mixin>\n        <a-mixin shadow id=\"palm-tree\" gltf-part=\"src: #streetProps; part: palmtree\" scale=\"1 1.5 1\"></a-mixin>\n        <a-mixin shadow id=\"bench\" gltf-part=\"src: #streetProps; part: park_bench\"></a-mixin>\n        <a-mixin shadow id=\"seawall\" gltf-part=\"src: #streetProps; part: sea_wall\"></a-mixin>\n        <a-mixin shadow id=\"track\" gltf-part=\"src: #streetProps; part: track\"></a-mixin>\n        <a-mixin shadow id=\"tree3\" gltf-part=\"src: #streetProps; part: tree-01\" scale=\"1.25 1.25 1.25\"></a-mixin>\n        <a-mixin shadow id=\"bus-stop\" gltf-part=\"src: #streetProps; part: transit-shelter-1\"></a-mixin>\n        <a-mixin shadow id=\"pride-flag\" position=\"0.409 3.345 0\" rotation=\"0 0 0\" scale=\"0.5 0.75 0\" geometry=\"width:2;height:2;primitive:plane\" material=\"side:double; src:${assetUrl}materials/rainbow-flag-poles_512.png;transparent: true;\"></a-mixin>\n        <a-mixin shadow id=\"wayfinding-box\" geometry=\"primitive: box; height: 2; width: 0.84; depth: 0.1\" material=\"color: gray\"></a-mixin>\n      `,\n    people: `\n        <!-- human characters -->\n        <a-asset-item id=\"humans\" src=\"${assetUrl}sets/human-characters-poses-1/gltf-exports/draco/human-characters-poses-1.glb\"></a-asset-item>\n        <a-mixin shadow id=\"char1\" gltf-part=\"src: #humans; part: Character_1\"></a-mixin>\n        <a-mixin shadow id=\"char2\" gltf-part=\"src: #humans; part: Character_2\"></a-mixin>\n        <a-mixin shadow id=\"char3\" gltf-part=\"src: #humans; part: Character_3\"></a-mixin>\n        <a-mixin shadow id=\"char4\" gltf-part=\"src: #humans; part: Character_4\"></a-mixin>\n        <a-mixin shadow id=\"char5\" gltf-part=\"src: #humans; part: Character_5\"></a-mixin>\n        <a-mixin shadow id=\"char6\" gltf-part=\"src: #humans; part: Character_6\"></a-mixin>\n        <a-mixin shadow id=\"char7\" gltf-part=\"src: #humans; part: Character_7\"></a-mixin>\n        <a-mixin shadow id=\"char8\" gltf-part=\"src: #humans; part: Character_8\"></a-mixin>\n        <a-asset-item id=\"humans2\" src=\"${assetUrl}sets/human-characters-poses-2/gltf-exports/draco/human-characters-poses-2.glb\"></a-asset-item>\n        <a-mixin shadow id=\"char9\" gltf-part=\"src: #humans2; part: Character_9\"></a-mixin>\n        <a-mixin shadow id=\"char10\" gltf-part=\"src: #humans2; part: Character_10\"></a-mixin>\n        <a-mixin shadow id=\"char11\" gltf-part=\"src: #humans2; part: Character_11\"></a-mixin>\n        <a-mixin shadow id=\"char12\" gltf-part=\"src: #humans2; part: Character_12\"></a-mixin>\n        <a-mixin shadow id=\"char13\" gltf-part=\"src: #humans2; part: Character_13\"></a-mixin>\n        <a-mixin shadow id=\"char14\" gltf-part=\"src: #humans2; part: Character_14\"></a-mixin>\n        <a-mixin shadow id=\"char15\" gltf-part=\"src: #humans2; part: Character_15\"></a-mixin>\n        <a-mixin shadow id=\"char16\" gltf-part=\"src: #humans2; part: Character_16\"></a-mixin>\n      `,\n    'people-rigged': `          \n        <a-asset-item id=\"character1walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-1-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char1\" gltf-model=\"#character1walk\" animation-mixer></a-mixin>\n        \n        <a-asset-item id=\"character2walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-2-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char2\" gltf-model=\"#character2walk\" animation-mixer></a-mixin>\n        <a-asset-item id=\"character3walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-3-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char3\" gltf-model=\"#character3walk\" animation-mixer></a-mixin>\n        <a-asset-item id=\"character4walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-4-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char4\" gltf-model=\"#character4walk\" animation-mixer></a-mixin>\n        <a-asset-item id=\"character5walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-5-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char5\" gltf-model=\"#character5walk\" animation-mixer></a-mixin>\n        <a-asset-item id=\"character6walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-6-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char6\" gltf-model=\"#character6walk\" animation-mixer></a-mixin>\n        <a-asset-item id=\"character7walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-7-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char7\" gltf-model=\"#character7walk\" animation-mixer></a-mixin>\n        <a-asset-item id=\"character8walk\" src=\"${assetUrl}sets/human-characters-animation-seperated/gltf-exports/draco/character-8-walk.glb\"></a-asset-item>\n        <a-mixin shadow id=\"a_char8\" gltf-model=\"#character8walk\" animation-mixer></a-mixin>\n      `,\n    vehicles: `\n        <!-- vehicles -->\n        <a-asset-item id=\"magic-carpet-glb\" src=\"${assetUrl}sets/magic-carpet/gltf-exports/draco/magic-carpet.glb\"></a-asset-item>\n        <a-mixin shadow id=\"Character_1_M\" gltf-part=\"src: #magic-carpet-glb; part: Character_1_M\"></a-mixin>\n        <a-mixin shadow id=\"magic-carpet\" gltf-part=\"src: #magic-carpet-glb; part: magic-carpet\"></a-mixin>\n        <!-- micro mobility vehicles -->\n        <a-asset-item id=\"microMobilityDevices\" src=\"${assetUrl}sets/micro-mobility-devices/gltf-exports/draco/micro-mobility-devices_v01.glb\"></a-asset-item>\n        <a-mixin shadow id=\"Bicycle_1\" gltf-part=\"src: #microMobilityDevices; part: Bicycle_1\"></a-mixin>\n        <a-mixin shadow id=\"ElectricScooter_1\" gltf-part=\"src: #microMobilityDevices; part: ElectricScooter_1\"></a-mixin>\n      `,\n    'vehicles-rigged': `\n        <!-- vehicles rigged -->\n        <a-mixin shadow id=\"sedan-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/toyota-prius-rig.glb)\" ></a-mixin>\n        <a-mixin shadow id=\"sedan-taxi-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/sedan-taxi-rig.glb)\"></a-mixin>\n        <a-mixin shadow id=\"suv-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/suv-rig.glb)\"></a-mixin>\n        <a-mixin shadow id=\"box-truck-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/isuzu-truck-rig.glb)\"></a-mixin>\n        <a-mixin shadow id=\"food-trailer-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/food-trailer-rig.glb)\"></a-mixin>\n        <a-mixin shadow id=\"fire-truck-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/fire-truck-pumper-rig.glb)\"></a-mixin>\n        <a-mixin shadow id=\"fire-ladder-rig\" gltf-model=\"url(${assetUrl}sets/vehicles/gltf-exports/draco/fire_truck_ladder.glb)\"></a-mixin>\n        <a-mixin shadow id=\"self-driving-cruise-car-rig\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/self-driving-cruise-car-rig.glb)\"></a-mixin>\n      `,\n    buildings: `\n        <!-- blocks -->\n        <a-asset-item id=\"blockmodel\" src=\"${assetUrl}sets/buildings/gltf-exports/draco/buildings.glb\"></a-asset-item>\n        <a-asset-item id=\"archedmodel\" src=\"${assetUrl}sets/arcade-style-buildings/gltf-exports/draco/arched-buildings.glb\"></a-asset-item>\n        <a-asset-item id=\"suburbiamodel\" src=\"${assetUrl}sets/suburban-houses/gltf-exports/draco/suburban-houses.glb\"></a-asset-item>\n\n        <!-- buildings and blocks -->\n        <a-mixin shadow id=\"SM3D_Bld_Mixed_Corner_4fl\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #blockmodel; part: SM3D_Bld_Mixed_Corner_4fl\"></a-mixin>\n        <a-mixin shadow id=\"SM3D_Bld_Mixed_Double_5fl\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #blockmodel; part: SM3D_Bld_Mixed_Double_5fl\"></a-mixin>\n        <a-mixin shadow id=\"SM3D_Bld_Mixed_4fl_2\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #blockmodel; part: SM3D_Bld_Mixed_4fl_2\"></a-mixin>\n        <a-mixin shadow id=\"SM3D_Bld_Mixed_5fl\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #blockmodel; part: SM3D_Bld_Mixed_5fl\"></a-mixin>\n        <a-mixin shadow id=\"SM3D_Bld_Mixed_4fl\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #blockmodel; part: SM3D_Bld_Mixed_4fl\"></a-mixin>\n\n        <!-- suburban buildings -->\n        <a-mixin shadow id=\"SM_Bld_House_Preset_03_1800\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #suburbiamodel; part: suburban-house_1\"></a-mixin>\n        <a-mixin shadow id=\"SM_Bld_House_Preset_08_1809\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #suburbiamodel; part: suburban-house_3\"></a-mixin>\n        <a-mixin shadow id=\"SM_Bld_House_Preset_09_1845\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #suburbiamodel; part: suburban-house_2\"></a-mixin>\n\n        <!-- arched style buildings -->\n        <a-mixin shadow id=\"arched-building-01\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #archedmodel; part: arched-building-01\"></a-mixin>\n        <a-mixin shadow id=\"arched-building-02\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #archedmodel; part: arched-building-02\"></a-mixin>\n        <a-mixin shadow id=\"arched-building-03\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #archedmodel; part: arched-building-03\"></a-mixin>\n        <a-mixin shadow id=\"arched-building-04\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #archedmodel; part: arched-building-04\"></a-mixin>\n`,\n    'intersection-props': `\n        <a-asset-item id=\"stopsign\" src=\"${assetUrl}sets/road-signs/gltf-exports/draco/stop-sign.glb\"></a-asset-item>\n        <a-asset-item id=\"signal1\" src=\"${assetUrl}sets/signals/gltf-exports/draco/signal1.glb\"></a-asset-item>\n        <a-asset-item id=\"signal2\" src=\"${assetUrl}sets/signals/gltf-exports/draco/signal2.glb\"></a-asset-item>\n        <a-mixin id=\"signal_left\" gltf-model=\"#signal1\"></a-mixin>\n        <a-mixin id=\"signal_right\" gltf-model=\"#signal2\"></a-mixin>\n        <a-mixin id=\"stop_sign\" gltf-model=\"#stopsign\"></a-mixin>\n      `,\n    'segment-textures': `  \n        <!-- segment mixins with textures -->\n        <img id=\"seamless-road\" src=\"${assetUrl}materials/TexturesCom_Roads0086_1_seamless_S_rotate.jpg\" crossorigin=\"anonymous\">\n        <img id=\"seamless-bright-road\" src=\"${assetUrl}materials/asphalthd_Base_Color.jpg\" crossorigin=\"anonymous\">\n        <img id=\"seamless-sidewalk\" src=\"${assetUrl}materials/TexturesCom_FloorsRegular0301_1_seamless_S.jpg\" crossorigin=\"anonymous\">\n        <img id=\"hatched-base\" src=\"${assetUrl}materials/seamless-lane-with-hatch-half.jpg\" crossorigin=\"anonymous\">\n        <img id=\"hatched-normal\" src=\"${assetUrl}materials/seamless-lane-with-hatch-half.jpg\" crossorigin=\"anonymous\">\n        <a-mixin shadow=\"cast: false\" id=\"drive-lane\" geometry=\"width:3;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};repeat:0.3 25;offset:0.55 0;src:#seamless-road;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"bright-lane\" geometry=\"width:3;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};repeat:0.6 50;offset:0.55 0;src:#seamless-bright-road;color:#dddddd\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"bike-lane\" geometry=\"width:1.8;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};repeat:0.3 25;offset:0.55 0;metalness:0;src:#seamless-road;\"></a-mixin>\n        <a-mixin shadow id=\"sidewalk\" anisotropy geometry=\"width:3;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};repeat:1.5 75;src:#seamless-sidewalk;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"bus-lane\" geometry=\"width:3;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};repeat:0.3 25;offset:0.55 0;src:#seamless-road;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"divider\" geometry=\"width:0.3;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};src:#hatched-base;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"grass\" geometry=\"width:0.3;height:150;primitive:plane\" material=\"roughness:${surfacesRoughness};repeat:1 150;offset:0.415 0;src:#grass-texture;\"></a-mixin>\n      `,\n    'segment-colors': `  \n        <!-- segment color modifier mixins -->\n        <a-mixin id=\"yellow\" material=\"color:#f7d117\"></a-mixin>\n        <a-mixin id=\"surface-green\" material=\"color:#adff83\"></a-mixin>\n        <a-mixin id=\"surface-red\" material=\"color:#ff9393\"></a-mixin>\n        <a-mixin id=\"surface-blue\" material=\"color:#00b6b6\"></a-mixin>\n      `,\n    'lane-separator': `\n        <!-- lane separator markings -->\n        <img id=\"markings-atlas\" src=\"${assetUrl}materials/lane-markings-atlas_1024.png\" crossorigin=\"anonymous\" /> \n        <a-mixin shadow=\"cast: false\" id=\"markings\" anisotropy atlas-uvs=\"totalRows: 1; totalColumns: 8; row: 1\" scale=\"1 1 1\" material=\"src: #markings-atlas;alphaTest: 0;transparent:true;repeat:1 25;\" geometry=\"primitive: plane; buffer: false; skipCache: true; width:0.2; height:150;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"solid-stripe\" atlas-uvs=\"column: 3; row: 1\" material=\"repeat:1 5;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"dashed-stripe\" atlas-uvs=\"column: 4; row: 1\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"short-dashed-stripe\" atlas-uvs=\"column: 4\" material=\"repeat:1 50;\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"solid-doubleyellow\" atlas-uvs=\"totalColumns: 4; column: 3\" geometry=\"width: 0.5\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"solid-dashed\" atlas-uvs=\"totalColumns: 4; column: 2\" geometry=\"width: 0.4\"></a-mixin>\n        <a-mixin shadow=\"cast: false\" id=\"crosswalk-zebra\" atlas-uvs=\"totalColumns: 4; column: 4\" geometry=\"width: 2; height: 12\"  material=\"repeat: 1 2\"></a-mixin>\n      `,\n    stencils: `  \n        <!-- stencil markings -->\n        <img id=\"stencils-atlas\" src=\"${assetUrl}materials/stencils-atlas_2048.png\" crossorigin=\"anonymous\" />\n        <a-mixin shadow=\"cast: false\" id=\"stencils\" anisotropy atlas-uvs=\"totalRows: 4; totalColumns: 4\" scale=\"2 2 2\" material=\"src: #stencils-atlas;alphaTest: 0;transparent:true;\" geometry=\"primitive: plane; buffer: false; skipCache: true;\"></a-mixin>\n        <a-mixin id=\"right\" atlas-uvs=\"column: 3; row: 2\"></a-mixin>\n        <a-mixin id=\"left\" atlas-uvs=\"column: 3; row: 3\"></a-mixin>\n        <a-mixin id=\"both\" atlas-uvs=\"column: 2; row: 1\"></a-mixin>\n        <a-mixin id=\"all\" atlas-uvs=\"column: 3; row: 1\"></a-mixin>\n        <a-mixin id=\"left-straight\" atlas-uvs=\"column: 2; row: 3\"></a-mixin>\n        <a-mixin id=\"right-straight\" atlas-uvs=\"column: 2; row: 2\"></a-mixin>\n        <a-mixin id=\"straight\" atlas-uvs=\"column: 2; row: 4\"></a-mixin>\n        <a-mixin id=\"sharrow\" atlas-uvs=\"totalRows: 4; totalColumns: 8; column: 2; row: 3\" scale=\"1.5 3 1\"></a-mixin>\n        <a-mixin id=\"bike-arrow\" atlas-uvs=\"totalRows: 2; totalColumns: 8; column: 1; row: 2\" scale=\"1 4 1\"></a-mixin>\n        <a-mixin id=\"word-bus\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 1; row: 4\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-lane\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 2; row: 4\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-taxi\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 1; row: 3\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-only\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 2; row: 3\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-only-small\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 2; row: 3\" scale=\"2.5 2 2.5\"></a-mixin>\n        <a-mixin id=\"word-yield\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 1; row: 2\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-slow\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 2; row: 2\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-xing\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 1; row: 1\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-stop\" atlas-uvs=\"totalRows: 8; totalColumns: 8; column: 2; row: 1\" scale=\"3 3 3\"></a-mixin>\n        <a-mixin id=\"word-loading-small\" atlas-uvs=\"totalRows: 8; totalColumns: 4; column: 4; row: 1\" scale=\"2.75 1.75 2.75\"></a-mixin>\n        <a-mixin id=\"perpendicular-stalls\" atlas-uvs=\"totalRows: 4; totalColumns: 8; column: 5; row: 4\" scale=\"5 10 5\"></a-mixin>\n        <a-mixin id=\"parking-t\" atlas-uvs=\"totalRows: 8; totalColumns: 16; column: 4; row: 7\" scale=\"1.5 2 2\"></a-mixin>\n        <a-mixin id=\"painted-safety-zone\" atlas-uvs=\"totalRows: 4; totalColumns: 4; column: 4; row: 4\" scale=\"8 8 8\"></a-mixin>\n        <a-mixin id=\"hash-left\" atlas-uvs=\"totalRows: 4; totalColumns: 8; column: 7; row: 2\" scale=\"3 6 3\"></a-mixin>\n        <a-mixin id=\"hash-right\" atlas-uvs=\"totalRows: 4; totalColumns: 8; column: 8; row: 2\" scale=\"3 6 3\"></a-mixin>\n        <a-mixin id=\"hash-chevron\" atlas-uvs=\"totalRows: 4; totalColumns: 4; column: 4; row: 2\" scale=\"3 3 3\"></a-mixin>\n      `,\n    'vehicles-transit': `\n        <!-- vehicles-transit -->\n        <a-mixin shadow id=\"bus\" anisotropy gltf-model=\"url(${assetUrl}sets/flyer-bus/gltf-exports/draco/new-flyer-bus.glb)\"></a-mixin>\n        <a-mixin shadow id=\"tram\" anisotropy gltf-model=\"url(${assetUrl}sets/light-rail-vehicle/gltf-exports/draco/light-rail-vehicle-v02.glb)\"></a-mixin>\n        <a-mixin shadow id=\"trolley\" gltf-model=\"url(${assetUrl}sets/sanfrancisco-cablecar/gltf-exports/draco/sanfrancisco-cablecar_v01.glb)\"></a-mixin>\n        `,\n    dividers: `\n        <!-- dividers -->\n        <a-asset-item id=\"dividers\" src=\"${assetUrl}sets/dividers/gltf-exports/draco/dividers.glb\"></a-asset-item>        \n        <a-mixin shadow id=\"dividers-flowers\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: flowers\"></a-mixin>\n        <a-mixin shadow id=\"dividers-planting-strip\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: planting-strip\"></a-mixin>\n        <a-mixin shadow id=\"dividers-planter-box\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: planter-box\"></a-mixin>\n        <a-mixin shadow id=\"dividers-bush\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: bush\"></a-mixin>\n        <a-mixin shadow id=\"dividers-dome\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: dome\"></a-mixin>\n        <a-mixin shadow id=\"safehit\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: bollard\"></a-mixin>\n        <a-mixin shadow id=\"temporary-barricade\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: barricade\"></a-mixin>\n        <a-mixin shadow id=\"temporary-traffic-cone\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: traffic-cone\"></a-mixin>\n        <a-mixin shadow id=\"temporary-jersey-barrier-plastic\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: jersey-barrier-plastic\"></a-mixin>\n        <a-mixin shadow id=\"temporary-jersey-barrier-concrete\" scale=\"1 1 1\" rotation=\"0 0 0\" gltf-part=\"src: #dividers; part: jersey-barrier-concrete\"></a-mixin>\n      `,\n    sky: `\n        <!-- sky -->\n        <img id=\"sky\" src=\"${assetUrl}images/skies/2048-polyhaven-wasteland_clouds_puresky.jpeg\" crossorigin=\"anonymous\" />\n        <img id=\"sky-night\" src=\"${assetUrl}images/AdobeStock_286725174-min.jpeg\" crossorigin=\"anonymous\" />\n      `,\n    grounds: `\n        <!-- grounds -->\n        <img id=\"grass-texture\" src=\"${assetUrl}materials/TexturesCom_Grass0052_1_seamless_S.jpg\" crossorigin=\"anonymous\">\n        <img id=\"parking-lot-texture\" src=\"${assetUrl}materials/TexturesCom_Roads0111_1_seamless_S.jpg\" crossorigin=\"anonymous\">\n        <img id=\"asphalt-texture\" src=\"${assetUrl}materials/TexturesCom_AsphaltDamaged0057_1_seamless_S.jpg\" crossorigin=\"anonymous\">\n\n        <!-- legacy plane-based grounds for compatibility with 0.4.2 and earlier scenes, not used for new streets -->\n        <a-mixin shadow id=\"ground-grass\" rotation=\"-90 0 0\" geometry=\"primitive:plane;height:150;width:40\" material=\"src:#grass-texture;repeat:5 5;roughness:1\"></a-mixin>\n        <a-mixin shadow id=\"ground-parking-lot\" rotation=\"-90 0 0\" geometry=\"primitive:plane;height:150;width:40\" material=\"src:#parking-lot-texture;repeat:2 4;roughness:1\"></a-mixin>\n        <a-mixin shadow id=\"ground-asphalt\" rotation=\"-90 0 0\" geometry=\"primitive:plane;height:150;width:40\" material=\"src:#asphalt-texture;repeat:5 5;roughness:1\"></a-mixin>\n        <a-mixin shadow id=\"ground-tiled-concrete\" anisotropy rotation=\"-90 0 0\" geometry=\"primitive:plane;height:150;width:40\" material=\"src:#seamless-sidewalk;repeat:5 5;roughness:1\"></a-mixin>\n\n        <!-- new grounds for 0.4.4 and later --> \n        <a-mixin shadow id=\"ground-grass-material\" material=\"src:#grass-texture;repeat:2.5 5;roughness:${surfacesRoughness}\"></a-mixin>\n        <a-mixin shadow id=\"ground-parking-lot-material\" material=\"src:#parking-lot-texture;repeat:.5 2;roughness:${surfacesRoughness}\"></a-mixin>\n        <a-mixin shadow id=\"ground-asphalt-material\" material=\"src:#asphalt-texture;repeat:5 5;roughness:${surfacesRoughness}\"></a-mixin>\n        <a-mixin shadow id=\"ground-tiled-concrete-material\" material=\"src:#seamless-sidewalk;repeat:10 20;roughness:${surfacesRoughness}\"></a-mixin>\n\n        <a-asset-item id=\"fence-model\" src=\"${assetUrl}sets/fences/gltf-exports/draco/fence4.glb\"></a-asset-item>\n        <a-mixin shadow id=\"fence\" gltf-model=\"#fence-model\" scale=\"0.1 0.1 0.1\"></a-mixin>\n      `,\n    'loud-bicycle': `\n        <!-- loud-bicycle-game -->\n        <a-mixin shadow id=\"cyclist-cargo\" gltf-model=\"url(${assetUrl}sets/cargo-bike-animation/gltf-exports/draco/cargo_bike_animation_v1.glb)\"></a-mixin>\n        <a-mixin shadow id=\"cyclist1\" gltf-model=\"url(${assetUrl}sets/cyclist-animation/gltf-exports/draco/cyclist-1-animation-v1.glb)\"></a-mixin>\n        <a-mixin shadow id=\"cyclist2\" gltf-model=\"url(${assetUrl}sets/cyclist-animation/gltf-exports/draco/cyclist-2-animation-v1.glb)\"></a-mixin>\n        <a-mixin shadow id=\"cyclist3\" gltf-model=\"url(${assetUrl}sets/cyclist-animation/gltf-exports/draco/cyclist-3-animation-v1.glb)\"></a-mixin>\n        <a-mixin shadow id=\"cyclist-kid\" gltf-model=\"url(${assetUrl}sets/cyclist-animation/gltf-exports/draco/Kid_cyclist_animation_v01.glb)\"></a-mixin>\n        <a-mixin shadow id=\"cyclist-dutch\" gltf-model=\"url(${assetUrl}sets/cyclist-animation/gltf-exports/draco/Dutch_cyclist_animation_v01.glb)\"></a-mixin>\n        <a-mixin shadow id=\"loud-bicycle-mini\" gltf-model=\"url(${assetUrl}sets/cycle-horn/gltf-exports/draco/loud-bicycle-mini-horn.glb)\"></a-mixin>\n        <a-mixin shadow id=\"loud-bicycle-classic\" gltf-model=\"url(${assetUrl}sets/cycle-horn/gltf-exports/draco/loud-bicycle-classic-horn.glb)\"></a-mixin>\n        <a-mixin shadow id=\"building-school\" gltf-model=\"url(${assetUrl}sets/school-building/gltf-exports/draco/school-building.glb)\"></a-mixin>\n        <a-mixin shadow id=\"building-bar\" gltf-model=\"url(${assetUrl}sets/irish-bar-building/gltf-exports/draco/irish-bar-building.glb)\"></a-mixin>\n        <a-mixin shadow id=\"vehicle-bmw-m2\" gltf-model=\"url(${assetUrl}sets/vehicles-rig/gltf-exports/draco/BWM_m2-rig.glb)\"></a-mixin>\n        <a-mixin shadow id=\"prop-suburban-houses\" gltf-model=\"url(${assetUrl}sets/suburban-houses/gltf-exports/draco/suburban-houses.glb)\"></a-mixin>\n        <a-mixin shadow id=\"prop-banner-wfh\" gltf-model=\"url(${assetUrl}sets/wfh-banner/gltf-exports/draco/wfh-banner.glb)\"></a-mixin>\n        <a-mixin shadow id=\"prop-raygun\" gltf-model=\"url(${assetUrl}sets/ray-gun/gltf-exports/draco/rayGun.glb)\"></a-mixin>\n        <a-mixin shadow id=\"prop-co2-scrubber\" gltf-model=\"url(${assetUrl}sets/c02-scrubber/gltf-exports/draco/co2-scrubber.glb)\"></a-mixin>\n    `\n  };\n\n  function addCategoryNamesToMixins(html, categoryName) {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(html, 'text/html');\n    const mixinNodes = doc.querySelectorAll('a-mixin');\n    mixinNodes.forEach((mixinNode) => {\n      mixinNode.setAttribute('category', categoryName);\n    });\n    return doc.documentElement.innerHTML;\n  }\n\n  // JSON with grouped mixin id's. Used to create grouped mixins in Editor right panel\n  let existsCategoryArray = Object.keys(assetsObj);\n\n  if (categories) {\n    // if there is a categories attribute, then use the categories from it\n    const categoryAttrArray = categories.split(' ');\n    existsCategoryArray = existsCategoryArray.filter((key) =>\n      categoryAttrArray.includes(key)\n    );\n  }\n\n  let assetsHTML = '';\n  for (const categoryName in assetsObj) {\n    if (existsCategoryArray.includes(categoryName)) {\n      const assetsCategoryHTML = assetsObj[categoryName];\n      assetsHTML += addCategoryNamesToMixins(assetsCategoryHTML, categoryName);\n    }\n  }\n  return assetsHTML;\n}\n\nclass StreetAssets extends AFRAME.ANode {\n  constructor() {\n    super();\n    this.isAssetItem = true;\n  }\n\n  connectedCallback() {\n    const self = this;\n    var categories = this.getAttribute('categories');\n    var assetUrl = this.getAttribute('url');\n    if (!assetUrl) {\n      assetUrl = 'https://assets.3dstreet.app/';\n      this.setAttribute('url', assetUrl);\n    }\n    const assetsHTML = buildAssetHTML(assetUrl, categories);\n\n    this.insertAdjacentHTML('afterend', assetsHTML);\n\n    AFRAME.ANode.prototype.load.call(self);\n  }\n}\ncustomElements.define('street-assets', StreetAssets);\n\n// add street-assets to scene if it doesn't already exist\nvar domModifiedHandler = function (evt) {\n  // Only care about events affecting an a-scene\n  if (evt.target.nodeName !== 'A-SCENE') return;\n\n  // Try to find the a-assets element in the a-scene\n  let assets = evt.target.querySelector('a-assets');\n\n  if (!assets) {\n    // attempt to create and add the assets if they don't already exist\n    // TODO: this doesn't work well with images, so scenes must include <a-assets></a-assets> to run correctly\n    assets = document.createElement('a-assets');\n    evt.target.append(assets);\n  }\n\n  // Already have the streetmix assets. No need to add them\n  if (assets.querySelector('street-assets')) {\n    document.removeEventListener('DOMSubtreeModified', domModifiedHandler);\n    return;\n  }\n\n  // Create and add the custom street-assets element\n  const streetAssets = document.createElement('street-assets');\n  assets.append(streetAssets);\n\n  // Clean up by removing the event listener\n  document.removeEventListener('DOMSubtreeModified', domModifiedHandler);\n};\n\ndocument.addEventListener('DOMSubtreeModified', domModifiedHandler, false);\n\n/*\nUnused assets kept commented here for future reference\n        <!-- audio -->\n        <audio id=\"ambientmp3\" src=\"${assetUrl}audio/SSL_16_11_AMB_EXT_SF_ALAMO_SQ.mp3\" preload=\"none\" crossorigin=\"anonymous\"></audio>\n        <audio id=\"tram-pass-mp3\" src=\"${assetUrl}audio/Tram-Pass-By-Fast-shortened.mp3\" preload=\"auto\" crossorigin=\"anonymous\"></audio>\n        <audio id=\"trolley-pass-mp3\" src=\"${assetUrl}audio/Streetcar-passing.mp3\" preload=\"auto\" crossorigin=\"anonymous\"></audio>\n        <audio id=\"suburbs-mp3\" src=\"${assetUrl}audio/AMB_Suburbs_Afternoon_Woods_Spring_Small_ST_MKH8050-30shortened_amplified.mp3\" preload=\"none\" crossorigin=\"anonymous\"></audio>\n        <audio id=\"parking-lot-mp3\" src=\"${assetUrl}audio/Parking_lot_ambience_looping.mp3\" preload=\"none\" crossorigin=\"anonymous\"></audio>\n        <audio id=\"waterfront-mp3\" src=\"${assetUrl}audio/combined_UKdock4_and_water_pier_underneath_ambience.mp3\" preload=\"none\" crossorigin=\"anonymous\"></audio>\n        <audio id=\"suburbs2-mp3\" src=\"${assetUrl}audio/AMB_Suburbs_Spring_Day_Lawnmowers_Birds_MS_ST_MKH8050-30shortened.mp3\" preload=\"none\" crossorigin=\"anonymous\"></audio>\n        <!-- vehicle mixins with audio included -->\n        <a-mixin id=\"tram\" anisotropy gltf-model=\"#trammodel\" sound=\"src: #tram-pass-mp3;positional:false;volume: 0.4\"></a-mixin>\n        <a-mixin id=\"trolley\" gltf-model=\"#trolleymodel\" sound=\"src: #trolley-pass-mp3;positional:false;volume: 0.4\"scale=\"1 1 1\"></a-mixin>\n\n        <!-- ui / future use -->\n        <img id=\"subtitle\" src=\"${assetUrl}materials/subtitle.png\" crossorigin=\"anonymous\" />\n\n        <!-- old vehicles -->\n        <a-mixin id=\"old-sedan\" gltf-part-plus=\"src: #vehicles; part: sedan\"></a-mixin>\n        <a-asset-item id=\"old-sedan-rigged\" src=\"${assetUrl}sets/vehicles-rig/gltf-exports/draco/sedan-rig.glb\"></a-asset-item>\n        <a-mixin id=\"old-sedan-rig\" gltf-model=\"#sedan-rigged\" ></a-mixin>\n\n*/\n","/* global AFRAME */\nvar createFromJSONUtilsTested = require('../tested/create-from-json-utils-tested');\n\n// create elements from a JSON string\nAFRAME.registerComponent('create-from-json', {\n  schema: {\n    jsonString: { type: 'string', default: '' }\n  },\n  update: function (oldData) {\n    var data = this.data;\n    var el = this.el;\n    if (oldData.string && data.string !== oldData.string) {\n      // erase existing children -- not tested\n      while (el.firstChild) {\n        el.removeChild(el.lastChild);\n      }\n    }\n    createFromJSONUtilsTested.appendChildElementsFromArray(\n      JSON.parse(data.jsonString),\n      el\n    );\n  }\n});\n","/* global AFRAME, THREE */\n\nvar LOADING_MODELS = {};\nvar MODELS = {};\n\nAFRAME.registerComponent('gltf-part', {\n  schema: {\n    buffer: { default: true },\n    part: { type: 'string' },\n    src: { type: 'asset' }\n  },\n\n  init: function () {\n    this.dracoLoader = document\n      .querySelector('a-scene')\n      .systems['gltf-model'].getDRACOLoader();\n  },\n\n  update: function () {\n    var el = this.el;\n    if (!this.data.part && this.data.src) {\n      return;\n    }\n    this.getModel(function (modelPart) {\n      if (!modelPart) {\n        return;\n      }\n      el.setObject3D('mesh', modelPart);\n    });\n  },\n\n  /**\n   * Fetch, cache, and select from GLTF.\n   *\n   * @returns {object} Selected subset of model.\n   */\n  getModel: function (cb) {\n    var self = this;\n\n    // Already parsed, grab it.\n    if (MODELS[this.data.src]) {\n      cb(this.selectFromModel(MODELS[this.data.src]));\n      return;\n    }\n\n    // Currently loading, wait for it.\n    if (LOADING_MODELS[this.data.src]) {\n      return LOADING_MODELS[this.data.src].then(function (model) {\n        cb(self.selectFromModel(model));\n      });\n    }\n\n    // Not yet fetching, fetch it.\n    LOADING_MODELS[this.data.src] = new Promise(function (resolve) {\n      var loader = new THREE.GLTFLoader();\n      if (self.dracoLoader) {\n        loader.setDRACOLoader(self.dracoLoader);\n      }\n      loader.load(\n        self.data.src,\n        function (gltfModel) {\n          var model = gltfModel.scene || gltfModel.scenes[0];\n          MODELS[self.data.src] = model;\n          delete LOADING_MODELS[self.data.src];\n          cb(self.selectFromModel(model));\n          resolve(model);\n        },\n        function () {},\n        console.error\n      );\n    });\n  },\n\n  /**\n   * Search for the part name and look for a mesh.\n   */\n  selectFromModel: function (model) {\n    var mesh;\n    var part;\n\n    part = model.getObjectByName(this.data.part);\n    if (!part) {\n      console.error('[gltf-part] `' + this.data.part + '` not found in model.');\n      return;\n    }\n\n    mesh = part.getObjectByProperty('type', 'Mesh').clone(true);\n\n    if (this.data.buffer) {\n      mesh.geometry = mesh.geometry.toNonIndexed();\n      return mesh;\n    }\n    mesh.geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\n    return mesh;\n  }\n});\n","/* global AFRAME */\nvar { Notyf } = require('../lib/notyf.min.js');\n\nAFRAME.registerComponent('notify', {\n  schema: {\n    duration: { type: 'number', default: 6000 },\n    ripple: { type: 'boolean', default: false },\n    position: {\n      type: 'string',\n      default: {\n        // x: left | center | right\n        // y: top | center | bottom\n        x: 'center',\n        y: 'bottom'\n      }\n    },\n    dismissible: { type: 'boolean', default: false },\n    type: { type: 'string', default: 'info' },\n    message: { type: 'string', default: '' }\n  },\n  init: function () {\n    this.notify = new Notyf({\n      types: [\n        {\n          type: 'info',\n          background: 'blue',\n          icon: false\n        },\n        {\n          type: 'warning',\n          background: 'orange',\n          icon: false\n        }\n      ],\n      // Set your global Notyf configuration here\n      duration: this.data.duration,\n      ripple: this.data.ripple,\n      position: this.data.position,\n      dismissible: this.data.dismissible\n    });\n    this.types = this.notify.options.types.map((messType) => messType.type);\n\n    // add notify methods to STREET global objects\n    if (STREET) {\n      STREET.notify = {};\n      STREET.notify.successMessage = (messageText) => {\n        this.message(messageText, 'success');\n      };\n      STREET.notify.errorMessage = (messageText) => {\n        this.message(messageText, 'error');\n      };\n      STREET.notify.warningMessage = (messageText) => {\n        this.message(messageText, 'warning');\n      };\n    }\n  },\n  message: function (messageText, messageType = 'info') {\n    if (messageText && this.types.includes(messageType)) {\n      this.notify.open({\n        type: messageType,\n        message: messageText\n      });\n    }\n  },\n  update: function (oldData) {\n    // If `oldData` is empty, then this means we're in the initialization process.\n    // No need to update.\n    if (Object.keys(oldData).length === 0) {\n      return;\n    }\n\n    const newMessage = this.data.message;\n    const messageType = this.data.type;\n\n    if (newMessage && this.types.includes(messageType)) {\n      this.message(newMessage, messageType);\n      this.data.message = '';\n    }\n  }\n});\n","/* global AFRAME */\n\n// from https://samsunginter.net/a-frame-components/dist/ocean-plane.js\n// Requires a build from the latest a-frame master (August 2016, v0.3)\n\nAFRAME.registerComponent('wobble-normal', {\n  schema: {},\n  tick: function (t) {\n    if (!this.el.components.material.material.normalMap) return;\n    this.el.components.material.material.normalMap.offset.x +=\n      0.0001 * Math.sin(t / 10000);\n    this.el.components.material.material.normalMap.offset.y +=\n      0.0001 * Math.cos(t / 8000);\n    this.el.components.material.material.normalScale.x =\n      0.5 + 0.5 * Math.cos(t / 1000);\n    this.el.components.material.material.normalScale.x =\n      0.5 + 0.5 * Math.sin(t / 1200);\n  }\n});\n\nAFRAME.registerComponent('wobble-geometry', {\n  schema: {\n    // Wave amplitude and variance.\n    amplitude: { default: 0.1 },\n    amplitudeVariance: { default: 0.3 },\n\n    // Wave speed and variance.\n    speed: { default: 0.25 },\n    speedVariance: { default: 2 }\n  },\n  play: function () {\n    const data = this.data;\n    const geometry = (this.geometry = this.el.object3D.children[0].geometry);\n\n    console.log(this.el.object3D.children[0].geometry);\n    this.waves = [];\n    const posAttribute = geometry.getAttribute('position');\n    console.log(posAttribute);\n    for (let i = 0; i < posAttribute.count; i++) {\n      this.waves.push({\n        z: posAttribute.getZ(i),\n        ang: Math.random() * Math.PI * 2,\n        amp: data.amplitude + Math.random() * data.amplitudeVariance,\n        speed: (data.speed + Math.random() * data.speedVariance) / 1000 // radians / frame\n      });\n    }\n  },\n  tick: function (t, dt) {\n    if (!dt) return;\n\n    const posAttribute = this.geometry.getAttribute('position');\n    for (let i = 0; i < posAttribute.count; i++) {\n      const vprops = this.waves[i];\n      const value = vprops.z + Math.sin(vprops.ang) * vprops.amp;\n      posAttribute.setZ(i, value);\n      vprops.ang += vprops.speed * dt;\n    }\n    posAttribute.needsUpdate = true;\n  }\n});\n\nAFRAME.registerPrimitive('a-ocean-plane', {\n  defaultComponents: {\n    geometry: {\n      primitive: 'plane',\n      height: 1000,\n      width: 1000,\n      segmentsHeight: 100,\n      segmentsWidth: 100\n    },\n    rotation: '-90 0 0',\n    material: {\n      shader: 'standard',\n      color: '#8ab39f',\n      metalness: 1,\n      roughness: 0.2,\n      normalMap: 'url(assets/materials/waternormals.jpg)',\n      normalTextureRepeat: '50 50',\n      normalTextureOffset: '0 0',\n      normalScale: '0.5 0.5',\n      opacity: 0.8\n    },\n    'wobble-normal': {},\n    'wobble-geometry': {}\n  }\n});\n\nAFRAME.registerComponent('wobble-geometry-box', {\n  schema: {\n    // Wave amplitude and variance.\n    amplitude: { default: 0.1 },\n    amplitudeVariance: { default: 0.3 },\n\n    // Wave speed and variance.\n    speed: { default: 0.25 },\n    speedVariance: { default: 2 }\n  },\n  play: function () {\n    const data = this.data;\n    const geometry = (this.geometry = this.el.object3D.children[0].geometry);\n\n    this.waves = [];\n    const posAttribute = geometry.getAttribute('position');\n    for (let i = 0; i < posAttribute.count; i++) {\n      this.waves.push({\n        y: posAttribute.getY(i),\n        ang: Math.random() * Math.PI * 2,\n        amp: data.amplitude + Math.random() * data.amplitudeVariance,\n        speed: (data.speed + Math.random() * data.speedVariance) / 1000 // radians / frame\n      });\n    }\n  },\n  tick: function (t, dt) {\n    if (!dt) return;\n\n    const posAttribute = this.geometry.getAttribute('position');\n    for (let i = 0; i < posAttribute.count; i++) {\n      const vprops = this.waves[i];\n      const value = vprops.y + Math.sin(vprops.ang) * vprops.amp;\n      posAttribute.setY(i, value);\n      vprops.ang += vprops.speed * dt;\n    }\n    posAttribute.needsUpdate = true;\n  }\n});\n\nAFRAME.registerPrimitive('a-ocean-box', {\n  defaultComponents: {\n    geometry: {\n      primitive: 'box',\n      depth: 100,\n      width: 100,\n      height: 4,\n      segmentsHeight: 10,\n      segmentsDepth: 100,\n      segmentsWidth: 100\n    },\n    rotation: '0 0 0',\n    material: {\n      shader: 'standard',\n      color: '#8ab39f',\n      metalness: 1,\n      roughness: 0.2,\n      normalMap: 'url(https://assets.3dstreet.app/materials/waternormals.jpg)',\n      normalTextureRepeat: '10 10',\n      normalTextureOffset: '0 0',\n      normalScale: '0.5 0.5',\n      opacity: 0.8\n    },\n    'wobble-normal': {},\n    'wobble-geometry-box': {}\n  }\n});\n","/* AFRAME */\n\n// function buttonScreenshotTock() {\n//   AFRAME.scenes[0].setAttribute('screentock', 'type', 'jpg');\n//   AFRAME.scenes[0].setAttribute('screentock', 'takeScreenshot', true);\n// }\n// function buttonScreenshotTockPNG() {\n//   AFRAME.scenes[0].setAttribute('screentock', 'type', 'png');\n//   AFRAME.scenes[0].setAttribute('screentock', 'takeScreenshot', true);\n// }\n// function buttonCaptureImage() {\n//   AFRAME.scenes[0].setAttribute('screentock', 'type', 'img');\n//   AFRAME.scenes[0].setAttribute('screentock', 'imgElementSelector', '#captureImg');\n//   AFRAME.scenes[0].setAttribute('screentock', 'takeScreenshot', true);\n// }\n\nAFRAME.registerComponent('screentock', {\n  schema: {\n    takeScreenshot: { type: 'boolean', default: false },\n    filename: { type: 'string', default: 'screenshot' },\n    type: { type: 'string', default: 'jpg' }, // png, jpg, img\n    imgElementSelector: { type: 'selector' }\n  },\n  takeScreenshotNow: async function (filename, type, imgElement) {\n    const inspector = AFRAME.INSPECTOR;\n    const renderer = AFRAME.scenes[0].renderer;\n\n    // hide helpers\n    toggleHelpers(false);\n\n    function toggleHelpers(show) {\n      if (inspector && inspector.opened) inspector.sceneHelpers.visible = show;\n      if (show) {\n        document\n          .querySelector('#cameraRig')\n          .setAttribute(\n            'cursor-teleport',\n            'cameraRig: #cameraRig; cameraHead: #camera;'\n          );\n      } else {\n        document.querySelector('#cameraRig').removeAttribute('cursor-teleport');\n      }\n    }\n\n    const createCanvasWithScreenshot = async (aframeCanvas) => {\n      let screenshotCanvas = document.querySelector('#screenshotCanvas');\n      if (!screenshotCanvas) {\n        screenshotCanvas = document.createElement('canvas');\n        screenshotCanvas.id = 'screenshotCanvas';\n        screenshotCanvas.hidden = true;\n        document.body.appendChild(screenshotCanvas);\n      }\n      screenshotCanvas.width = aframeCanvas.width;\n      screenshotCanvas.height = aframeCanvas.height;\n      const ctxScreenshot = screenshotCanvas.getContext('2d');\n\n      // draw image from Aframe canvas to screenshot canvas\n      ctxScreenshot.drawImage(aframeCanvas, 0, 0);\n      // add scene title to screenshot\n      addTitleToCanvas(\n        ctxScreenshot,\n        screenshotCanvas.width,\n        screenshotCanvas.height\n      );\n      // add 3DStreet logo\n      await addLogoToCanvas(ctxScreenshot);\n      return screenshotCanvas;\n    };\n\n    function addTitleToCanvas(ctx, screenWidth, screenHeight) {\n      ctx.font = '25px Lato';\n      ctx.textAlign = 'center';\n      ctx.fillStyle = '#FFF';\n      ctx.fillText(\n        STREET.utils.getCurrentSceneTitle(),\n        screenWidth - screenWidth / 2,\n        screenHeight - 43\n      );\n    }\n\n    const addLogoToCanvas = async (ctx) => {\n      const logoImg = document.querySelector('img.viewer-logo-img');\n      const logoSVG = document.querySelector('#aframeInspector #logoImg svg');\n\n      if (logoImg) {\n        ctx.drawImage(logoImg, 0, 0, 135, 43, 40, 30, 270, 86);\n      } else if (logoSVG) {\n        const image = new Image();\n        image.src = `data:image/svg+xml;base64,${window.btoa(logoSVG.outerHTML)}`;\n        await new Promise((resolve) => {\n          image.onload = resolve;\n        });\n\n        ctx.drawImage(image, 0, 0, 135, 23, 40, 40, 270, 46);\n      }\n    };\n\n    function downloadImageDataURL(filename, dataURL, scnrenshotCanvas) {\n      const element = document.createElement('a');\n      const url = dataURL.replace(\n        /^data:image\\/[^;]/,\n        'data:application/octet-stream'\n      );\n      element.setAttribute('href', url);\n      element.setAttribute('download', filename);\n      element.style.display = 'none';\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n\n    const saveFilename = filename + '.' + type;\n\n    // render one frame\n    renderer.render(AFRAME.scenes[0].object3D, AFRAME.scenes[0].camera);\n    const screenshotCanvas = await createCanvasWithScreenshot(\n      renderer.domElement\n    );\n\n    if (type === 'img') {\n      imgElement.src = screenshotCanvas.toDataURL();\n    }\n    if (type === 'png') {\n      downloadImageDataURL(\n        saveFilename,\n        screenshotCanvas.toDataURL('image/png')\n      );\n    } else if (type === 'jpg') {\n      downloadImageDataURL(\n        saveFilename,\n        screenshotCanvas.toDataURL('image/jpeg', 0.95)\n      );\n    }\n    // show helpers\n    toggleHelpers(true);\n  },\n  update: function (oldData) {\n    // If `oldData` is empty, then this means we're in the initialization process.\n    // No need to update.\n    if (Object.keys(oldData).length === 0) {\n      return;\n    }\n\n    // this should be paused when not in use. could be throttled too\n    if (this.data.takeScreenshot) {\n      this.data.takeScreenshot = false;\n      this.takeScreenshotNow(\n        this.data.filename,\n        this.data.type,\n        this.data.imgElementSelector\n      );\n    }\n  }\n});\n","/* global AFRAME */\nconst MAPBOX_ACCESS_TOKEN_VALUE =\n  'pk.eyJ1Ijoia2llcmFuZmFyciIsImEiOiJjazB0NWh2YncwOW9rM25sd2p0YTlxemk2In0.mLl4sNGDFbz_QXk0GIK02Q';\nconst GOOGLE_API_KEY = 'AIzaSyAQshwLVKTpwTfPJxFEkEzOdP_cgmixTCQ';\n\nAFRAME.registerComponent('street-geo', {\n  schema: {\n    longitude: { type: 'number', default: 0 },\n    latitude: { type: 'number', default: 0 },\n    elevation: { type: 'number', default: 0 },\n    maps: { type: 'array', default: [] }\n  },\n  init: function () {\n    /*\n      Function names for the given function types must have the following format:\n      create function: <mapType>Create,\n      update function: <mapType>Update,\n    */\n    this.mapTypes = ['mapbox2d', 'google3d'];\n    this.elevationHeightConstant = 32.49158;\n  },\n  update: function (oldData) {\n    const data = this.data;\n\n    const updatedData = AFRAME.utils.diff(oldData, data);\n\n    for (const mapType of this.mapTypes) {\n      // create map function with name: <mapType>Create\n      const createMapFunction = this[mapType + 'Create'].bind(this);\n      if (data.maps.includes(mapType) && !this[mapType]) {\n        // create Map element and save a link to it in this[mapType]\n        this[mapType] = createMapFunction();\n      } else if (\n        data.maps.includes(mapType) &&\n        (updatedData.longitude || updatedData.latitude || updatedData.elevation)\n      ) {\n        // call update map function with name: <mapType>Update\n        this[mapType + 'Update'].bind(this)();\n      } else if (this[mapType] && !data.maps.includes(mapType)) {\n        // remove element from DOM and from this object\n        this.el.removeChild(this[mapType]);\n        this[mapType] = null;\n      }\n    }\n  },\n  mapbox2dCreate: function () {\n    const data = this.data;\n    const el = this.el;\n\n    const mapbox2dElement = document.createElement('a-entity');\n    mapbox2dElement.setAttribute('data-layer-name', 'Mapbox Satellite Streets');\n    mapbox2dElement.setAttribute(\n      'geometry',\n      'primitive: plane; width: 512; height: 512;'\n    );\n    mapbox2dElement.setAttribute(\n      'material',\n      'color: #ffffff; shader: flat; side: both; transparent: true;'\n    );\n    mapbox2dElement.setAttribute('rotation', '-90 -4.25 0');\n    mapbox2dElement.setAttribute('anisotropy', '');\n    mapbox2dElement.setAttribute('mapbox', {\n      accessToken: MAPBOX_ACCESS_TOKEN_VALUE,\n      center: `${data.longitude}, ${data.latitude}`,\n      zoom: 15,\n      style: 'mapbox://styles/mapbox/satellite-streets-v11',\n      pxToWorldRatio: 4\n    });\n    mapbox2dElement.classList.add('autocreated');\n    el.appendChild(mapbox2dElement);\n    return mapbox2dElement;\n  },\n  google3dCreate: function () {\n    const data = this.data;\n    const el = this.el;\n\n    const google3dElement = document.createElement('a-entity');\n    google3dElement.setAttribute('data-layer-name', 'Google 3D Tiles');\n    google3dElement.setAttribute('loader-3dtiles', {\n      url: 'https://tile.googleapis.com/v1/3dtiles/root.json',\n      long: data.longitude,\n      lat: data.latitude,\n      height: data.elevation - this.elevationHeightConstant,\n      googleApiKey: GOOGLE_API_KEY,\n      geoTransform: 'WGS84Cartesian',\n      maximumSSE: 48,\n      maximumMem: 400,\n      cameraEl: '#camera'\n    });\n    google3dElement.classList.add('autocreated');\n    el.appendChild(google3dElement);\n    return google3dElement;\n  },\n  google3dUpdate: function () {\n    const data = this.data;\n    this.google3d.setAttribute('loader-3dtiles', {\n      lat: data.latitude,\n      long: data.longitude,\n      height: data.elevation - this.elevationHeightConstant\n    });\n  },\n  mapbox2dUpdate: function () {\n    const data = this.data;\n    this.mapbox2d.setAttribute('mapbox', {\n      center: `${data.longitude}, ${data.latitude}`\n    });\n  }\n});\n","/* global AFRAME, XMLHttpRequest */\nvar streetplanUtils = require('../streetplan/streetplan-utils.js');\n\nAFRAME.registerComponent('streetplan-loader', {\n  dependencies: ['street'],\n  schema: {\n    streetplanStreetURL: { type: 'string' },\n    streetplanAPIURL: { type: 'string' },\n    streetplanEncJSON: { type: 'string' },\n    showBuildings: { default: true },\n    name: { default: '' }\n  },\n  streetplanResponseParse: function (streetplanResponseObject) {\n    const el = this.el;\n    const data = this.data;\n    const streetplanProject = streetplanResponseObject.project;\n\n    // convert Streetplan structure to Streetmix-like structure\n    const streetData = streetplanUtils.convertStreetStruct(streetplanProject);\n\n    const streetplanSegments = streetData.segments;\n\n    const streetplanName = streetData.name;\n    // streetplan alternative name\n    // const streetplanAltName = streetData.altName;\n\n    console.log('streetplanName', streetplanName);\n\n    let currentSceneTitle;\n    const sceneEl = this.el.sceneEl;\n    if (sceneEl && sceneEl.getAttribute('metadata')) {\n      currentSceneTitle = sceneEl.getAttribute('metadata').sceneTitle;\n    }\n    if (!currentSceneTitle) {\n      // only set title from streetplan if none exists\n      sceneEl.setAttribute('metadata', 'sceneTitle', streetplanName);\n      console.log(\n        'therefore setting metadata sceneTitle as streetplanName',\n        streetplanName\n      );\n    }\n\n    el.setAttribute('data-layer-name', 'StreetPlan • ' + streetplanName);\n\n    if (data.showBuildings) {\n      el.setAttribute('street', 'right', streetData.rightBuildingVariant);\n      el.setAttribute('street', 'left', streetData.leftBuildingVariant);\n    }\n    el.setAttribute('street', 'type', 'streetmixSegmentsMetric');\n    // set JSON attribute last or it messes things up\n    el.setAttribute(\n      'street',\n      'JSON',\n      JSON.stringify({ streetmixSegmentsMetric: streetplanSegments })\n    );\n    el.emit('streetplan-loader-street-loaded');\n  },\n  update: function (oldData) {\n    // fired at start and at each subsequent change of any schema value\n    // This method may fire a few times when viewing a streetmix street in 3dstreet:\n    // First to find the proper path, once to actually load the street, and then subsequent updates such as street name\n    const that = this;\n    const data = this.data;\n\n    // load from URL encoded Streetplan JSON\n    if (data.streetplanEncJSON) {\n      const streetplanJSON = decodeURIComponent(data.streetplanEncJSON);\n      this.streetplanResponseParse(JSON.parse(streetplanJSON));\n      return;\n    }\n\n    // if the loader has run once already, and upon update neither URL has changed, do not take action\n    if (\n      oldData.streetplanStreetURL === data.streetplanStreetURL &&\n      oldData.streetplanAPIURL === data.streetplanAPIURL\n    ) {\n      // console.log('[streetmix-loader]', 'Neither streetplanStreetURL nor streetplanAPIURL have changed in this component data update, not reloading street.')\n      return;\n    }\n\n    var request = new XMLHttpRequest();\n    console.log('[streetplan-loader]', 'GET ' + data.streetplanAPIURL);\n\n    request.open('GET', data.streetplanAPIURL, true);\n    request.onload = function () {\n      if (this.status >= 200 && this.status < 400) {\n        // Connection success\n        const streetplanResponseObject = JSON.parse(this.response);\n        that.streetplanResponseParse(streetplanResponseObject);\n      } else {\n        // We reached our target server, but it returned an error\n        console.log(\n          '[streetplan-loader]',\n          'Loading Error: We reached the target server, but it returned an error'\n        );\n      }\n    };\n    request.onerror = function () {\n      // There was a connection error of some sort\n      console.log(\n        '[streetplan-loader]',\n        'Loading Error: There was a connection error of some sort'\n      );\n    };\n    request.send();\n  }\n});\n","/* global AFRAME */\nconst { SVGLoader } = require('../lib/SVGLoader.js');\n\nAFRAME.registerComponent('svg-extruder', {\n  schema: {\n    svgString: { type: 'string' },\n    depth: { type: 'number', default: 4 },\n    bevelEnabled: { type: 'boolean', default: false },\n    bevelThickness: { type: 'number', default: 1 },\n    bevelSize: { type: 'number', default: 1 },\n    bevelOffset: { type: 'number', default: 1 },\n    bevelSegments: { type: 'number', default: 1 },\n    topElement: { type: 'boolean', default: false },\n    topColor: { type: 'color', default: 'white' },\n    topSrc: { type: 'string', default: '#grass-texture' },\n    color: { type: 'color', default: 'grey' },\n    src: { type: 'string', default: '' },\n    lineColor: { type: 'color', default: 'black' }\n  },\n  init: function () {\n    const el = this.el;\n    this.loader = new SVGLoader();\n\n    el.removeAttribute('material');\n    el.setAttribute('shadow', 'cast: true; receive: true');\n  },\n  createTopEntity: function (topGeometryArray) {\n    const data = this.data;\n    let topElement = this.el.children[0];\n    // remove existing topElement. It could be getting from loaded JSON\n    if (!topElement) {\n      topElement = document.createElement('a-entity');\n      topElement.classList.add('topElement');\n      this.el.appendChild(topElement);\n    }\n\n    // merge shape geometries into one mergedGeometry\n    const mergedGeometry = this.mergedGeometryFromArray(topGeometryArray);\n\n    mergedGeometry.translate(0, 0.15, 0);\n\n    // create a mesh with the shape geometry\n    const mergedShapeMesh = new THREE.Mesh(\n      mergedGeometry,\n      this.materialFromSrc(data.topSrc, data.topColor)\n    );\n\n    if (topElement.getObject3D('mesh')) {\n      topElement.removeObject3D('mesh');\n    }\n    topElement.setObject3D('mesh', mergedShapeMesh);\n\n    // topElement.setAttribute('material', `src:${data.src};roughness:1;repeat: 0.01 0.01`);\n  },\n  materialFromSrc: function (imgSrc, color) {\n    let texture = null;\n    // create material with texture from img element with id imgSrc\n    const textureImg = imgSrc !== '' ? document.querySelector(imgSrc) : null;\n    if (textureImg) {\n      // create texture from img element\n      texture = new THREE.Texture(textureImg);\n\n      texture.encoding = THREE.sRGBEncoding;\n\n      // set repeat property for texture\n      texture.wrapS = THREE.RepeatWrapping;\n      texture.wrapT = THREE.RepeatWrapping;\n      texture.repeat.set(0.01, 0.01);\n    }\n\n    const material = new THREE.MeshStandardMaterial({\n      color: color,\n      map: texture,\n      roughness: 1\n    });\n    if (material.map) material.map.needsUpdate = true;\n    return material;\n  },\n  mergedGeometryFromArray: function (geometryArray) {\n    // Merge array of extruded geometries into the mergedGeometry\n    const mergedGeometry =\n      THREE.BufferGeometryUtils.mergeGeometries(geometryArray);\n\n    mergedGeometry.computeBoundingBox();\n    mergedGeometry.computeVertexNormals();\n    mergedGeometry.center();\n    mergedGeometry.rotateX(Math.PI / 2);\n    mergedGeometry.scale(0.05, 0.05, 0.05);\n\n    return mergedGeometry;\n  },\n  extrudeFromSVG: function (svgString) {\n    const data = this.data;\n    const el = this.el;\n    const svgData = this.loader.parse(svgString);\n\n    const extrudeSettings = {\n      depth: data.depth,\n      bevelEnabled: data.bevelEnabled,\n      bevelThickness: data.bevelThickness,\n      bevelSize: data.bevelSize,\n      bevelOffset: data.bevelOffset,\n      bevelSegments: data.bevelSegments\n    };\n\n    const extrudedGeometryArray = [];\n    const topGeometryArray = [];\n\n    svgData.paths.forEach((path) => {\n      const shapes = SVGLoader.createShapes(path);\n\n      shapes.forEach((shape) => {\n        const topGeometry = new THREE.ExtrudeGeometry(shape, {\n          depth: 1,\n          bevelEnabled: false\n        });\n        const geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);\n        topGeometryArray.push(topGeometry);\n        extrudedGeometryArray.push(geometry);\n      });\n    });\n\n    const mergedGeometry = this.mergedGeometryFromArray(extrudedGeometryArray);\n\n    const stokeMaterial = new THREE.LineBasicMaterial({\n      color: data.lineColor\n    });\n\n    // create edges geometries and line segments from mergedGeometry\n    const linesGeometry = new THREE.EdgesGeometry(mergedGeometry);\n    const lines = new THREE.LineSegments(linesGeometry, stokeMaterial);\n\n    el.setObject3D('lines', lines);\n\n    // Finally, create a mesh with the merged geometry\n    const mergedMesh = new THREE.Mesh(\n      mergedGeometry,\n      this.materialFromSrc(data.src, data.color)\n    );\n\n    // remove existing mesh from entity\n    if (el.getObject3D('mesh')) {\n      el.removeObject3D('mesh');\n    }\n    el.setObject3D('mesh', mergedMesh);\n\n    // el.setAttribute('material', `src:${data.src};roughness:1;repeat: 0.1 0.1`);\n\n    const topElement = this.el.children[0];\n    if (data.topElement) {\n      // create entity from shapes for top level of extruded geometry\n      this.createTopEntity(topGeometryArray);\n    } else if (topElement) {\n      el.removeChild(topElement);\n    }\n  },\n  update: function (oldData) {\n    // If `oldData` is empty, then this means we're in the initialization process.\n    // No need to update.\n    // if (Object.keys(oldData).length === 0) { return; }\n\n    const svgString = this.data.svgString;\n    if (svgString) this.extrudeFromSVG(svgString);\n  }\n});\n","/* global AFRAME, Node */\n/* version: 1.0 */\n\nwindow.STREET = {};\nvar assetsUrl;\nSTREET.utils = {};\n\nfunction getSceneUuidFromURLHash() {\n  const currentHash = window.location.hash;\n  const match = currentHash.match(/#\\/scenes\\/([a-zA-Z0-9-]+)\\.json/);\n  return match && match[1] ? match[1] : null;\n}\n\nfunction getCurrentSceneId() {\n  let currentSceneId = AFRAME.scenes[0].getAttribute('metadata').sceneId;\n  // console.log('currentSceneId from scene metadata', currentSceneId);\n  const urlSceneId = getSceneUuidFromURLHash();\n  // console.log('urlSceneId', urlSceneId);\n  if (!currentSceneId) {\n    // console.log('no currentSceneId from state');\n    if (urlSceneId) {\n      currentSceneId = urlSceneId;\n      // console.log('setting currentSceneId to urlSceneId');\n    }\n  }\n  return currentSceneId;\n}\nSTREET.utils.getCurrentSceneId = getCurrentSceneId;\n\nconst getCurrentSceneTitle = () => {\n  const currentSceneTitle =\n    AFRAME.scenes[0].getAttribute('metadata').sceneTitle;\n  console.log('currentSceneTitle', currentSceneTitle);\n  return currentSceneTitle;\n};\nSTREET.utils.getCurrentSceneTitle = getCurrentSceneTitle;\n\n/*\nTakes one or more elements (from a DOM queryselector call)\nand returns a Javascript object\n*/\nfunction convertDOMElToObject(entity) {\n  const data = [];\n  const environmentElement = document.querySelector('#environment');\n  const referenceEntities = document.querySelector('#reference-layers');\n  const sceneEntities = [entity, environmentElement, referenceEntities];\n\n  // get assets url address\n  assetsUrl = document.querySelector('street-assets').getAttribute('url');\n\n  for (const entry of sceneEntities) {\n    const entityData = getElementData(entry);\n    if (entityData) {\n      data.push(entityData);\n    }\n  }\n  return {\n    title: 'scene',\n    version: '1.0',\n    data: data\n  };\n}\n\nSTREET.utils.convertDOMElToObject = convertDOMElToObject;\n\nfunction getElementData(entity) {\n  if (!entity.isEntity) {\n    return;\n  }\n  // node id's that should save without child nodes\n  const skipChildrenNodes = ['environment'];\n  const elementTree = getAttributes(entity);\n  const children = entity.childNodes;\n  if (children.length && !skipChildrenNodes.includes(elementTree.id)) {\n    elementTree['children'] = [];\n    for (const child of children) {\n      if (child.nodeType === Node.ELEMENT_NODE) {\n        elementTree['children'].push(getElementData(child));\n      }\n    }\n  }\n  return elementTree;\n}\n\nfunction getAttributes(entity) {\n  const elemObj = {};\n\n  elemObj['element'] = entity.tagName.toLowerCase();\n\n  if (entity.id) {\n    elemObj['id'] = entity.id;\n  }\n  if (entity.className) {\n    // convert from DOMTokenList to Array\n    elemObj['class'] = Array.from(entity.classList);\n  }\n  if (entity.getAttribute('mixin')) {\n    elemObj['mixin'] = entity.getAttribute('mixin');\n  }\n  if (entity.getAttribute('data-layer-name')) {\n    elemObj['data-layer-name'] = entity.getAttribute('data-layer-name');\n  }\n  const entityComponents = entity.components;\n\n  if (entityComponents) {\n    const geometryAttr = entity.getAttribute('geometry');\n    if (geometryAttr && geometryAttr.primitive) {\n      elemObj['primitive'] = geometryAttr.primitive;\n    }\n\n    elemObj['components'] = {};\n    for (const componentName in entityComponents) {\n      const modifiedProperty = getModifiedProperty(entity, componentName);\n      if (modifiedProperty) {\n        if (isEmpty(modifiedProperty)) {\n          elemObj['components'][componentName] = '';\n        } else {\n          elemObj['components'][componentName] = toPropString(modifiedProperty);\n        }\n      }\n    }\n  }\n  return elemObj;\n}\n\nfunction toPropString(propData) {\n  if (\n    typeof propData === 'string' ||\n    typeof propData === 'number' ||\n    typeof propData === 'boolean' ||\n    Array.isArray(propData)\n  ) {\n    return propData.toString();\n  }\n  if (\n    propData.isVector3 ||\n    propData.isVector2 ||\n    propData.isVector4 ||\n    (propData.hasOwnProperty('x') && propData.hasOwnProperty('y')) // eslint-disable-line\n  ) {\n    return AFRAME.utils.coordinates.stringify(propData);\n  }\n  if (typeof propData === 'object') {\n    return Object.entries(propData)\n      .map(([key, value]) => {\n        if (key === 'src') {\n          // checking to ensure the object's src value is correctly stored\n          if (value.src && !value.src.includes(assetsUrl)) {\n            // asset came from external sources. So need to save it src value if it has\n            return `${key}: ${value.src}`;\n          } else if (value.id) {\n            // asset came from 3dstreet. So it has id for link to it\n            return `${key}: #${value.id}`;\n          } else {\n            return `${key}: ${value}`;\n          }\n        } else {\n          return `${key}: ${toPropString(value)}`;\n        }\n      })\n      .join('; ');\n  }\n}\n\nfunction isSingleProperty(schema) {\n  return AFRAME.schema.isSingleProperty(schema);\n}\n\nfunction isEmpty(object) {\n  return Object.keys(object).length === 0;\n}\n\n// a list of component:value pairs to exclude from the JSON string.\n// * - remove component with any value\n// \"propName\": {\"attribute\": \"...\"} - remove attribute from component\nconst removeProps = {\n  src: {},\n  normalMap: {},\n  'set-loader-from-hash': '*',\n  'create-from-json': '*',\n  street: { JSON: '*' }\n};\n// a list of component_name:new_component_name pairs to rename in JSON string\nconst renameProps = {\n  'streetmix-loader': 'not-streetmix-loader',\n  street: 'not-street',\n  intersection: 'not-intersection'\n};\n\nfunction filterJSONstreet(streetJSON) {\n  function removeValueCheck(removeVal, value) {\n    if (AFRAME.utils.deepEqual(removeVal, value) || removeVal === '*') {\n      return true;\n    }\n    return undefined;\n  }\n\n  let stringJSON = JSON.stringify(streetJSON, function replacer(key, value) {\n    let compAttributes;\n    for (var removeKey in removeProps) {\n      // check for removing components\n      if (key === removeKey) {\n        compAttributes = AFRAME.utils.styleParser.parse(value);\n        const removeVal = removeProps[removeKey];\n        // check for deleting component's attribute\n        if (typeof removeVal === 'object' && !isEmpty(removeVal)) {\n          // remove attribute in component\n          const attrNames = Object.keys(removeVal);\n          for (var attrName of attrNames) {\n            const attrVal = removeVal[attrName];\n            if (\n              Object.prototype.hasOwnProperty.call(compAttributes, attrName) &&\n              removeValueCheck(attrVal, compAttributes[attrName])\n            ) {\n              delete compAttributes[attrName];\n            }\n          }\n        }\n        // for other cases\n        if (removeValueCheck(removeVal, value)) {\n          return undefined;\n        }\n      }\n    }\n\n    return compAttributes || value;\n  });\n  // rename components\n  for (var renameKey in renameProps) {\n    const reKey = new RegExp(`\"${renameKey}\":`, 'g');\n    stringJSON = stringJSON.replaceAll(reKey, `\"${renameProps[renameKey]}\":`);\n  }\n  return stringJSON;\n}\n\nSTREET.utils.filterJSONstreet = filterJSONstreet;\n\n/**\n * function from 3dstreet-editor/src/lib/entity.js\n * Gets the value for a component or component's property coming from mixins of\n * an element.\n *\n * If the component or component's property is not provided by mixins, the\n * functions will return `undefined`.\n *\n * @param {Component} component      Component to be found.\n * @param {string}    [propertyName] If provided, component's property to be\n *                                   found.\n * @param {Element}   source         Element owning the component.\n * @return                           The value of the component or components'\n *                                   property coming from mixins of the source.\n */\nfunction getMixedValue(component, propertyName, source) {\n  var value;\n  var reversedMixins = source.mixinEls.reverse();\n  for (var i = 0; value === undefined && i < reversedMixins.length; i++) {\n    var mixin = reversedMixins[i];\n    /* eslint-disable-next-line no-prototype-builtins */\n    if (mixin.attributes.hasOwnProperty(component.name)) {\n      if (!propertyName) {\n        value = mixin.getAttribute(component.name);\n      } else {\n        value = mixin.getAttribute(component.name)[propertyName];\n      }\n    }\n  }\n  return [component.name, value];\n}\n\nfunction shallowEqual(object1, object2) {\n  if (\n    (typeof object1 === 'string' && typeof object2 === 'string') ||\n    (typeof object1 === 'number' && typeof object2 === 'number')\n  ) {\n    return object1 === object2;\n  }\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (keys1.length !== keys2.length) {\n    return false;\n  }\n\n  for (const key of keys1) {\n    if (object1[key] !== object2[key]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getModifiedProperty(entity, componentName) {\n  const data = AFRAME.utils.entity.getComponentProperty(entity, componentName);\n\n  // if it is element's attribute\n  if (!entity.components[componentName]) {\n    if (!['id', 'class', 'tag', 'mixin'].includes(componentName)) {\n      return data;\n    } else {\n      return null;\n    }\n  }\n\n  const defaultData = entity.components[componentName].schema;\n\n  // component's data, that exists in the element's mixin\n  const [mixinCompName, mixinsData] = getMixedValue(\n    entity.components[componentName],\n    null,\n    entity\n  );\n\n  const mixinSkipProps = [\n    'src',\n    'atlas-uvs',\n    'gltf-model',\n    'gltf-part',\n    'shadow'\n  ];\n  if (mixinsData && mixinSkipProps.includes(mixinCompName)) {\n    // skip properties, if they exists in element's mixin\n    return null;\n  }\n  // If its single-property like position, rotation, etc\n  if (isSingleProperty(defaultData)) {\n    const defaultValue = defaultData.default;\n    const currentValue = data;\n    if (mixinsData && shallowEqual(mixinsData, currentValue)) {\n      // property will be get from mixin\n      return null;\n    }\n\n    if ((currentValue || defaultValue) && currentValue !== defaultValue) {\n      return data;\n    }\n  }\n  const diff = {};\n  for (const key in data) {\n    // in case the property value is not in schema, but needs to be saved\n    const defaultValue = defaultData[key] ? defaultData[key].default : '';\n    const currentValue = data[key];\n\n    if (\n      mixinsData &&\n      mixinsData[key] &&\n      shallowEqual(mixinsData[key], data[key])\n    ) {\n      continue;\n    }\n    // Some parameters could be null and '' like mergeTo\n    if (\n      (currentValue || defaultValue) &&\n      !AFRAME.utils.deepEqual(currentValue, defaultValue)\n    ) {\n      diff[key] = data[key];\n    }\n  }\n  return diff;\n}\n\nfunction createEntities(entitiesData, parentEl) {\n  const sceneElement = document.querySelector('a-scene');\n  const removeEntities = ['environment', 'reference-layers'];\n  for (const entityData of entitiesData) {\n    if (\n      entityData.id === 'street-container' &&\n      entityData.children &&\n      entityData.children[0].id === 'default-street' &&\n      entityData.children[0].components['set-loader-from-hash']\n    ) {\n      delete entityData.children[0].components['set-loader-from-hash'];\n    }\n\n    const sceneChildElement = document.getElementById(entityData.id);\n    if (sceneChildElement) {\n      if (removeEntities.includes(entityData.id)) {\n        // remove existing elements from scene\n        sceneChildElement.remove();\n      } else {\n        // or save link to the element\n        entityData.entityElement = sceneChildElement;\n      }\n    }\n\n    createEntityFromObj(entityData, sceneElement);\n  }\n}\n\nSTREET.utils.createEntities = createEntities;\n\n/*\nAdd a new entity with a list of components and children (if exists)\n * @param {object} entityData Entity definition to add:\n *   {\n *    element: String ('a-entity' for Example),\n *    id: String,\n *    class: {Array} of element classes,\n *    mixin: String,\n *    children: {Array} of entities,\n *    components: {geometry: 'primitive:box', ...}\n *   }\n * @param {Element} parentEl the parent element to which the Entity will be added\n * @return {Element} Entity created\n*/\nfunction createEntityFromObj(entityData, parentEl) {\n  const entity =\n    entityData.entityElement || document.createElement(entityData.element);\n\n  if (!entity.parentEl && parentEl) {\n    parentEl.appendChild(entity);\n  }\n\n  if (entityData['primitive']) {\n    // define a primitive in advance to apply other primitive-specific geometry properties\n    entity.setAttribute('geometry', 'primitive', entityData['primitive']);\n  }\n\n  // load this attributes in advance in right order to correctly apply other specific components\n  for (const attr of ['geometry', 'material']) {\n    if (entityData.components[attr]) {\n      entity.setAttribute(attr, entityData.components[attr]);\n      delete entityData.components[attr];\n    }\n  }\n\n  if (entityData.id) {\n    entity.setAttribute('id', entityData.id);\n  }\n\n  if (entityData.class) {\n    entity.classList.add(...entityData.class);\n  }\n\n  if (entityData['data-layer-name']) {\n    entity.setAttribute('data-layer-name', entityData['data-layer-name']);\n  }\n\n  entity.addEventListener('loaded', () => {\n    // load attributes\n    for (const attr in entityData.components) {\n      entity.setAttribute(attr, entityData.components[attr]);\n    }\n\n    if (entityData.mixin) {\n      entity.setAttribute('mixin', entityData.mixin);\n    }\n    // Ensure the components are loaded before update the UI\n\n    entity.emit('entitycreated', {}, false);\n  });\n\n  if (entityData.children) {\n    for (const childEntityData of entityData.children) {\n      createEntityFromObj(childEntityData, entity);\n    }\n  }\n}\n\n/*\n  Code imported from index.html, mix of save load utils and some ui functions\n*/\n\nAFRAME.registerComponent('metadata', {\n  schema: {\n    sceneTitle: { default: '' },\n    sceneId: { default: '' }\n  },\n  init: function () {},\n  update: function (oldData) {\n    const sceneTitle = this.data.sceneTitle;\n    if (sceneTitle !== oldData.sceneTitle) {\n      this.el.emit('newTitle', { sceneTitle: sceneTitle });\n    }\n  }\n});\n\nAFRAME.registerComponent('scene-title', {\n  schema: {\n    titleText: { default: '' }\n  },\n  init: function () {\n    this.titleElement = undefined;\n    this.el.addEventListener('newTitle', (evt) => {\n      this.el.setAttribute('scene-title', 'titleText', evt.detail.sceneTitle);\n    });\n  },\n  createTitleElement: function (titleText) {\n    const titleDiv = (this.titleElement = document.createElement('div'));\n    const newContent = document.createTextNode(titleText);\n    titleDiv.setAttribute('id', 'sceneTitle');\n    titleDiv.appendChild(newContent);\n    document.body.append(titleDiv);\n  },\n  updateTitleText: function (titleText) {\n    this.titleElement.textContent = titleText;\n  },\n  update: function (oldData) {\n    // If `oldData` is empty, then this means we're in the initialization process.\n    // No need to update.\n    if (Object.keys(oldData).length === 0) {\n      return;\n    }\n\n    const titleText = this.data.titleText;\n    const titleElement = this.titleElement;\n\n    if (titleText !== oldData.titleText) {\n      if (!titleElement) {\n        this.createTitleElement(titleText);\n      } else {\n        this.updateTitleText(titleText);\n      }\n    }\n  }\n});\n\nAFRAME.registerComponent('set-loader-from-hash', {\n  schema: {\n    defaultURL: { type: 'string' }\n  },\n  init: function () {\n    this.runOnce = false;\n  },\n  play: function () {\n    // using play instead of init method so scene loads before setting its metadata component\n    if (!this.runOnce) {\n      this.runOnce = true;\n      // get hash from window\n      const streetURL = window.location.hash.substring(1);\n      if (!streetURL) {\n        return;\n      }\n      if (streetURL.includes('//streetmix.net')) {\n        console.log(\n          '[set-loader-from-hash]',\n          'Set streetmix-loader streetmixStreetURL to',\n          streetURL\n        );\n        this.el.setAttribute(\n          'streetmix-loader',\n          'streetmixStreetURL',\n          streetURL\n        );\n      } else if (streetURL.includes('streetplan.net/')) {\n        // load from Streetplan encoded JSON in URL\n        console.log(\n          '[set-loader-from-hash]',\n          'Set streetplan-loader streetplanAPIURL to',\n          streetURL\n        );\n        this.el.setAttribute(\n          'streetplan-loader',\n          'streetplanAPIURL',\n          streetURL\n        );\n      } else {\n        // try to load JSON file from remote resource\n        console.log(\n          '[set-loader-from-hash]',\n          'Load 3DStreet scene with fetchJSON from',\n          streetURL\n        );\n        this.fetchJSON(streetURL);\n      }\n      // else {\n      //   console.log('[set-loader-from-hash]','Using default URL', this.data.defaultURL)\n      //   this.el.setAttribute('streetmix-loader', 'streetmixStreetURL', this.data.defaultURL);\n      // }\n    }\n  },\n  fetchJSON: function (requestURL) {\n    const request = new XMLHttpRequest();\n    request.open('GET', requestURL, true);\n    request.onload = function () {\n      if (this.status >= 200 && this.status < 400) {\n        // Connection success\n        // remove 'set-loader-from-hash' component from json data\n        const jsonData = JSON.parse(this.response, (key, value) =>\n          key === 'set-loader-from-hash' ? undefined : value\n        );\n\n        console.log(\n          '[set-loader-from-hash]',\n          '200 response received and JSON parsed, now createElementsFromJSON'\n        );\n        STREET.utils.createElementsFromJSON(jsonData);\n        const sceneId = getUUIDFromPath(requestURL);\n        if (sceneId) {\n          console.log('sceneId from fetchJSON from url hash loader', sceneId);\n          AFRAME.scenes[0].setAttribute('metadata', 'sceneId', sceneId);\n        }\n      } else if (this.status === 404) {\n        console.error(\n          '[set-loader-from-hash] Error trying to load scene: Resource not found.'\n        );\n        STREET.notify.errorMessage(\n          'Error trying to load scene: Resource not found.'\n        );\n      }\n    };\n    request.onerror = function () {\n      // There was a connection error of some sort\n      console.error(\n        'Loading Error: There was a connection error during JSON loading'\n      );\n      STREET.notify.errorMessage('Could not fetch scene.');\n    };\n    request.send();\n  }\n});\n\nfunction getUUIDFromPath(path) {\n  // UUID regex pattern: [0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\n  const uuidPattern =\n    /[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/;\n\n  const match = path.match(uuidPattern);\n  if (match) {\n    return match[0];\n  }\n\n  return null; // return null or whatever default value you prefer if no UUID found\n}\n\n// this use os text input prompt, delete current scene, then load streetmix file\nfunction inputStreetmix() {\n  const streetmixURL = prompt(\n    'Please enter a Streetmix URL',\n    'https://streetmix.net/kfarr/3/example-street'\n  );\n  setTimeout(function () {\n    window.location.hash = streetmixURL;\n  });\n  const streetContainerEl = document.getElementById('street-container');\n  while (streetContainerEl.firstChild) {\n    streetContainerEl.removeChild(streetContainerEl.lastChild);\n  }\n  AFRAME.scenes[0].setAttribute('metadata', 'sceneId', '');\n  AFRAME.scenes[0].setAttribute('metadata', 'sceneTitle', '');\n  streetContainerEl.innerHTML =\n    '<a-entity street streetmix-loader=\"streetmixStreetURL: ' +\n    streetmixURL +\n    '\"\"></a-entity>';\n}\n\nSTREET.utils.inputStreetmix = inputStreetmix;\n\n// JSON loading starts here\nfunction getValidJSON(stringJSON) {\n  // Preserve newlines, etc. - use valid JSON\n  // Remove non-printable and other non-valid JSON characters\n  return stringJSON\n    .replace(/'/g, '')\n    .replace(/\\n/g, '')\n    .replace(/[\\u0000-\\u0019]+/g, ''); // eslint-disable-line no-control-regex\n}\n\nfunction createElementsFromJSON(streetJSON) {\n  let streetObject = {};\n  if (typeof streetJSON === 'string') {\n    const validJSONString = getValidJSON(streetJSON);\n    streetObject = JSON.parse(validJSONString);\n  } else if (typeof streetJSON === 'object') {\n    streetObject = streetJSON;\n  }\n\n  const sceneTitle = streetObject.title;\n  if (sceneTitle) {\n    console.log('sceneTitle from createElementsFromJSON', sceneTitle);\n    AFRAME.scenes[0].setAttribute('metadata', 'sceneTitle', sceneTitle);\n  }\n\n  const streetContainerEl = document.getElementById('street-container');\n  while (streetContainerEl.firstChild) {\n    streetContainerEl.removeChild(streetContainerEl.lastChild);\n  }\n\n  createEntities(streetObject.data, streetContainerEl);\n  STREET.notify.successMessage('Scene loaded from JSON');\n}\n\nSTREET.utils.createElementsFromJSON = createElementsFromJSON;\n\n// handle viewer widget click to open 3dstreet json scene\nfunction fileJSON() {\n  const reader = new FileReader();\n  reader.onload = function () {\n    AFRAME.scenes[0].setAttribute('metadata', 'sceneId', '');\n    AFRAME.scenes[0].setAttribute('metadata', 'sceneTitle', '');\n    createElementsFromJSON(reader.result);\n  };\n  reader.readAsText(this.files[0]);\n}\n\n// temporarily place the UI function in utils, which is used in index.html.\nSTREET.utils.fileJSON = fileJSON;\n","const {\n  Box2,\n  BufferGeometry,\n  FileLoader,\n  Float32BufferAttribute,\n  Loader,\n  Matrix3,\n  Path,\n  Shape,\n  ShapePath,\n  ShapeUtils,\n  SRGBColorSpace,\n  Vector2,\n  Vector3\n} = THREE;\n\nconst COLOR_SPACE_SVG = SRGBColorSpace;\n\nclass SVGLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\t// Default dots per inch\n\t\tthis.defaultDPI = 90;\n\n\t\t// Accepted units: 'mm', 'cm', 'in', 'pt', 'pc', 'px'\n\t\tthis.defaultUnit = 'px';\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( text ) {\n\n\t\tconst scope = this;\n\n\t\tfunction parseNode( node, style ) {\n\n\t\t\tif ( node.nodeType !== 1 ) return;\n\n\t\t\tconst transform = getNodeTransform( node );\n\n\t\t\tlet isDefsNode = false;\n\n\t\t\tlet path = null;\n\n\t\t\tswitch ( node.nodeName ) {\n\n\t\t\t\tcase 'svg':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'style':\n\t\t\t\t\tparseCSSStylesheet( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'g':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'path':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tif ( node.hasAttribute( 'd' ) ) path = parsePathNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'rect':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseRectNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'polygon':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parsePolygonNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'polyline':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parsePolylineNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'circle':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseCircleNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ellipse':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseEllipseNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'line':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\t\t\t\t\tpath = parseLineNode( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'defs':\n\t\t\t\t\tisDefsNode = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'use':\n\t\t\t\t\tstyle = parseStyle( node, style );\n\n\t\t\t\t\tconst href = node.getAttributeNS( 'http://www.w3.org/1999/xlink', 'href' ) || '';\n\t\t\t\t\tconst usedNodeId = href.substring( 1 );\n\t\t\t\t\tconst usedNode = node.viewportElement.getElementById( usedNodeId );\n\t\t\t\t\tif ( usedNode ) {\n\n\t\t\t\t\t\tparseNode( usedNode, style );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'SVGLoader: \\'use node\\' references non-existent node id: ' + usedNodeId );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// console.log( node );\n\n\t\t\t}\n\n\t\t\tif ( path ) {\n\n\t\t\t\tif ( style.fill !== undefined && style.fill !== 'none' ) {\n\n\t\t\t\t\tpath.color.setStyle( style.fill, COLOR_SPACE_SVG );\n\n\t\t\t\t}\n\n\t\t\t\ttransformPath( path, currentTransform );\n\n\t\t\t\tpaths.push( path );\n\n\t\t\t\tpath.userData = { node: node, style: style };\n\n\t\t\t}\n\n\t\t\tconst childNodes = node.childNodes;\n\n\t\t\tfor ( let i = 0; i < childNodes.length; i ++ ) {\n\n\t\t\t\tconst node = childNodes[ i ];\n\n\t\t\t\tif ( isDefsNode && node.nodeName !== 'style' && node.nodeName !== 'defs' ) {\n\n\t\t\t\t\t// Ignore everything in defs except CSS style definitions\n\t\t\t\t\t// and nested defs, because it is OK by the standard to have\n\t\t\t\t\t// <style/> there.\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tparseNode( node, style );\n\n\t\t\t}\n\n\n\t\t\tif ( transform ) {\n\n\t\t\t\ttransformStack.pop();\n\n\t\t\t\tif ( transformStack.length > 0 ) {\n\n\t\t\t\t\tcurrentTransform.copy( transformStack[ transformStack.length - 1 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentTransform.identity();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parsePathNode( node ) {\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\tconst point = new Vector2();\n\t\t\tconst control = new Vector2();\n\n\t\t\tconst firstPoint = new Vector2();\n\t\t\tlet isFirstPoint = true;\n\t\t\tlet doSetFirstPoint = false;\n\n\t\t\tconst d = node.getAttribute( 'd' );\n\n\t\t\tif ( d === '' || d === 'none' ) return null;\n\n\t\t\t// console.log( d );\n\n\t\t\tconst commands = d.match( /[a-df-z][^a-df-z]*/ig );\n\n\t\t\tfor ( let i = 0, l = commands.length; i < l; i ++ ) {\n\n\t\t\t\tconst command = commands[ i ];\n\n\t\t\t\tconst type = command.charAt( 0 );\n\t\t\t\tconst data = command.slice( 1 ).trim();\n\n\t\t\t\tif ( isFirstPoint === true ) {\n\n\t\t\t\t\tdoSetFirstPoint = true;\n\t\t\t\t\tisFirstPoint = false;\n\n\t\t\t\t}\n\n\t\t\t\tlet numbers;\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'M':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\n\t\t\t\t\t\t\tif ( j === 0 ) {\n\n\t\t\t\t\t\t\t\tpath.moveTo( point.x, point.y );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( j === 0 ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'H':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.x = numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'V':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.y = numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'L':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'C':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 6 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 2 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 3 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 4 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 5 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = numbers[ j + 2 ];\n\t\t\t\t\t\t\tcontrol.y = numbers[ j + 3 ];\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 4 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 5 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'S':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tgetReflection( point.x, control.x ),\n\t\t\t\t\t\t\t\tgetReflection( point.y, control.y ),\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 2 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Q':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 2 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'T':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tconst rx = getReflection( point.x, control.x );\n\t\t\t\t\t\t\tconst ry = getReflection( point.y, control.y );\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\trx,\n\t\t\t\t\t\t\t\try,\n\t\t\t\t\t\t\t\tnumbers[ j + 0 ],\n\t\t\t\t\t\t\t\tnumbers[ j + 1 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = rx;\n\t\t\t\t\t\t\tcontrol.y = ry;\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 1 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'A':\n\t\t\t\t\t\tnumbers = parseFloats( data, [ 3, 4 ], 7 );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 7 ) {\n\n\t\t\t\t\t\t\t// skip command if start point == end point\n\t\t\t\t\t\t\tif ( numbers[ j + 5 ] == point.x && numbers[ j + 6 ] == point.y ) continue;\n\n\t\t\t\t\t\t\tconst start = point.clone();\n\t\t\t\t\t\t\tpoint.x = numbers[ j + 5 ];\n\t\t\t\t\t\t\tpoint.y = numbers[ j + 6 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tparseArcCommand(\n\t\t\t\t\t\t\t\tpath, numbers[ j ], numbers[ j + 1 ], numbers[ j + 2 ], numbers[ j + 3 ], numbers[ j + 4 ], start, point\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\n\t\t\t\t\t\t\tif ( j === 0 ) {\n\n\t\t\t\t\t\t\t\tpath.moveTo( point.x, point.y );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( j === 0 ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'h':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.x += numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpoint.y += numbers[ j ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 1 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tpath.lineTo( point.x, point.y );\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 6 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 2 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 3 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 4 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 5 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = point.x + numbers[ j + 2 ];\n\t\t\t\t\t\t\tcontrol.y = point.y + numbers[ j + 3 ];\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 4 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 5 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 's':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\t\t\t\tgetReflection( point.x, control.x ),\n\t\t\t\t\t\t\t\tgetReflection( point.y, control.y ),\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 2 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = point.x + numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = point.y + numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'q':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 4 ) {\n\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ],\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 2 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 3 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = point.x + numbers[ j + 0 ];\n\t\t\t\t\t\t\tcontrol.y = point.y + numbers[ j + 1 ];\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 2 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 3 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tnumbers = parseFloats( data );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 2 ) {\n\n\t\t\t\t\t\t\tconst rx = getReflection( point.x, control.x );\n\t\t\t\t\t\t\tconst ry = getReflection( point.y, control.y );\n\t\t\t\t\t\t\tpath.quadraticCurveTo(\n\t\t\t\t\t\t\t\trx,\n\t\t\t\t\t\t\t\try,\n\t\t\t\t\t\t\t\tpoint.x + numbers[ j + 0 ],\n\t\t\t\t\t\t\t\tpoint.y + numbers[ j + 1 ]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcontrol.x = rx;\n\t\t\t\t\t\t\tcontrol.y = ry;\n\t\t\t\t\t\t\tpoint.x = point.x + numbers[ j + 0 ];\n\t\t\t\t\t\t\tpoint.y = point.y + numbers[ j + 1 ];\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'a':\n\t\t\t\t\t\tnumbers = parseFloats( data, [ 3, 4 ], 7 );\n\n\t\t\t\t\t\tfor ( let j = 0, jl = numbers.length; j < jl; j += 7 ) {\n\n\t\t\t\t\t\t\t// skip command if no displacement\n\t\t\t\t\t\t\tif ( numbers[ j + 5 ] == 0 && numbers[ j + 6 ] == 0 ) continue;\n\n\t\t\t\t\t\t\tconst start = point.clone();\n\t\t\t\t\t\t\tpoint.x += numbers[ j + 5 ];\n\t\t\t\t\t\t\tpoint.y += numbers[ j + 6 ];\n\t\t\t\t\t\t\tcontrol.x = point.x;\n\t\t\t\t\t\t\tcontrol.y = point.y;\n\t\t\t\t\t\t\tparseArcCommand(\n\t\t\t\t\t\t\t\tpath, numbers[ j ], numbers[ j + 1 ], numbers[ j + 2 ], numbers[ j + 3 ], numbers[ j + 4 ], start, point\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ( j === 0 && doSetFirstPoint === true ) firstPoint.copy( point );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\tcase 'z':\n\t\t\t\t\t\tpath.currentPath.autoClose = true;\n\n\t\t\t\t\t\tif ( path.currentPath.curves.length > 0 ) {\n\n\t\t\t\t\t\t\t// Reset point to beginning of Path\n\t\t\t\t\t\t\tpoint.copy( firstPoint );\n\t\t\t\t\t\t\tpath.currentPath.currentPoint.copy( point );\n\t\t\t\t\t\t\tisFirstPoint = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn( command );\n\n\t\t\t\t}\n\n\t\t\t\t// console.log( type, parseFloats( data ), parseFloats( data ).length  )\n\n\t\t\t\tdoSetFirstPoint = false;\n\n\t\t\t}\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseCSSStylesheet( node ) {\n\n\t\t\tif ( ! node.sheet || ! node.sheet.cssRules || ! node.sheet.cssRules.length ) return;\n\n\t\t\tfor ( let i = 0; i < node.sheet.cssRules.length; i ++ ) {\n\n\t\t\t\tconst stylesheet = node.sheet.cssRules[ i ];\n\n\t\t\t\tif ( stylesheet.type !== 1 ) continue;\n\n\t\t\t\tconst selectorList = stylesheet.selectorText\n\t\t\t\t\t.split( /,/gm )\n\t\t\t\t\t.filter( Boolean )\n\t\t\t\t\t.map( i => i.trim() );\n\n\t\t\t\tfor ( let j = 0; j < selectorList.length; j ++ ) {\n\n\t\t\t\t\t// Remove empty rules\n\t\t\t\t\tconst definitions = Object.fromEntries(\n\t\t\t\t\t\tObject.entries( stylesheet.style ).filter( ( [ , v ] ) => v !== '' )\n\t\t\t\t\t);\n\n\t\t\t\t\tstylesheets[ selectorList[ j ] ] = Object.assign(\n\t\t\t\t\t\tstylesheets[ selectorList[ j ] ] || {},\n\t\t\t\t\t\tdefinitions\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t/**\n\t\t * https://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\n\t\t * https://mortoray.com/2017/02/16/rendering-an-svg-elliptical-arc-as-bezier-curves/ Appendix: Endpoint to center arc conversion\n\t\t * From\n\t\t * rx ry x-axis-rotation large-arc-flag sweep-flag x y\n\t\t * To\n\t\t * aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation\n\t\t */\n\n\t\tfunction parseArcCommand( path, rx, ry, x_axis_rotation, large_arc_flag, sweep_flag, start, end ) {\n\n\t\t\tif ( rx == 0 || ry == 0 ) {\n\n\t\t\t\t// draw a line if either of the radii == 0\n\t\t\t\tpath.lineTo( end.x, end.y );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tx_axis_rotation = x_axis_rotation * Math.PI / 180;\n\n\t\t\t// Ensure radii are positive\n\t\t\trx = Math.abs( rx );\n\t\t\try = Math.abs( ry );\n\n\t\t\t// Compute (x1', y1')\n\t\t\tconst dx2 = ( start.x - end.x ) / 2.0;\n\t\t\tconst dy2 = ( start.y - end.y ) / 2.0;\n\t\t\tconst x1p = Math.cos( x_axis_rotation ) * dx2 + Math.sin( x_axis_rotation ) * dy2;\n\t\t\tconst y1p = - Math.sin( x_axis_rotation ) * dx2 + Math.cos( x_axis_rotation ) * dy2;\n\n\t\t\t// Compute (cx', cy')\n\t\t\tlet rxs = rx * rx;\n\t\t\tlet rys = ry * ry;\n\t\t\tconst x1ps = x1p * x1p;\n\t\t\tconst y1ps = y1p * y1p;\n\n\t\t\t// Ensure radii are large enough\n\t\t\tconst cr = x1ps / rxs + y1ps / rys;\n\n\t\t\tif ( cr > 1 ) {\n\n\t\t\t\t// scale up rx,ry equally so cr == 1\n\t\t\t\tconst s = Math.sqrt( cr );\n\t\t\t\trx = s * rx;\n\t\t\t\try = s * ry;\n\t\t\t\trxs = rx * rx;\n\t\t\t\trys = ry * ry;\n\n\t\t\t}\n\n\t\t\tconst dq = ( rxs * y1ps + rys * x1ps );\n\t\t\tconst pq = ( rxs * rys - dq ) / dq;\n\t\t\tlet q = Math.sqrt( Math.max( 0, pq ) );\n\t\t\tif ( large_arc_flag === sweep_flag ) q = - q;\n\t\t\tconst cxp = q * rx * y1p / ry;\n\t\t\tconst cyp = - q * ry * x1p / rx;\n\n\t\t\t// Step 3: Compute (cx, cy) from (cx', cy')\n\t\t\tconst cx = Math.cos( x_axis_rotation ) * cxp - Math.sin( x_axis_rotation ) * cyp + ( start.x + end.x ) / 2;\n\t\t\tconst cy = Math.sin( x_axis_rotation ) * cxp + Math.cos( x_axis_rotation ) * cyp + ( start.y + end.y ) / 2;\n\n\t\t\t// Step 4: Compute θ1 and Δθ\n\t\t\tconst theta = svgAngle( 1, 0, ( x1p - cxp ) / rx, ( y1p - cyp ) / ry );\n\t\t\tconst delta = svgAngle( ( x1p - cxp ) / rx, ( y1p - cyp ) / ry, ( - x1p - cxp ) / rx, ( - y1p - cyp ) / ry ) % ( Math.PI * 2 );\n\n\t\t\tpath.currentPath.absellipse( cx, cy, rx, ry, theta, theta + delta, sweep_flag === 0, x_axis_rotation );\n\n\t\t}\n\n\t\tfunction svgAngle( ux, uy, vx, vy ) {\n\n\t\t\tconst dot = ux * vx + uy * vy;\n\t\t\tconst len = Math.sqrt( ux * ux + uy * uy ) * Math.sqrt( vx * vx + vy * vy );\n\t\t\tlet ang = Math.acos( Math.max( - 1, Math.min( 1, dot / len ) ) ); // floating point precision, slightly over values appear\n\t\t\tif ( ( ux * vy - uy * vx ) < 0 ) ang = - ang;\n\t\t\treturn ang;\n\n\t\t}\n\n\t\t/*\n\t\t* According to https://www.w3.org/TR/SVG/shapes.html#RectElementRXAttribute\n\t\t* rounded corner should be rendered to elliptical arc, but bezier curve does the job well enough\n\t\t*/\n\t\tfunction parseRectNode( node ) {\n\n\t\t\tconst x = parseFloatWithUnits( node.getAttribute( 'x' ) || 0 );\n\t\t\tconst y = parseFloatWithUnits( node.getAttribute( 'y' ) || 0 );\n\t\t\tconst rx = parseFloatWithUnits( node.getAttribute( 'rx' ) || node.getAttribute( 'ry' ) || 0 );\n\t\t\tconst ry = parseFloatWithUnits( node.getAttribute( 'ry' ) || node.getAttribute( 'rx' ) || 0 );\n\t\t\tconst w = parseFloatWithUnits( node.getAttribute( 'width' ) );\n\t\t\tconst h = parseFloatWithUnits( node.getAttribute( 'height' ) );\n\n\t\t\t// Ellipse arc to Bezier approximation Coefficient (Inversed). See:\n\t\t\t// https://spencermortensen.com/articles/bezier-circle/\n\t\t\tconst bci = 1 - 0.551915024494;\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\t// top left\n\t\t\tpath.moveTo( x + rx, y );\n\n\t\t\t// top right\n\t\t\tpath.lineTo( x + w - rx, y );\n\t\t\tif ( rx !== 0 || ry !== 0 ) {\n\n\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\tx + w - rx * bci,\n\t\t\t\t\ty,\n\t\t\t\t\tx + w,\n\t\t\t\t\ty + ry * bci,\n\t\t\t\t\tx + w,\n\t\t\t\t\ty + ry\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\t// bottom right\n\t\t\tpath.lineTo( x + w, y + h - ry );\n\t\t\tif ( rx !== 0 || ry !== 0 ) {\n\n\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\tx + w,\n\t\t\t\t\ty + h - ry * bci,\n\t\t\t\t\tx + w - rx * bci,\n\t\t\t\t\ty + h,\n\t\t\t\t\tx + w - rx,\n\t\t\t\t\ty + h\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\t// bottom left\n\t\t\tpath.lineTo( x + rx, y + h );\n\t\t\tif ( rx !== 0 || ry !== 0 ) {\n\n\t\t\t\tpath.bezierCurveTo(\n\t\t\t\t\tx + rx * bci,\n\t\t\t\t\ty + h,\n\t\t\t\t\tx,\n\t\t\t\t\ty + h - ry * bci,\n\t\t\t\t\tx,\n\t\t\t\t\ty + h - ry\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\t// back to top left\n\t\t\tpath.lineTo( x, y + ry );\n\t\t\tif ( rx !== 0 || ry !== 0 ) {\n\n\t\t\t\tpath.bezierCurveTo( x, y + ry * bci, x + rx * bci, y, x + rx, y );\n\n\t\t\t}\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parsePolygonNode( node ) {\n\n\t\t\tfunction iterator( match, a, b ) {\n\n\t\t\t\tconst x = parseFloatWithUnits( a );\n\t\t\t\tconst y = parseFloatWithUnits( b );\n\n\t\t\t\tif ( index === 0 ) {\n\n\t\t\t\t\tpath.moveTo( x, y );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpath.lineTo( x, y );\n\n\t\t\t\t}\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\tconst regex = /([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)(?:,|\\s)([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)/g;\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\tlet index = 0;\n\n\t\t\tnode.getAttribute( 'points' ).replace( regex, iterator );\n\n\t\t\tpath.currentPath.autoClose = true;\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parsePolylineNode( node ) {\n\n\t\t\tfunction iterator( match, a, b ) {\n\n\t\t\t\tconst x = parseFloatWithUnits( a );\n\t\t\t\tconst y = parseFloatWithUnits( b );\n\n\t\t\t\tif ( index === 0 ) {\n\n\t\t\t\t\tpath.moveTo( x, y );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpath.lineTo( x, y );\n\n\t\t\t\t}\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\tconst regex = /([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)(?:,|\\s)([+-]?\\d*\\.?\\d+(?:e[+-]?\\d+)?)/g;\n\n\t\t\tconst path = new ShapePath();\n\n\t\t\tlet index = 0;\n\n\t\t\tnode.getAttribute( 'points' ).replace( regex, iterator );\n\n\t\t\tpath.currentPath.autoClose = false;\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseCircleNode( node ) {\n\n\t\t\tconst x = parseFloatWithUnits( node.getAttribute( 'cx' ) || 0 );\n\t\t\tconst y = parseFloatWithUnits( node.getAttribute( 'cy' ) || 0 );\n\t\t\tconst r = parseFloatWithUnits( node.getAttribute( 'r' ) || 0 );\n\n\t\t\tconst subpath = new Path();\n\t\t\tsubpath.absarc( x, y, r, 0, Math.PI * 2 );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.subPaths.push( subpath );\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseEllipseNode( node ) {\n\n\t\t\tconst x = parseFloatWithUnits( node.getAttribute( 'cx' ) || 0 );\n\t\t\tconst y = parseFloatWithUnits( node.getAttribute( 'cy' ) || 0 );\n\t\t\tconst rx = parseFloatWithUnits( node.getAttribute( 'rx' ) || 0 );\n\t\t\tconst ry = parseFloatWithUnits( node.getAttribute( 'ry' ) || 0 );\n\n\t\t\tconst subpath = new Path();\n\t\t\tsubpath.absellipse( x, y, rx, ry, 0, Math.PI * 2 );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.subPaths.push( subpath );\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\tfunction parseLineNode( node ) {\n\n\t\t\tconst x1 = parseFloatWithUnits( node.getAttribute( 'x1' ) || 0 );\n\t\t\tconst y1 = parseFloatWithUnits( node.getAttribute( 'y1' ) || 0 );\n\t\t\tconst x2 = parseFloatWithUnits( node.getAttribute( 'x2' ) || 0 );\n\t\t\tconst y2 = parseFloatWithUnits( node.getAttribute( 'y2' ) || 0 );\n\n\t\t\tconst path = new ShapePath();\n\t\t\tpath.moveTo( x1, y1 );\n\t\t\tpath.lineTo( x2, y2 );\n\t\t\tpath.currentPath.autoClose = false;\n\n\t\t\treturn path;\n\n\t\t}\n\n\t\t//\n\n\t\tfunction parseStyle( node, style ) {\n\n\t\t\tstyle = Object.assign( {}, style ); // clone style\n\n\t\t\tlet stylesheetStyles = {};\n\n\t\t\tif ( node.hasAttribute( 'class' ) ) {\n\n\t\t\t\tconst classSelectors = node.getAttribute( 'class' )\n\t\t\t\t\t.split( /\\s/ )\n\t\t\t\t\t.filter( Boolean )\n\t\t\t\t\t.map( i => i.trim() );\n\n\t\t\t\tfor ( let i = 0; i < classSelectors.length; i ++ ) {\n\n\t\t\t\t\tstylesheetStyles = Object.assign( stylesheetStyles, stylesheets[ '.' + classSelectors[ i ] ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( node.hasAttribute( 'id' ) ) {\n\n\t\t\t\tstylesheetStyles = Object.assign( stylesheetStyles, stylesheets[ '#' + node.getAttribute( 'id' ) ] );\n\n\t\t\t}\n\n\t\t\tfunction addStyle( svgName, jsName, adjustFunction ) {\n\n\t\t\t\tif ( adjustFunction === undefined ) adjustFunction = function copy( v ) {\n\n\t\t\t\t\tif ( v.startsWith( 'url' ) ) console.warn( 'SVGLoader: url access in attributes is not implemented.' );\n\n\t\t\t\t\treturn v;\n\n\t\t\t\t};\n\n\t\t\t\tif ( node.hasAttribute( svgName ) ) style[ jsName ] = adjustFunction( node.getAttribute( svgName ) );\n\t\t\t\tif ( stylesheetStyles[ svgName ] ) style[ jsName ] = adjustFunction( stylesheetStyles[ svgName ] );\n\t\t\t\tif ( node.style && node.style[ svgName ] !== '' ) style[ jsName ] = adjustFunction( node.style[ svgName ] );\n\n\t\t\t}\n\n\t\t\tfunction clamp( v ) {\n\n\t\t\t\treturn Math.max( 0, Math.min( 1, parseFloatWithUnits( v ) ) );\n\n\t\t\t}\n\n\t\t\tfunction positive( v ) {\n\n\t\t\t\treturn Math.max( 0, parseFloatWithUnits( v ) );\n\n\t\t\t}\n\n\t\t\taddStyle( 'fill', 'fill' );\n\t\t\taddStyle( 'fill-opacity', 'fillOpacity', clamp );\n\t\t\taddStyle( 'fill-rule', 'fillRule' );\n\t\t\taddStyle( 'opacity', 'opacity', clamp );\n\t\t\taddStyle( 'stroke', 'stroke' );\n\t\t\taddStyle( 'stroke-opacity', 'strokeOpacity', clamp );\n\t\t\taddStyle( 'stroke-width', 'strokeWidth', positive );\n\t\t\taddStyle( 'stroke-linejoin', 'strokeLineJoin' );\n\t\t\taddStyle( 'stroke-linecap', 'strokeLineCap' );\n\t\t\taddStyle( 'stroke-miterlimit', 'strokeMiterLimit', positive );\n\t\t\taddStyle( 'visibility', 'visibility' );\n\n\t\t\treturn style;\n\n\t\t}\n\n\t\t// http://www.w3.org/TR/SVG11/implnote.html#PathElementImplementationNotes\n\n\t\tfunction getReflection( a, b ) {\n\n\t\t\treturn a - ( b - a );\n\n\t\t}\n\n\t\t// from https://github.com/ppvg/svg-numbers (MIT License)\n\n\t\tfunction parseFloats( input, flags, stride ) {\n\n\t\t\tif ( typeof input !== 'string' ) {\n\n\t\t\t\tthrow new TypeError( 'Invalid input: ' + typeof input );\n\n\t\t\t}\n\n\t\t\t// Character groups\n\t\t\tconst RE = {\n\t\t\t\tSEPARATOR: /[ \\t\\r\\n\\,.\\-+]/,\n\t\t\t\tWHITESPACE: /[ \\t\\r\\n]/,\n\t\t\t\tDIGIT: /[\\d]/,\n\t\t\t\tSIGN: /[-+]/,\n\t\t\t\tPOINT: /\\./,\n\t\t\t\tCOMMA: /,/,\n\t\t\t\tEXP: /e/i,\n\t\t\t\tFLAGS: /[01]/\n\t\t\t};\n\n\t\t\t// States\n\t\t\tconst SEP = 0;\n\t\t\tconst INT = 1;\n\t\t\tconst FLOAT = 2;\n\t\t\tconst EXP = 3;\n\n\t\t\tlet state = SEP;\n\t\t\tlet seenComma = true;\n\t\t\tlet number = '', exponent = '';\n\t\t\tconst result = [];\n\n\t\t\tfunction throwSyntaxError( current, i, partial ) {\n\n\t\t\t\tconst error = new SyntaxError( 'Unexpected character \"' + current + '\" at index ' + i + '.' );\n\t\t\t\terror.partial = partial;\n\t\t\t\tthrow error;\n\n\t\t\t}\n\n\t\t\tfunction newNumber() {\n\n\t\t\t\tif ( number !== '' ) {\n\n\t\t\t\t\tif ( exponent === '' ) result.push( Number( number ) );\n\t\t\t\t\telse result.push( Number( number ) * Math.pow( 10, Number( exponent ) ) );\n\n\t\t\t\t}\n\n\t\t\t\tnumber = '';\n\t\t\t\texponent = '';\n\n\t\t\t}\n\n\t\t\tlet current;\n\t\t\tconst length = input.length;\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tcurrent = input[ i ];\n\n\t\t\t\t// check for flags\n\t\t\t\tif ( Array.isArray( flags ) && flags.includes( result.length % stride ) && RE.FLAGS.test( current ) ) {\n\n\t\t\t\t\tstate = INT;\n\t\t\t\t\tnumber = current;\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// parse until next number\n\t\t\t\tif ( state === SEP ) {\n\n\t\t\t\t\t// eat whitespace\n\t\t\t\t\tif ( RE.WHITESPACE.test( current ) ) {\n\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// start new number\n\t\t\t\t\tif ( RE.DIGIT.test( current ) || RE.SIGN.test( current ) ) {\n\n\t\t\t\t\t\tstate = INT;\n\t\t\t\t\t\tnumber = current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.POINT.test( current ) ) {\n\n\t\t\t\t\t\tstate = FLOAT;\n\t\t\t\t\t\tnumber = current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// throw on double commas (e.g. \"1, , 2\")\n\t\t\t\t\tif ( RE.COMMA.test( current ) ) {\n\n\t\t\t\t\t\tif ( seenComma ) {\n\n\t\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tseenComma = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// parse integer part\n\t\t\t\tif ( state === INT ) {\n\n\t\t\t\t\tif ( RE.DIGIT.test( current ) ) {\n\n\t\t\t\t\t\tnumber += current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.POINT.test( current ) ) {\n\n\t\t\t\t\t\tnumber += current;\n\t\t\t\t\t\tstate = FLOAT;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.EXP.test( current ) ) {\n\n\t\t\t\t\t\tstate = EXP;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// throw on double signs (\"-+1\"), but not on sign as separator (\"-1-2\")\n\t\t\t\t\tif ( RE.SIGN.test( current )\n\t\t\t\t\t\t\t&& number.length === 1\n\t\t\t\t\t\t\t&& RE.SIGN.test( number[ 0 ] ) ) {\n\n\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// parse decimal part\n\t\t\t\tif ( state === FLOAT ) {\n\n\t\t\t\t\tif ( RE.DIGIT.test( current ) ) {\n\n\t\t\t\t\t\tnumber += current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.EXP.test( current ) ) {\n\n\t\t\t\t\t\tstate = EXP;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// throw on double decimal points (e.g. \"1..2\")\n\t\t\t\t\tif ( RE.POINT.test( current ) && number[ number.length - 1 ] === '.' ) {\n\n\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// parse exponent part\n\t\t\t\tif ( state === EXP ) {\n\n\t\t\t\t\tif ( RE.DIGIT.test( current ) ) {\n\n\t\t\t\t\t\texponent += current;\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( RE.SIGN.test( current ) ) {\n\n\t\t\t\t\t\tif ( exponent === '' ) {\n\n\t\t\t\t\t\t\texponent += current;\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( exponent.length === 1 && RE.SIGN.test( exponent ) ) {\n\n\t\t\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\t\t\t\t// end of number\n\t\t\t\tif ( RE.WHITESPACE.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = SEP;\n\t\t\t\t\tseenComma = false;\n\n\t\t\t\t} else if ( RE.COMMA.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = SEP;\n\t\t\t\t\tseenComma = true;\n\n\t\t\t\t} else if ( RE.SIGN.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = INT;\n\t\t\t\t\tnumber = current;\n\n\t\t\t\t} else if ( RE.POINT.test( current ) ) {\n\n\t\t\t\t\tnewNumber();\n\t\t\t\t\tstate = FLOAT;\n\t\t\t\t\tnumber = current;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrowSyntaxError( current, i, result );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add the last number found (if any)\n\t\t\tnewNumber();\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\t// Units\n\n\t\tconst units = [ 'mm', 'cm', 'in', 'pt', 'pc', 'px' ];\n\n\t\t// Conversion: [ fromUnit ][ toUnit ] (-1 means dpi dependent)\n\t\tconst unitConversion = {\n\n\t\t\t'mm': {\n\t\t\t\t'mm': 1,\n\t\t\t\t'cm': 0.1,\n\t\t\t\t'in': 1 / 25.4,\n\t\t\t\t'pt': 72 / 25.4,\n\t\t\t\t'pc': 6 / 25.4,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'cm': {\n\t\t\t\t'mm': 10,\n\t\t\t\t'cm': 1,\n\t\t\t\t'in': 1 / 2.54,\n\t\t\t\t'pt': 72 / 2.54,\n\t\t\t\t'pc': 6 / 2.54,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'in': {\n\t\t\t\t'mm': 25.4,\n\t\t\t\t'cm': 2.54,\n\t\t\t\t'in': 1,\n\t\t\t\t'pt': 72,\n\t\t\t\t'pc': 6,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'pt': {\n\t\t\t\t'mm': 25.4 / 72,\n\t\t\t\t'cm': 2.54 / 72,\n\t\t\t\t'in': 1 / 72,\n\t\t\t\t'pt': 1,\n\t\t\t\t'pc': 6 / 72,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'pc': {\n\t\t\t\t'mm': 25.4 / 6,\n\t\t\t\t'cm': 2.54 / 6,\n\t\t\t\t'in': 1 / 6,\n\t\t\t\t'pt': 72 / 6,\n\t\t\t\t'pc': 1,\n\t\t\t\t'px': - 1\n\t\t\t},\n\t\t\t'px': {\n\t\t\t\t'px': 1\n\t\t\t}\n\n\t\t};\n\n\t\tfunction parseFloatWithUnits( string ) {\n\n\t\t\tlet theUnit = 'px';\n\n\t\t\tif ( typeof string === 'string' || string instanceof String ) {\n\n\t\t\t\tfor ( let i = 0, n = units.length; i < n; i ++ ) {\n\n\t\t\t\t\tconst u = units[ i ];\n\n\t\t\t\t\tif ( string.endsWith( u ) ) {\n\n\t\t\t\t\t\ttheUnit = u;\n\t\t\t\t\t\tstring = string.substring( 0, string.length - u.length );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet scale = undefined;\n\n\t\t\tif ( theUnit === 'px' && scope.defaultUnit !== 'px' ) {\n\n\t\t\t\t// Conversion scale from  pixels to inches, then to default units\n\n\t\t\t\tscale = unitConversion[ 'in' ][ scope.defaultUnit ] / scope.defaultDPI;\n\n\t\t\t} else {\n\n\t\t\t\tscale = unitConversion[ theUnit ][ scope.defaultUnit ];\n\n\t\t\t\tif ( scale < 0 ) {\n\n\t\t\t\t\t// Conversion scale to pixels\n\n\t\t\t\t\tscale = unitConversion[ theUnit ][ 'in' ] * scope.defaultDPI;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn scale * parseFloat( string );\n\n\t\t}\n\n\t\t// Transforms\n\n\t\tfunction getNodeTransform( node ) {\n\n\t\t\tif ( ! ( node.hasAttribute( 'transform' ) || ( node.nodeName === 'use' && ( node.hasAttribute( 'x' ) || node.hasAttribute( 'y' ) ) ) ) ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tconst transform = parseNodeTransform( node );\n\n\t\t\tif ( transformStack.length > 0 ) {\n\n\t\t\t\ttransform.premultiply( transformStack[ transformStack.length - 1 ] );\n\n\t\t\t}\n\n\t\t\tcurrentTransform.copy( transform );\n\t\t\ttransformStack.push( transform );\n\n\t\t\treturn transform;\n\n\t\t}\n\n\t\tfunction parseNodeTransform( node ) {\n\n\t\t\tconst transform = new Matrix3();\n\t\t\tconst currentTransform = tempTransform0;\n\n\t\t\tif ( node.nodeName === 'use' && ( node.hasAttribute( 'x' ) || node.hasAttribute( 'y' ) ) ) {\n\n\t\t\t\tconst tx = parseFloatWithUnits( node.getAttribute( 'x' ) );\n\t\t\t\tconst ty = parseFloatWithUnits( node.getAttribute( 'y' ) );\n\n\t\t\t\ttransform.translate( tx, ty );\n\n\t\t\t}\n\n\t\t\tif ( node.hasAttribute( 'transform' ) ) {\n\n\t\t\t\tconst transformsTexts = node.getAttribute( 'transform' ).split( ')' );\n\n\t\t\t\tfor ( let tIndex = transformsTexts.length - 1; tIndex >= 0; tIndex -- ) {\n\n\t\t\t\t\tconst transformText = transformsTexts[ tIndex ].trim();\n\n\t\t\t\t\tif ( transformText === '' ) continue;\n\n\t\t\t\t\tconst openParPos = transformText.indexOf( '(' );\n\t\t\t\t\tconst closeParPos = transformText.length;\n\n\t\t\t\t\tif ( openParPos > 0 && openParPos < closeParPos ) {\n\n\t\t\t\t\t\tconst transformType = transformText.slice( 0, openParPos );\n\n\t\t\t\t\t\tconst array = parseFloats( transformText.slice( openParPos + 1 ) );\n\n\t\t\t\t\t\tcurrentTransform.identity();\n\n\t\t\t\t\t\tswitch ( transformType ) {\n\n\t\t\t\t\t\t\tcase 'translate':\n\n\t\t\t\t\t\t\t\tif ( array.length >= 1 ) {\n\n\t\t\t\t\t\t\t\t\tconst tx = array[ 0 ];\n\t\t\t\t\t\t\t\t\tlet ty = 0;\n\n\t\t\t\t\t\t\t\t\tif ( array.length >= 2 ) {\n\n\t\t\t\t\t\t\t\t\t\tty = array[ 1 ];\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.translate( tx, ty );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'rotate':\n\n\t\t\t\t\t\t\t\tif ( array.length >= 1 ) {\n\n\t\t\t\t\t\t\t\t\tlet angle = 0;\n\t\t\t\t\t\t\t\t\tlet cx = 0;\n\t\t\t\t\t\t\t\t\tlet cy = 0;\n\n\t\t\t\t\t\t\t\t\t// Angle\n\t\t\t\t\t\t\t\t\tangle = array[ 0 ] * Math.PI / 180;\n\n\t\t\t\t\t\t\t\t\tif ( array.length >= 3 ) {\n\n\t\t\t\t\t\t\t\t\t\t// Center x, y\n\t\t\t\t\t\t\t\t\t\tcx = array[ 1 ];\n\t\t\t\t\t\t\t\t\t\tcy = array[ 2 ];\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Rotate around center (cx, cy)\n\t\t\t\t\t\t\t\t\ttempTransform1.makeTranslation( - cx, - cy );\n\t\t\t\t\t\t\t\t\ttempTransform2.makeRotation( angle );\n\t\t\t\t\t\t\t\t\ttempTransform3.multiplyMatrices( tempTransform2, tempTransform1 );\n\t\t\t\t\t\t\t\t\ttempTransform1.makeTranslation( cx, cy );\n\t\t\t\t\t\t\t\t\tcurrentTransform.multiplyMatrices( tempTransform1, tempTransform3 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'scale':\n\n\t\t\t\t\t\t\t\tif ( array.length >= 1 ) {\n\n\t\t\t\t\t\t\t\t\tconst scaleX = array[ 0 ];\n\t\t\t\t\t\t\t\t\tlet scaleY = scaleX;\n\n\t\t\t\t\t\t\t\t\tif ( array.length >= 2 ) {\n\n\t\t\t\t\t\t\t\t\t\tscaleY = array[ 1 ];\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.scale( scaleX, scaleY );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'skewX':\n\n\t\t\t\t\t\t\t\tif ( array.length === 1 ) {\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.set(\n\t\t\t\t\t\t\t\t\t\t1, Math.tan( array[ 0 ] * Math.PI / 180 ), 0,\n\t\t\t\t\t\t\t\t\t\t0, 1, 0,\n\t\t\t\t\t\t\t\t\t\t0, 0, 1\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'skewY':\n\n\t\t\t\t\t\t\t\tif ( array.length === 1 ) {\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.set(\n\t\t\t\t\t\t\t\t\t\t1, 0, 0,\n\t\t\t\t\t\t\t\t\t\tMath.tan( array[ 0 ] * Math.PI / 180 ), 1, 0,\n\t\t\t\t\t\t\t\t\t\t0, 0, 1\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'matrix':\n\n\t\t\t\t\t\t\t\tif ( array.length === 6 ) {\n\n\t\t\t\t\t\t\t\t\tcurrentTransform.set(\n\t\t\t\t\t\t\t\t\t\tarray[ 0 ], array[ 2 ], array[ 4 ],\n\t\t\t\t\t\t\t\t\t\tarray[ 1 ], array[ 3 ], array[ 5 ],\n\t\t\t\t\t\t\t\t\t\t0, 0, 1\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttransform.premultiply( currentTransform );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn transform;\n\n\t\t}\n\n\t\tfunction transformPath( path, m ) {\n\n\t\t\tfunction transfVec2( v2 ) {\n\n\t\t\t\ttempV3.set( v2.x, v2.y, 1 ).applyMatrix3( m );\n\n\t\t\t\tv2.set( tempV3.x, tempV3.y );\n\n\t\t\t}\n\n\t\t\tfunction transfEllipseGeneric( curve ) {\n\n\t\t\t\t// For math description see:\n\t\t\t\t// https://math.stackexchange.com/questions/4544164\n\n\t\t\t\tconst a = curve.xRadius;\n\t\t\t\tconst b = curve.yRadius;\n\n\t\t\t\tconst cosTheta = Math.cos( curve.aRotation );\n\t\t\t\tconst sinTheta = Math.sin( curve.aRotation );\n\n\t\t\t\tconst v1 = new Vector3( a * cosTheta, a * sinTheta, 0 );\n\t\t\t\tconst v2 = new Vector3( - b * sinTheta, b * cosTheta, 0 );\n\n\t\t\t\tconst f1 = v1.applyMatrix3( m );\n\t\t\t\tconst f2 = v2.applyMatrix3( m );\n\n\t\t\t\tconst mF = tempTransform0.set(\n\t\t\t\t\tf1.x, f2.x, 0,\n\t\t\t\t\tf1.y, f2.y, 0,\n\t\t\t\t\t0, 0, 1,\n\t\t\t\t);\n\n\t\t\t\tconst mFInv = tempTransform1.copy( mF ).invert();\n\t\t\t\tconst mFInvT = tempTransform2.copy( mFInv ).transpose();\n\t\t\t\tconst mQ = mFInvT.multiply( mFInv );\n\t\t\t\tconst mQe = mQ.elements;\n\n\t\t\t\tconst ed = eigenDecomposition( mQe[ 0 ], mQe[ 1 ], mQe[ 4 ] );\n\t\t\t\tconst rt1sqrt = Math.sqrt( ed.rt1 );\n\t\t\t\tconst rt2sqrt = Math.sqrt( ed.rt2 );\n\n\t\t\t\tcurve.xRadius = 1 / rt1sqrt;\n\t\t\t\tcurve.yRadius = 1 / rt2sqrt;\n\t\t\t\tcurve.aRotation = Math.atan2( ed.sn, ed.cs );\n\n\t\t\t\tconst isFullEllipse =\n\t\t\t\t\t( curve.aEndAngle - curve.aStartAngle ) % ( 2 * Math.PI ) < Number.EPSILON;\n\n\t\t\t\t// Do not touch angles of a full ellipse because after transformation they\n\t\t\t\t// would converge to a sinle value effectively removing the whole curve\n\n\t\t\t\tif ( ! isFullEllipse ) {\n\n\t\t\t\t\tconst mDsqrt = tempTransform1.set(\n\t\t\t\t\t\trt1sqrt, 0, 0,\n\t\t\t\t\t\t0, rt2sqrt, 0,\n\t\t\t\t\t\t0, 0, 1,\n\t\t\t\t\t);\n\n\t\t\t\t\tconst mRT = tempTransform2.set(\n\t\t\t\t\t\ted.cs, ed.sn, 0,\n\t\t\t\t\t\t- ed.sn, ed.cs, 0,\n\t\t\t\t\t\t0, 0, 1,\n\t\t\t\t\t);\n\n\t\t\t\t\tconst mDRF = mDsqrt.multiply( mRT ).multiply( mF );\n\n\t\t\t\t\tconst transformAngle = phi => {\n\n\t\t\t\t\t\tconst { x: cosR, y: sinR } =\n\t\t\t\t\t\t\tnew Vector3( Math.cos( phi ), Math.sin( phi ), 0 ).applyMatrix3( mDRF );\n\n\t\t\t\t\t\treturn Math.atan2( sinR, cosR );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tcurve.aStartAngle = transformAngle( curve.aStartAngle );\n\t\t\t\t\tcurve.aEndAngle = transformAngle( curve.aEndAngle );\n\n\t\t\t\t\tif ( isTransformFlipped( m ) ) {\n\n\t\t\t\t\t\tcurve.aClockwise = ! curve.aClockwise;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction transfEllipseNoSkew( curve ) {\n\n\t\t\t\t// Faster shortcut if no skew is applied\n\t\t\t\t// (e.g, a euclidean transform of a group containing the ellipse)\n\n\t\t\t\tconst sx = getTransformScaleX( m );\n\t\t\t\tconst sy = getTransformScaleY( m );\n\n\t\t\t\tcurve.xRadius *= sx;\n\t\t\t\tcurve.yRadius *= sy;\n\n\t\t\t\t// Extract rotation angle from the matrix of form:\n\t\t\t\t//\n\t\t\t\t//  | cosθ sx   -sinθ sy |\n\t\t\t\t//  | sinθ sx    cosθ sy |\n\t\t\t\t//\n\t\t\t\t// Remembering that tanθ = sinθ / cosθ; and that\n\t\t\t\t// `sx`, `sy`, or both might be zero.\n\t\t\t\tconst theta =\n\t\t\t\t\tsx > Number.EPSILON\n\t\t\t\t\t\t? Math.atan2( m.elements[ 1 ], m.elements[ 0 ] )\n\t\t\t\t\t\t: Math.atan2( - m.elements[ 3 ], m.elements[ 4 ] );\n\n\t\t\t\tcurve.aRotation += theta;\n\n\t\t\t\tif ( isTransformFlipped( m ) ) {\n\n\t\t\t\t\tcurve.aStartAngle *= - 1;\n\t\t\t\t\tcurve.aEndAngle *= - 1;\n\t\t\t\t\tcurve.aClockwise = ! curve.aClockwise;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst subPaths = path.subPaths;\n\n\t\t\tfor ( let i = 0, n = subPaths.length; i < n; i ++ ) {\n\n\t\t\t\tconst subPath = subPaths[ i ];\n\t\t\t\tconst curves = subPath.curves;\n\n\t\t\t\tfor ( let j = 0; j < curves.length; j ++ ) {\n\n\t\t\t\t\tconst curve = curves[ j ];\n\n\t\t\t\t\tif ( curve.isLineCurve ) {\n\n\t\t\t\t\t\ttransfVec2( curve.v1 );\n\t\t\t\t\t\ttransfVec2( curve.v2 );\n\n\t\t\t\t\t} else if ( curve.isCubicBezierCurve ) {\n\n\t\t\t\t\t\ttransfVec2( curve.v0 );\n\t\t\t\t\t\ttransfVec2( curve.v1 );\n\t\t\t\t\t\ttransfVec2( curve.v2 );\n\t\t\t\t\t\ttransfVec2( curve.v3 );\n\n\t\t\t\t\t} else if ( curve.isQuadraticBezierCurve ) {\n\n\t\t\t\t\t\ttransfVec2( curve.v0 );\n\t\t\t\t\t\ttransfVec2( curve.v1 );\n\t\t\t\t\t\ttransfVec2( curve.v2 );\n\n\t\t\t\t\t} else if ( curve.isEllipseCurve ) {\n\n\t\t\t\t\t\t// Transform ellipse center point\n\n\t\t\t\t\t\ttempV2.set( curve.aX, curve.aY );\n\t\t\t\t\t\ttransfVec2( tempV2 );\n\t\t\t\t\t\tcurve.aX = tempV2.x;\n\t\t\t\t\t\tcurve.aY = tempV2.y;\n\n\t\t\t\t\t\t// Transform ellipse shape parameters\n\n\t\t\t\t\t\tif ( isTransformSkewed( m ) ) {\n\n\t\t\t\t\t\t\ttransfEllipseGeneric( curve );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttransfEllipseNoSkew( curve );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isTransformFlipped( m ) {\n\n\t\t\tconst te = m.elements;\n\t\t\treturn te[ 0 ] * te[ 4 ] - te[ 1 ] * te[ 3 ] < 0;\n\n\t\t}\n\n\t\tfunction isTransformSkewed( m ) {\n\n\t\t\tconst te = m.elements;\n\t\t\tconst basisDot = te[ 0 ] * te[ 3 ] + te[ 1 ] * te[ 4 ];\n\n\t\t\t// Shortcut for trivial rotations and transformations\n\t\t\tif ( basisDot === 0 ) return false;\n\n\t\t\tconst sx = getTransformScaleX( m );\n\t\t\tconst sy = getTransformScaleY( m );\n\n\t\t\treturn Math.abs( basisDot / ( sx * sy ) ) > Number.EPSILON;\n\n\t\t}\n\n\t\tfunction getTransformScaleX( m ) {\n\n\t\t\tconst te = m.elements;\n\t\t\treturn Math.sqrt( te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] );\n\n\t\t}\n\n\t\tfunction getTransformScaleY( m ) {\n\n\t\t\tconst te = m.elements;\n\t\t\treturn Math.sqrt( te[ 3 ] * te[ 3 ] + te[ 4 ] * te[ 4 ] );\n\n\t\t}\n\n\t\t// Calculates the eigensystem of a real symmetric 2x2 matrix\n\t\t//    [ A  B ]\n\t\t//    [ B  C ]\n\t\t// in the form\n\t\t//    [ A  B ]  =  [ cs  -sn ] [ rt1   0  ] [  cs  sn ]\n\t\t//    [ B  C ]     [ sn   cs ] [  0   rt2 ] [ -sn  cs ]\n\t\t// where rt1 >= rt2.\n\t\t//\n\t\t// Adapted from: https://www.mpi-hd.mpg.de/personalhomes/globes/3x3/index.html\n\t\t// -> Algorithms for real symmetric matrices -> Analytical (2x2 symmetric)\n\t\tfunction eigenDecomposition( A, B, C ) {\n\n\t\t\tlet rt1, rt2, cs, sn, t;\n\t\t\tconst sm = A + C;\n\t\t\tconst df = A - C;\n\t\t\tconst rt = Math.sqrt( df * df + 4 * B * B );\n\n\t\t\tif ( sm > 0 ) {\n\n\t\t\t\trt1 = 0.5 * ( sm + rt );\n\t\t\t\tt = 1 / rt1;\n\t\t\t\trt2 = A * t * C - B * t * B;\n\n\t\t\t} else if ( sm < 0 ) {\n\n\t\t\t\trt2 = 0.5 * ( sm - rt );\n\n\t\t\t} else {\n\n\t\t\t\t// This case needs to be treated separately to avoid div by 0\n\n\t\t\t\trt1 = 0.5 * rt;\n\t\t\t\trt2 = - 0.5 * rt;\n\n\t\t\t}\n\n\t\t\t// Calculate eigenvectors\n\n\t\t\tif ( df > 0 ) {\n\n\t\t\t\tcs = df + rt;\n\n\t\t\t} else {\n\n\t\t\t\tcs = df - rt;\n\n\t\t\t}\n\n\t\t\tif ( Math.abs( cs ) > 2 * Math.abs( B ) ) {\n\n\t\t\t\tt = - 2 * B / cs;\n\t\t\t\tsn = 1 / Math.sqrt( 1 + t * t );\n\t\t\t\tcs = t * sn;\n\n\t\t\t} else if ( Math.abs( B ) === 0 ) {\n\n\t\t\t\tcs = 1;\n\t\t\t\tsn = 0;\n\n\t\t\t} else {\n\n\t\t\t\tt = - 0.5 * cs / B;\n\t\t\t\tcs = 1 / Math.sqrt( 1 + t * t );\n\t\t\t\tsn = t * cs;\n\n\t\t\t}\n\n\t\t\tif ( df > 0 ) {\n\n\t\t\t\tt = cs;\n\t\t\t\tcs = - sn;\n\t\t\t\tsn = t;\n\n\t\t\t}\n\n\t\t\treturn { rt1, rt2, cs, sn };\n\n\t\t}\n\n\t\t//\n\n\t\tconst paths = [];\n\t\tconst stylesheets = {};\n\n\t\tconst transformStack = [];\n\n\t\tconst tempTransform0 = new Matrix3();\n\t\tconst tempTransform1 = new Matrix3();\n\t\tconst tempTransform2 = new Matrix3();\n\t\tconst tempTransform3 = new Matrix3();\n\t\tconst tempV2 = new Vector2();\n\t\tconst tempV3 = new Vector3();\n\n\t\tconst currentTransform = new Matrix3();\n\n\t\tconst xml = new DOMParser().parseFromString( text, 'image/svg+xml' ); // application/xml\n\n\t\tparseNode( xml.documentElement, {\n\t\t\tfill: '#000',\n\t\t\tfillOpacity: 1,\n\t\t\tstrokeOpacity: 1,\n\t\t\tstrokeWidth: 1,\n\t\t\tstrokeLineJoin: 'miter',\n\t\t\tstrokeLineCap: 'butt',\n\t\t\tstrokeMiterLimit: 4\n\t\t} );\n\n\t\tconst data = { paths: paths, xml: xml.documentElement };\n\n\t\t// console.log( paths );\n\t\treturn data;\n\n\t}\n\n\tstatic createShapes( shapePath ) {\n\n\t\t// Param shapePath: a shapepath as returned by the parse function of this class\n\t\t// Returns Shape object\n\n\t\tconst BIGNUMBER = 999999999;\n\n\t\tconst IntersectionLocationType = {\n\t\t\tORIGIN: 0,\n\t\t\tDESTINATION: 1,\n\t\t\tBETWEEN: 2,\n\t\t\tLEFT: 3,\n\t\t\tRIGHT: 4,\n\t\t\tBEHIND: 5,\n\t\t\tBEYOND: 6\n\t\t};\n\n\t\tconst classifyResult = {\n\t\t\tloc: IntersectionLocationType.ORIGIN,\n\t\t\tt: 0\n\t\t};\n\n\t\tfunction findEdgeIntersection( a0, a1, b0, b1 ) {\n\n\t\t\tconst x1 = a0.x;\n\t\t\tconst x2 = a1.x;\n\t\t\tconst x3 = b0.x;\n\t\t\tconst x4 = b1.x;\n\t\t\tconst y1 = a0.y;\n\t\t\tconst y2 = a1.y;\n\t\t\tconst y3 = b0.y;\n\t\t\tconst y4 = b1.y;\n\t\t\tconst nom1 = ( x4 - x3 ) * ( y1 - y3 ) - ( y4 - y3 ) * ( x1 - x3 );\n\t\t\tconst nom2 = ( x2 - x1 ) * ( y1 - y3 ) - ( y2 - y1 ) * ( x1 - x3 );\n\t\t\tconst denom = ( y4 - y3 ) * ( x2 - x1 ) - ( x4 - x3 ) * ( y2 - y1 );\n\t\t\tconst t1 = nom1 / denom;\n\t\t\tconst t2 = nom2 / denom;\n\n\t\t\tif ( ( ( denom === 0 ) && ( nom1 !== 0 ) ) || ( t1 <= 0 ) || ( t1 >= 1 ) || ( t2 < 0 ) || ( t2 > 1 ) ) {\n\n\t\t\t\t//1. lines are parallel or edges don't intersect\n\n\t\t\t\treturn null;\n\n\t\t\t} else if ( ( nom1 === 0 ) && ( denom === 0 ) ) {\n\n\t\t\t\t//2. lines are colinear\n\n\t\t\t\t//check if endpoints of edge2 (b0-b1) lies on edge1 (a0-a1)\n\t\t\t\tfor ( let i = 0; i < 2; i ++ ) {\n\n\t\t\t\t\tclassifyPoint( i === 0 ? b0 : b1, a0, a1 );\n\t\t\t\t\t//find position of this endpoints relatively to edge1\n\t\t\t\t\tif ( classifyResult.loc == IntersectionLocationType.ORIGIN ) {\n\n\t\t\t\t\t\tconst point = ( i === 0 ? b0 : b1 );\n\t\t\t\t\t\treturn { x: point.x, y: point.y, t: classifyResult.t };\n\n\t\t\t\t\t} else if ( classifyResult.loc == IntersectionLocationType.BETWEEN ) {\n\n\t\t\t\t\t\tconst x = + ( ( x1 + classifyResult.t * ( x2 - x1 ) ).toPrecision( 10 ) );\n\t\t\t\t\t\tconst y = + ( ( y1 + classifyResult.t * ( y2 - y1 ) ).toPrecision( 10 ) );\n\t\t\t\t\t\treturn { x: x, y: y, t: classifyResult.t, };\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t} else {\n\n\t\t\t\t//3. edges intersect\n\n\t\t\t\tfor ( let i = 0; i < 2; i ++ ) {\n\n\t\t\t\t\tclassifyPoint( i === 0 ? b0 : b1, a0, a1 );\n\n\t\t\t\t\tif ( classifyResult.loc == IntersectionLocationType.ORIGIN ) {\n\n\t\t\t\t\t\tconst point = ( i === 0 ? b0 : b1 );\n\t\t\t\t\t\treturn { x: point.x, y: point.y, t: classifyResult.t };\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconst x = + ( ( x1 + t1 * ( x2 - x1 ) ).toPrecision( 10 ) );\n\t\t\t\tconst y = + ( ( y1 + t1 * ( y2 - y1 ) ).toPrecision( 10 ) );\n\t\t\t\treturn { x: x, y: y, t: t1 };\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction classifyPoint( p, edgeStart, edgeEnd ) {\n\n\t\t\tconst ax = edgeEnd.x - edgeStart.x;\n\t\t\tconst ay = edgeEnd.y - edgeStart.y;\n\t\t\tconst bx = p.x - edgeStart.x;\n\t\t\tconst by = p.y - edgeStart.y;\n\t\t\tconst sa = ax * by - bx * ay;\n\n\t\t\tif ( ( p.x === edgeStart.x ) && ( p.y === edgeStart.y ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.ORIGIN;\n\t\t\t\tclassifyResult.t = 0;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( ( p.x === edgeEnd.x ) && ( p.y === edgeEnd.y ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.DESTINATION;\n\t\t\t\tclassifyResult.t = 1;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( sa < - Number.EPSILON ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.LEFT;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( sa > Number.EPSILON ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.RIGHT;\n\t\t\t\treturn;\n\n\n\t\t\t}\n\n\t\t\tif ( ( ( ax * bx ) < 0 ) || ( ( ay * by ) < 0 ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.BEHIND;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( ( Math.sqrt( ax * ax + ay * ay ) ) < ( Math.sqrt( bx * bx + by * by ) ) ) {\n\n\t\t\t\tclassifyResult.loc = IntersectionLocationType.BEYOND;\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tlet t;\n\n\t\t\tif ( ax !== 0 ) {\n\n\t\t\t\tt = bx / ax;\n\n\t\t\t} else {\n\n\t\t\t\tt = by / ay;\n\n\t\t\t}\n\n\t\t\tclassifyResult.loc = IntersectionLocationType.BETWEEN;\n\t\t\tclassifyResult.t = t;\n\n\t\t}\n\n\t\tfunction getIntersections( path1, path2 ) {\n\n\t\t\tconst intersectionsRaw = [];\n\t\t\tconst intersections = [];\n\n\t\t\tfor ( let index = 1; index < path1.length; index ++ ) {\n\n\t\t\t\tconst path1EdgeStart = path1[ index - 1 ];\n\t\t\t\tconst path1EdgeEnd = path1[ index ];\n\n\t\t\t\tfor ( let index2 = 1; index2 < path2.length; index2 ++ ) {\n\n\t\t\t\t\tconst path2EdgeStart = path2[ index2 - 1 ];\n\t\t\t\t\tconst path2EdgeEnd = path2[ index2 ];\n\n\t\t\t\t\tconst intersection = findEdgeIntersection( path1EdgeStart, path1EdgeEnd, path2EdgeStart, path2EdgeEnd );\n\n\t\t\t\t\tif ( intersection !== null && intersectionsRaw.find( i => i.t <= intersection.t + Number.EPSILON && i.t >= intersection.t - Number.EPSILON ) === undefined ) {\n\n\t\t\t\t\t\tintersectionsRaw.push( intersection );\n\t\t\t\t\t\tintersections.push( new Vector2( intersection.x, intersection.y ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn intersections;\n\n\t\t}\n\n\t\tfunction getScanlineIntersections( scanline, boundingBox, paths ) {\n\n\t\t\tconst center = new Vector2();\n\t\t\tboundingBox.getCenter( center );\n\n\t\t\tconst allIntersections = [];\n\n\t\t\tpaths.forEach( path => {\n\n\t\t\t\t// check if the center of the bounding box is in the bounding box of the paths.\n\t\t\t\t// this is a pruning method to limit the search of intersections in paths that can't envelop of the current path.\n\t\t\t\t// if a path envelops another path. The center of that oter path, has to be inside the bounding box of the enveloping path.\n\t\t\t\tif ( path.boundingBox.containsPoint( center ) ) {\n\n\t\t\t\t\tconst intersections = getIntersections( scanline, path.points );\n\n\t\t\t\t\tintersections.forEach( p => {\n\n\t\t\t\t\t\tallIntersections.push( { identifier: path.identifier, isCW: path.isCW, point: p } );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tallIntersections.sort( ( i1, i2 ) => {\n\n\t\t\t\treturn i1.point.x - i2.point.x;\n\n\t\t\t} );\n\n\t\t\treturn allIntersections;\n\n\t\t}\n\n\t\tfunction isHoleTo( simplePath, allPaths, scanlineMinX, scanlineMaxX, _fillRule ) {\n\n\t\t\tif ( _fillRule === null || _fillRule === undefined || _fillRule === '' ) {\n\n\t\t\t\t_fillRule = 'nonzero';\n\n\t\t\t}\n\n\t\t\tconst centerBoundingBox = new Vector2();\n\t\t\tsimplePath.boundingBox.getCenter( centerBoundingBox );\n\n\t\t\tconst scanline = [ new Vector2( scanlineMinX, centerBoundingBox.y ), new Vector2( scanlineMaxX, centerBoundingBox.y ) ];\n\n\t\t\tconst scanlineIntersections = getScanlineIntersections( scanline, simplePath.boundingBox, allPaths );\n\n\t\t\tscanlineIntersections.sort( ( i1, i2 ) => {\n\n\t\t\t\treturn i1.point.x - i2.point.x;\n\n\t\t\t} );\n\n\t\t\tconst baseIntersections = [];\n\t\t\tconst otherIntersections = [];\n\n\t\t\tscanlineIntersections.forEach( i => {\n\n\t\t\t\tif ( i.identifier === simplePath.identifier ) {\n\n\t\t\t\t\tbaseIntersections.push( i );\n\n\t\t\t\t} else {\n\n\t\t\t\t\totherIntersections.push( i );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tconst firstXOfPath = baseIntersections[ 0 ].point.x;\n\n\t\t\t// build up the path hierarchy\n\t\t\tconst stack = [];\n\t\t\tlet i = 0;\n\n\t\t\twhile ( i < otherIntersections.length && otherIntersections[ i ].point.x < firstXOfPath ) {\n\n\t\t\t\tif ( stack.length > 0 && stack[ stack.length - 1 ] === otherIntersections[ i ].identifier ) {\n\n\t\t\t\t\tstack.pop();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstack.push( otherIntersections[ i ].identifier );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t\tstack.push( simplePath.identifier );\n\n\t\t\tif ( _fillRule === 'evenodd' ) {\n\n\t\t\t\tconst isHole = stack.length % 2 === 0 ? true : false;\n\t\t\t\tconst isHoleFor = stack[ stack.length - 2 ];\n\n\t\t\t\treturn { identifier: simplePath.identifier, isHole: isHole, for: isHoleFor };\n\n\t\t\t} else if ( _fillRule === 'nonzero' ) {\n\n\t\t\t\t// check if path is a hole by counting the amount of paths with alternating rotations it has to cross.\n\t\t\t\tlet isHole = true;\n\t\t\t\tlet isHoleFor = null;\n\t\t\t\tlet lastCWValue = null;\n\n\t\t\t\tfor ( let i = 0; i < stack.length; i ++ ) {\n\n\t\t\t\t\tconst identifier = stack[ i ];\n\t\t\t\t\tif ( isHole ) {\n\n\t\t\t\t\t\tlastCWValue = allPaths[ identifier ].isCW;\n\t\t\t\t\t\tisHole = false;\n\t\t\t\t\t\tisHoleFor = identifier;\n\n\t\t\t\t\t} else if ( lastCWValue !== allPaths[ identifier ].isCW ) {\n\n\t\t\t\t\t\tlastCWValue = allPaths[ identifier ].isCW;\n\t\t\t\t\t\tisHole = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn { identifier: simplePath.identifier, isHole: isHole, for: isHoleFor };\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'fill-rule: \"' + _fillRule + '\" is currently not implemented.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// check for self intersecting paths\n\t\t// TODO\n\n\t\t// check intersecting paths\n\t\t// TODO\n\n\t\t// prepare paths for hole detection\n\t\tlet scanlineMinX = BIGNUMBER;\n\t\tlet scanlineMaxX = - BIGNUMBER;\n\n\t\tlet simplePaths = shapePath.subPaths.map( p => {\n\n\t\t\tconst points = p.getPoints();\n\t\t\tlet maxY = - BIGNUMBER;\n\t\t\tlet minY = BIGNUMBER;\n\t\t\tlet maxX = - BIGNUMBER;\n\t\t\tlet minX = BIGNUMBER;\n\n\t      \t//points.forEach(p => p.y *= -1);\n\n\t\t\tfor ( let i = 0; i < points.length; i ++ ) {\n\n\t\t\t\tconst p = points[ i ];\n\n\t\t\t\tif ( p.y > maxY ) {\n\n\t\t\t\t\tmaxY = p.y;\n\n\t\t\t\t}\n\n\t\t\t\tif ( p.y < minY ) {\n\n\t\t\t\t\tminY = p.y;\n\n\t\t\t\t}\n\n\t\t\t\tif ( p.x > maxX ) {\n\n\t\t\t\t\tmaxX = p.x;\n\n\t\t\t\t}\n\n\t\t\t\tif ( p.x < minX ) {\n\n\t\t\t\t\tminX = p.x;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\t\t\tif ( scanlineMaxX <= maxX ) {\n\n\t\t\t\tscanlineMaxX = maxX + 1;\n\n\t\t\t}\n\n\t\t\tif ( scanlineMinX >= minX ) {\n\n\t\t\t\tscanlineMinX = minX - 1;\n\n\t\t\t}\n\n\t\t\treturn { curves: p.curves, points: points, isCW: ShapeUtils.isClockWise( points ), identifier: - 1, boundingBox: new Box2( new Vector2( minX, minY ), new Vector2( maxX, maxY ) ) };\n\n\t\t} );\n\n\t\tsimplePaths = simplePaths.filter( sp => sp.points.length > 1 );\n\n\t\tfor ( let identifier = 0; identifier < simplePaths.length; identifier ++ ) {\n\n\t\t\tsimplePaths[ identifier ].identifier = identifier;\n\n\t\t}\n\n\t\t// check if path is solid or a hole\n\t\tconst isAHole = simplePaths.map( p => isHoleTo( p, simplePaths, scanlineMinX, scanlineMaxX, ( shapePath.userData ? shapePath.userData.style.fillRule : undefined ) ) );\n\n\n\t\tconst shapesToReturn = [];\n\t\tsimplePaths.forEach( p => {\n\n\t\t\tconst amIAHole = isAHole[ p.identifier ];\n\n\t\t\tif ( ! amIAHole.isHole ) {\n\n\t\t\t\tconst shape = new Shape();\n\t\t\t\tshape.curves = p.curves;\n\t\t\t\tconst holes = isAHole.filter( h => h.isHole && h.for === p.identifier );\n\t\t\t\tholes.forEach( h => {\n\n\t\t\t\t\tconst hole = simplePaths[ h.identifier ];\n\t\t\t\t\tconst path = new Path();\n\t\t\t\t\tpath.curves = hole.curves;\n\t\t\t\t\tshape.holes.push( path );\n\n\t\t\t\t} );\n\t\t\t\tshapesToReturn.push( shape );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn shapesToReturn;\n\n\t}\n\n\tstatic getStrokeStyle( width, color, lineJoin, lineCap, miterLimit ) {\n\n\t\t// Param width: Stroke width\n\t\t// Param color: As returned by THREE.Color.getStyle()\n\t\t// Param lineJoin: One of \"round\", \"bevel\", \"miter\" or \"miter-limit\"\n\t\t// Param lineCap: One of \"round\", \"square\" or \"butt\"\n\t\t// Param miterLimit: Maximum join length, in multiples of the \"width\" parameter (join is truncated if it exceeds that distance)\n\t\t// Returns style object\n\n\t\twidth = width !== undefined ? width : 1;\n\t\tcolor = color !== undefined ? color : '#000';\n\t\tlineJoin = lineJoin !== undefined ? lineJoin : 'miter';\n\t\tlineCap = lineCap !== undefined ? lineCap : 'butt';\n\t\tmiterLimit = miterLimit !== undefined ? miterLimit : 4;\n\n\t\treturn {\n\t\t\tstrokeColor: color,\n\t\t\tstrokeWidth: width,\n\t\t\tstrokeLineJoin: lineJoin,\n\t\t\tstrokeLineCap: lineCap,\n\t\t\tstrokeMiterLimit: miterLimit\n\t\t};\n\n\t}\n\n\tstatic pointsToStroke( points, style, arcDivisions, minDistance ) {\n\n\t\t// Generates a stroke with some width around the given path.\n\t\t// The path can be open or closed (last point equals to first point)\n\t\t// Param points: Array of Vector2D (the path). Minimum 2 points.\n\t\t// Param style: Object with SVG properties as returned by SVGLoader.getStrokeStyle(), or SVGLoader.parse() in the path.userData.style object\n\t\t// Params arcDivisions: Arc divisions for round joins and endcaps. (Optional)\n\t\t// Param minDistance: Points closer to this distance will be merged. (Optional)\n\t\t// Returns BufferGeometry with stroke triangles (In plane z = 0). UV coordinates are generated ('u' along path. 'v' across it, from left to right)\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tif ( SVGLoader.pointsToStrokeWithBuffers( points, style, arcDivisions, minDistance, vertices, normals, uvs ) === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\treturn geometry;\n\n\t}\n\n\tstatic pointsToStrokeWithBuffers( points, style, arcDivisions, minDistance, vertices, normals, uvs, vertexOffset ) {\n\n\t\t// This function can be called to update existing arrays or buffers.\n\t\t// Accepts same parameters as pointsToStroke, plus the buffers and optional offset.\n\t\t// Param vertexOffset: Offset vertices to start writing in the buffers (3 elements/vertex for vertices and normals, and 2 elements/vertex for uvs)\n\t\t// Returns number of written vertices / normals / uvs pairs\n\t\t// if 'vertices' parameter is undefined no triangles will be generated, but the returned vertices count will still be valid (useful to preallocate the buffers)\n\t\t// 'normals' and 'uvs' buffers are optional\n\n\t\tconst tempV2_1 = new Vector2();\n\t\tconst tempV2_2 = new Vector2();\n\t\tconst tempV2_3 = new Vector2();\n\t\tconst tempV2_4 = new Vector2();\n\t\tconst tempV2_5 = new Vector2();\n\t\tconst tempV2_6 = new Vector2();\n\t\tconst tempV2_7 = new Vector2();\n\t\tconst lastPointL = new Vector2();\n\t\tconst lastPointR = new Vector2();\n\t\tconst point0L = new Vector2();\n\t\tconst point0R = new Vector2();\n\t\tconst currentPointL = new Vector2();\n\t\tconst currentPointR = new Vector2();\n\t\tconst nextPointL = new Vector2();\n\t\tconst nextPointR = new Vector2();\n\t\tconst innerPoint = new Vector2();\n\t\tconst outerPoint = new Vector2();\n\n\t\tarcDivisions = arcDivisions !== undefined ? arcDivisions : 12;\n\t\tminDistance = minDistance !== undefined ? minDistance : 0.001;\n\t\tvertexOffset = vertexOffset !== undefined ? vertexOffset : 0;\n\n\t\t// First ensure there are no duplicated points\n\t\tpoints = removeDuplicatedPoints( points );\n\n\t\tconst numPoints = points.length;\n\n\t\tif ( numPoints < 2 ) return 0;\n\n\t\tconst isClosed = points[ 0 ].equals( points[ numPoints - 1 ] );\n\n\t\tlet currentPoint;\n\t\tlet previousPoint = points[ 0 ];\n\t\tlet nextPoint;\n\n\t\tconst strokeWidth2 = style.strokeWidth / 2;\n\n\t\tconst deltaU = 1 / ( numPoints - 1 );\n\t\tlet u0 = 0, u1;\n\n\t\tlet innerSideModified;\n\t\tlet joinIsOnLeftSide;\n\t\tlet isMiter;\n\t\tlet initialJoinIsOnLeftSide = false;\n\n\t\tlet numVertices = 0;\n\t\tlet currentCoordinate = vertexOffset * 3;\n\t\tlet currentCoordinateUV = vertexOffset * 2;\n\n\t\t// Get initial left and right stroke points\n\t\tgetNormal( points[ 0 ], points[ 1 ], tempV2_1 ).multiplyScalar( strokeWidth2 );\n\t\tlastPointL.copy( points[ 0 ] ).sub( tempV2_1 );\n\t\tlastPointR.copy( points[ 0 ] ).add( tempV2_1 );\n\t\tpoint0L.copy( lastPointL );\n\t\tpoint0R.copy( lastPointR );\n\n\t\tfor ( let iPoint = 1; iPoint < numPoints; iPoint ++ ) {\n\n\t\t\tcurrentPoint = points[ iPoint ];\n\n\t\t\t// Get next point\n\t\t\tif ( iPoint === numPoints - 1 ) {\n\n\t\t\t\tif ( isClosed ) {\n\n\t\t\t\t\t// Skip duplicated initial point\n\t\t\t\t\tnextPoint = points[ 1 ];\n\n\t\t\t\t} else nextPoint = undefined;\n\n\t\t\t} else {\n\n\t\t\t\tnextPoint = points[ iPoint + 1 ];\n\n\t\t\t}\n\n\t\t\t// Normal of previous segment in tempV2_1\n\t\t\tconst normal1 = tempV2_1;\n\t\t\tgetNormal( previousPoint, currentPoint, normal1 );\n\n\t\t\ttempV2_3.copy( normal1 ).multiplyScalar( strokeWidth2 );\n\t\t\tcurrentPointL.copy( currentPoint ).sub( tempV2_3 );\n\t\t\tcurrentPointR.copy( currentPoint ).add( tempV2_3 );\n\n\t\t\tu1 = u0 + deltaU;\n\n\t\t\tinnerSideModified = false;\n\n\t\t\tif ( nextPoint !== undefined ) {\n\n\t\t\t\t// Normal of next segment in tempV2_2\n\t\t\t\tgetNormal( currentPoint, nextPoint, tempV2_2 );\n\n\t\t\t\ttempV2_3.copy( tempV2_2 ).multiplyScalar( strokeWidth2 );\n\t\t\t\tnextPointL.copy( currentPoint ).sub( tempV2_3 );\n\t\t\t\tnextPointR.copy( currentPoint ).add( tempV2_3 );\n\n\t\t\t\tjoinIsOnLeftSide = true;\n\t\t\t\ttempV2_3.subVectors( nextPoint, previousPoint );\n\t\t\t\tif ( normal1.dot( tempV2_3 ) < 0 ) {\n\n\t\t\t\t\tjoinIsOnLeftSide = false;\n\n\t\t\t\t}\n\n\t\t\t\tif ( iPoint === 1 ) initialJoinIsOnLeftSide = joinIsOnLeftSide;\n\n\t\t\t\ttempV2_3.subVectors( nextPoint, currentPoint );\n\t\t\t\ttempV2_3.normalize();\n\t\t\t\tconst dot = Math.abs( normal1.dot( tempV2_3 ) );\n\n\t\t\t\t// If path is straight, don't create join\n\t\t\t\tif ( dot > Number.EPSILON ) {\n\n\t\t\t\t\t// Compute inner and outer segment intersections\n\t\t\t\t\tconst miterSide = strokeWidth2 / dot;\n\t\t\t\t\ttempV2_3.multiplyScalar( - miterSide );\n\t\t\t\t\ttempV2_4.subVectors( currentPoint, previousPoint );\n\t\t\t\t\ttempV2_5.copy( tempV2_4 ).setLength( miterSide ).add( tempV2_3 );\n\t\t\t\t\tinnerPoint.copy( tempV2_5 ).negate();\n\t\t\t\t\tconst miterLength2 = tempV2_5.length();\n\t\t\t\t\tconst segmentLengthPrev = tempV2_4.length();\n\t\t\t\t\ttempV2_4.divideScalar( segmentLengthPrev );\n\t\t\t\t\ttempV2_6.subVectors( nextPoint, currentPoint );\n\t\t\t\t\tconst segmentLengthNext = tempV2_6.length();\n\t\t\t\t\ttempV2_6.divideScalar( segmentLengthNext );\n\t\t\t\t\t// Check that previous and next segments doesn't overlap with the innerPoint of intersection\n\t\t\t\t\tif ( tempV2_4.dot( innerPoint ) < segmentLengthPrev && tempV2_6.dot( innerPoint ) < segmentLengthNext ) {\n\n\t\t\t\t\t\tinnerSideModified = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\touterPoint.copy( tempV2_5 ).add( currentPoint );\n\t\t\t\t\tinnerPoint.add( currentPoint );\n\n\t\t\t\t\tisMiter = false;\n\n\t\t\t\t\tif ( innerSideModified ) {\n\n\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\tnextPointR.copy( innerPoint );\n\t\t\t\t\t\t\tcurrentPointR.copy( innerPoint );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tnextPointL.copy( innerPoint );\n\t\t\t\t\t\t\tcurrentPointL.copy( innerPoint );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// The segment triangles are generated here if there was overlapping\n\n\t\t\t\t\t\tmakeSegmentTriangles();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch ( style.strokeLineJoin ) {\n\n\t\t\t\t\t\tcase 'bevel':\n\n\t\t\t\t\t\t\tmakeSegmentWithBevelJoin( joinIsOnLeftSide, innerSideModified, u1 );\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'round':\n\n\t\t\t\t\t\t\t// Segment triangles\n\n\t\t\t\t\t\t\tcreateSegmentTrianglesWithMiddleSection( joinIsOnLeftSide, innerSideModified );\n\n\t\t\t\t\t\t\t// Join triangles\n\n\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\tmakeCircularSector( currentPoint, currentPointL, nextPointL, u1, 0 );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tmakeCircularSector( currentPoint, nextPointR, currentPointR, u1, 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'miter':\n\t\t\t\t\t\tcase 'miter-clip':\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tconst miterFraction = ( strokeWidth2 * style.strokeMiterLimit ) / miterLength2;\n\n\t\t\t\t\t\t\tif ( miterFraction < 1 ) {\n\n\t\t\t\t\t\t\t\t// The join miter length exceeds the miter limit\n\n\t\t\t\t\t\t\t\tif ( style.strokeLineJoin !== 'miter-clip' ) {\n\n\t\t\t\t\t\t\t\t\tmakeSegmentWithBevelJoin( joinIsOnLeftSide, innerSideModified, u1 );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t// Segment triangles\n\n\t\t\t\t\t\t\t\t\tcreateSegmentTrianglesWithMiddleSection( joinIsOnLeftSide, innerSideModified );\n\n\t\t\t\t\t\t\t\t\t// Miter-clip join triangles\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\ttempV2_6.subVectors( outerPoint, currentPointL ).multiplyScalar( miterFraction ).add( currentPointL );\n\t\t\t\t\t\t\t\t\t\ttempV2_7.subVectors( outerPoint, nextPointL ).multiplyScalar( miterFraction ).add( nextPointL );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointL, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\ttempV2_6.subVectors( outerPoint, currentPointR ).multiplyScalar( miterFraction ).add( currentPointR );\n\t\t\t\t\t\t\t\t\t\ttempV2_7.subVectors( outerPoint, nextPointR ).multiplyScalar( miterFraction ).add( nextPointR );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_6, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( tempV2_7, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointR, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// Miter join segment triangles\n\n\t\t\t\t\t\t\t\tif ( innerSideModified ) {\n\n\t\t\t\t\t\t\t\t\t// Optimized segment + join triangles\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\tnextPointL.copy( outerPoint );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tnextPointR.copy( outerPoint );\n\n\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t// Add extra miter join triangles\n\n\t\t\t\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 0 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointL, u1, 0 );\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\t\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\t\t\t\t\t\taddVertex( outerPoint, u1, 1 );\n\t\t\t\t\t\t\t\t\t\taddVertex( nextPointR, u1, 1 );\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tisMiter = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// The segment triangles are generated here when two consecutive points are collinear\n\n\t\t\t\t\tmakeSegmentTriangles();\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// The segment triangles are generated here if it is the ending segment\n\n\t\t\t\tmakeSegmentTriangles();\n\n\t\t\t}\n\n\t\t\tif ( ! isClosed && iPoint === numPoints - 1 ) {\n\n\t\t\t\t// Start line endcap\n\t\t\t\taddCapGeometry( points[ 0 ], point0L, point0R, joinIsOnLeftSide, true, u0 );\n\n\t\t\t}\n\n\t\t\t// Increment loop variables\n\n\t\t\tu0 = u1;\n\n\t\t\tpreviousPoint = currentPoint;\n\n\t\t\tlastPointL.copy( nextPointL );\n\t\t\tlastPointR.copy( nextPointR );\n\n\t\t}\n\n\t\tif ( ! isClosed ) {\n\n\t\t\t// Ending line endcap\n\t\t\taddCapGeometry( currentPoint, currentPointL, currentPointR, joinIsOnLeftSide, false, u1 );\n\n\t\t} else if ( innerSideModified && vertices ) {\n\n\t\t\t// Modify path first segment vertices to adjust to the segments inner and outer intersections\n\n\t\t\tlet lastOuter = outerPoint;\n\t\t\tlet lastInner = innerPoint;\n\n\t\t\tif ( initialJoinIsOnLeftSide !== joinIsOnLeftSide ) {\n\n\t\t\t\tlastOuter = innerPoint;\n\t\t\t\tlastInner = outerPoint;\n\n\t\t\t}\n\n\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\tif ( isMiter || initialJoinIsOnLeftSide ) {\n\n\t\t\t\t\tlastInner.toArray( vertices, 0 * 3 );\n\t\t\t\t\tlastInner.toArray( vertices, 3 * 3 );\n\n\t\t\t\t\tif ( isMiter ) {\n\n\t\t\t\t\t\tlastOuter.toArray( vertices, 1 * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( isMiter || ! initialJoinIsOnLeftSide ) {\n\n\t\t\t\t\tlastInner.toArray( vertices, 1 * 3 );\n\t\t\t\t\tlastInner.toArray( vertices, 3 * 3 );\n\n\t\t\t\t\tif ( isMiter ) {\n\n\t\t\t\t\t\tlastOuter.toArray( vertices, 0 * 3 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn numVertices;\n\n\t\t// -- End of algorithm\n\n\t\t// -- Functions\n\n\t\tfunction getNormal( p1, p2, result ) {\n\n\t\t\tresult.subVectors( p2, p1 );\n\t\t\treturn result.set( - result.y, result.x ).normalize();\n\n\t\t}\n\n\t\tfunction addVertex( position, u, v ) {\n\n\t\t\tif ( vertices ) {\n\n\t\t\t\tvertices[ currentCoordinate ] = position.x;\n\t\t\t\tvertices[ currentCoordinate + 1 ] = position.y;\n\t\t\t\tvertices[ currentCoordinate + 2 ] = 0;\n\n\t\t\t\tif ( normals ) {\n\n\t\t\t\t\tnormals[ currentCoordinate ] = 0;\n\t\t\t\t\tnormals[ currentCoordinate + 1 ] = 0;\n\t\t\t\t\tnormals[ currentCoordinate + 2 ] = 1;\n\n\t\t\t\t}\n\n\t\t\t\tcurrentCoordinate += 3;\n\n\t\t\t\tif ( uvs ) {\n\n\t\t\t\t\tuvs[ currentCoordinateUV ] = u;\n\t\t\t\t\tuvs[ currentCoordinateUV + 1 ] = v;\n\n\t\t\t\t\tcurrentCoordinateUV += 2;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnumVertices += 3;\n\n\t\t}\n\n\t\tfunction makeCircularSector( center, p1, p2, u, v ) {\n\n\t\t\t// param p1, p2: Points in the circle arc.\n\t\t\t// p1 and p2 are in clockwise direction.\n\n\t\t\ttempV2_1.copy( p1 ).sub( center ).normalize();\n\t\t\ttempV2_2.copy( p2 ).sub( center ).normalize();\n\n\t\t\tlet angle = Math.PI;\n\t\t\tconst dot = tempV2_1.dot( tempV2_2 );\n\t\t\tif ( Math.abs( dot ) < 1 ) angle = Math.abs( Math.acos( dot ) );\n\n\t\t\tangle /= arcDivisions;\n\n\t\t\ttempV2_3.copy( p1 );\n\n\t\t\tfor ( let i = 0, il = arcDivisions - 1; i < il; i ++ ) {\n\n\t\t\t\ttempV2_4.copy( tempV2_3 ).rotateAround( center, angle );\n\n\t\t\t\taddVertex( tempV2_3, u, v );\n\t\t\t\taddVertex( tempV2_4, u, v );\n\t\t\t\taddVertex( center, u, 0.5 );\n\n\t\t\t\ttempV2_3.copy( tempV2_4 );\n\n\t\t\t}\n\n\t\t\taddVertex( tempV2_4, u, v );\n\t\t\taddVertex( p2, u, v );\n\t\t\taddVertex( center, u, 0.5 );\n\n\t\t}\n\n\t\tfunction makeSegmentTriangles() {\n\n\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\taddVertex( currentPointL, u1, 0 );\n\n\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t}\n\n\t\tfunction makeSegmentWithBevelJoin( joinIsOnLeftSide, innerSideModified, u ) {\n\n\t\t\tif ( innerSideModified ) {\n\n\t\t\t\t// Optimized segment + bevel triangles\n\n\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t// Path segments triangles\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\t// Bevel join triangle\n\n\t\t\t\t\taddVertex( currentPointL, u, 0 );\n\t\t\t\t\taddVertex( nextPointL, u, 0 );\n\t\t\t\t\taddVertex( innerPoint, u, 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Path segments triangles\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\t// Bevel join triangle\n\n\t\t\t\t\taddVertex( currentPointR, u, 1 );\n\t\t\t\t\taddVertex( innerPoint, u, 0 );\n\t\t\t\t\taddVertex( nextPointR, u, 1 );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// Bevel join triangle. The segment triangles are done in the main loop\n\n\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\taddVertex( currentPointL, u, 0 );\n\t\t\t\t\taddVertex( nextPointL, u, 0 );\n\t\t\t\t\taddVertex( currentPoint, u, 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\taddVertex( currentPointR, u, 1 );\n\t\t\t\t\taddVertex( nextPointR, u, 0 );\n\t\t\t\t\taddVertex( currentPoint, u, 0.5 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction createSegmentTrianglesWithMiddleSection( joinIsOnLeftSide, innerSideModified ) {\n\n\t\t\tif ( innerSideModified ) {\n\n\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( currentPointL, u1, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\taddVertex( currentPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\taddVertex( nextPointL, u0, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\taddVertex( lastPointR, u0, 1 );\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\taddVertex( lastPointL, u0, 0 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( currentPointR, u1, 1 );\n\n\t\t\t\t\taddVertex( currentPointR, u0, 1 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\n\t\t\t\t\taddVertex( currentPoint, u1, 0.5 );\n\t\t\t\t\taddVertex( innerPoint, u1, 0 );\n\t\t\t\t\taddVertex( nextPointR, u0, 1 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction addCapGeometry( center, p1, p2, joinIsOnLeftSide, start, u ) {\n\n\t\t\t// param center: End point of the path\n\t\t\t// param p1, p2: Left and right cap points\n\n\t\t\tswitch ( style.strokeLineCap ) {\n\n\t\t\t\tcase 'round':\n\n\t\t\t\t\tif ( start ) {\n\n\t\t\t\t\t\tmakeCircularSector( center, p2, p1, u, 0.5 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmakeCircularSector( center, p1, p2, u, 0.5 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'square':\n\n\t\t\t\t\tif ( start ) {\n\n\t\t\t\t\t\ttempV2_1.subVectors( p1, center );\n\t\t\t\t\t\ttempV2_2.set( tempV2_1.y, - tempV2_1.x );\n\n\t\t\t\t\t\ttempV2_3.addVectors( tempV2_1, tempV2_2 ).add( center );\n\t\t\t\t\t\ttempV2_4.subVectors( tempV2_2, tempV2_1 ).add( center );\n\n\t\t\t\t\t\t// Modify already existing vertices\n\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, 1 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, 0 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, 3 * 3 );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, 1 * 3 );\n\t\t\t\t\t\t\t// using tempV2_4 to update 3rd vertex if the uv.y of 3rd vertex is 1\n\t\t\t\t\t\t\tuvs[ 3 * 2 + 1 ] === 1 ? tempV2_4.toArray( vertices, 3 * 3 ) : tempV2_3.toArray( vertices, 3 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, 0 * 3 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttempV2_1.subVectors( p2, center );\n\t\t\t\t\t\ttempV2_2.set( tempV2_1.y, - tempV2_1.x );\n\n\t\t\t\t\t\ttempV2_3.addVectors( tempV2_1, tempV2_2 ).add( center );\n\t\t\t\t\t\ttempV2_4.subVectors( tempV2_2, tempV2_1 ).add( center );\n\n\t\t\t\t\t\tconst vl = vertices.length;\n\n\t\t\t\t\t\t// Modify already existing vertices\n\t\t\t\t\t\tif ( joinIsOnLeftSide ) {\n\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, vl - 1 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 2 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 4 * 3 );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 2 * 3 );\n\t\t\t\t\t\t\ttempV2_3.toArray( vertices, vl - 1 * 3 );\n\t\t\t\t\t\t\ttempV2_4.toArray( vertices, vl - 4 * 3 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'butt':\n\t\t\t\tdefault:\n\n\t\t\t\t\t// Nothing to do here\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction removeDuplicatedPoints( points ) {\n\n\t\t\t// Creates a new array if necessary with duplicated points removed.\n\t\t\t// This does not remove duplicated initial and ending points of a closed path.\n\n\t\t\tlet dupPoints = false;\n\t\t\tfor ( let i = 1, n = points.length - 1; i < n; i ++ ) {\n\n\t\t\t\tif ( points[ i ].distanceTo( points[ i + 1 ] ) < minDistance ) {\n\n\t\t\t\t\tdupPoints = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! dupPoints ) return points;\n\n\t\t\tconst newPoints = [];\n\t\t\tnewPoints.push( points[ 0 ] );\n\n\t\t\tfor ( let i = 1, n = points.length - 1; i < n; i ++ ) {\n\n\t\t\t\tif ( points[ i ].distanceTo( points[ i + 1 ] ) >= minDistance ) {\n\n\t\t\t\t\tnewPoints.push( points[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnewPoints.push( points[ points.length - 1 ] );\n\n\t\t\treturn newPoints;\n\n\t\t}\n\n\t}\n\n\n}\n\nmodule.exports = { SVGLoader };\n","// source: https://github.com/kfarr/aframe-cursor-teleport/blob/2d6a072213ff0152e290e28c4d241ad01b89b4ab/dist/aframe-cursor-teleport-component.min.js\n!function(t,e){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var s=e();for(var i in s)(\"object\"==typeof exports?exports:t)[i]=s[i]}}(this,(function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,\"a\",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p=\"\",s(s.s=0)}([function(t,e){if(\"undefined\"==typeof AFRAME)throw new Error(\"Component attempted to register before AFRAME was available.\");AFRAME.registerComponent(\"cursor-teleport\",{schema:{cameraHead:{type:\"selector\",default:\"\"},cameraRig:{type:\"selector\",default:\"\"},collisionEntities:{type:\"string\",default:\"\"},ignoreEntities:{type:\"string\",default:\"\"},landingMaxAngle:{default:45,min:0,max:360},landingNormal:{type:\"vec3\",default:{x:0,y:1,z:0}},transitionSpeed:{type:\"number\",default:6e-4}},init(){this.mobile=AFRAME.utils.device.isMobile();const t=this.el.sceneEl;this.canvas=t.renderer.domElement,this.data.cameraHead.object3D.traverse(t=>{t instanceof THREE.Camera&&(this.cam=t)}),this.camRig=this.data.cameraRig.object3D,this.rayCaster=new THREE.Raycaster,this.referenceNormal=new THREE.Vector3,this.rayCastObjects=[],this.referenceNormal.copy(this.data.landingNormal);const e=new THREE.RingGeometry(.25,.3,32,1);e.rotateX(-Math.PI/2),e.translate(0,.02,0);const s=new THREE.MeshBasicMaterial({color:7818734}),i=new THREE.Mesh(e,s),o=new THREE.CylinderGeometry(.3,.3,.5,32,1,!0);o.translate(0,.25,0);const n=(new THREE.TextureLoader).load(\"data:image/png;base64,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\"),a=new THREE.MeshBasicMaterial({color:7818734,side:\"double\",map:n,transparent:!0,depthTest:!1}),r=new THREE.Mesh(o,a),h=new THREE.Group;h.add(i),h.add(r),this.teleportIndicator=h,t.object3D.add(this.teleportIndicator),this.transitioning=!1,this.transitionProgress=0,this.transitionCamPosStart=new THREE.Vector3,this.transitionCamPosEnd=new THREE.Vector3,this.updateRaycastObjects=this.updateRaycastObjects.bind(this),this.getMouseState=this.getMouseState.bind(this),this.getTeleportPosition=this.getTeleportPosition.bind(this),this.isValidNormalsAngle=this.isValidNormalsAngle.bind(this),this.transition=this.transition.bind(this),this.mouseMove=this.mouseMove.bind(this),this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.easeInOutQuad=this.easeInOutQuad.bind(this),this.updateRaycastObjects()},remove(){this.cam=null,this.canvas=null,this.rayCastObjects.length=0,this.el.sceneEl.object3D.remove(this.teleportIndicator),this.teleportIndicator.children[0].material.dispose(),this.teleportIndicator.children[0].geometry.dispose(),this.teleportIndicator.children[1].material.dispose(),this.teleportIndicator.children[1].geometry.dispose(),this.teleportIndicator=null,this.collisionMesh&&(this.collisionMesh.geometry.dispose(),this.collisionMesh.material.dispose(),this.collisionMesh=null)},play(){const t=this.canvas;t.addEventListener(\"mousedown\",this.mouseDown,!1),t.addEventListener(\"mousemove\",this.mouseMove,!1),t.addEventListener(\"mouseup\",this.mouseUp,!1),t.addEventListener(\"touchstart\",this.mouseDown,!1),t.addEventListener(\"touchmove\",this.mouseMove,!1),t.addEventListener(\"touchend\",this.mouseUp,!1)},pause(){const t=this.canvas;t.removeEventListener(\"mousedown\",this.mouseDown),t.removeEventListener(\"mousemove\",this.mouseMove),t.removeEventListener(\"mouseup\",this.mouseUp),t.removeEventListener(\"touchstart\",this.mouseDown),t.removeEventListener(\"touchmove\",this.mouseMove),t.removeEventListener(\"touchend\",this.mouseUp)},updateRaycastObjects(){if(this.rayCastObjects.length=0,\"\"!==this.data.collisionEntities){this.el.sceneEl.querySelectorAll(this.data.collisionEntities).forEach(t=>{t.object3D.traverse(t=>{t.isMesh&&(t.userData.collision=!0,this.rayCastObjects.push(t))})})}else{if(!this.collisionMesh){const t=new THREE.PlaneGeometry(500,500,1);t.rotateX(-Math.PI/2);const e=new THREE.MeshNormalMaterial,s=new THREE.Mesh(t,e);s.userData.collision=!0,this.collisionMesh=s}this.rayCastObjects.push(this.collisionMesh)}if(\"\"!==this.data.ignoreEntities){this.el.sceneEl.querySelectorAll(this.data.ignoreEntities).forEach(t=>{t.object3D.traverse(t=>{t.isMesh&&this.rayCastObjects.push(t)})})}},getMouseState:function(){const t=new THREE.Vector2;return function(e){const s=this.canvas.getBoundingClientRect();return null!=e.clientX?(t.x=e.clientX-s.left,t.y=e.clientY-s.top,t):null!=e.touches[0]?(t.x=e.touches[0].clientX-s.left,t.y=e.touches[0].clientY-s.top,t):void 0}}(),getTeleportPosition:function(){const t=new THREE.Vector2;return function(e,s){if(0!==this.rayCastObjects.length){if(this.cam&&this.canvas){const i=this.cam,o=this.canvas.getBoundingClientRect();t.x=e/(o.right-o.left)*2-1,t.y=-s/(o.bottom-o.top)*2+1,this.rayCaster.setFromCamera(t,i);const n=this.rayCaster.intersectObjects(this.rayCastObjects);return!(0===n.length||!this.isValidNormalsAngle(n[0].face.normal))&&(!0===n[0].object.userData.collision&&n[0].point)}return!1}return!1}}(),isValidNormalsAngle(t){const e=this.referenceNormal.angleTo(t);return THREE.MathUtils.RAD2DEG*e<=this.data.landingMaxAngle},transition(t){this.transitionProgress=0,this.transitionCamPosEnd.copy(t),this.transitionCamPosStart.copy(this.camRig.position),this.transitioning=!0},mouseMove(t){const e=this.getMouseState(t);this.mouseX=e.x,this.mouseY=e.y},mouseDown(t){this.updateRaycastObjects();const e=this.getMouseState(t);this.mouseX=e.x,this.mouseY=e.y,this.mouseXOrig=e.x,this.mouseYOrig=e.y},mouseUp(t){if(this.mouseX===this.mouseXOrig&&this.mouseY===this.mouseYOrig){const t=this.getTeleportPosition(this.mouseX,this.mouseY);t&&(this.teleportIndicator.position.copy(t),this.transition(t))}},easeInOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1,tick(t,e){if(!this.transitioning&&!this.mobile){const t=this.getTeleportPosition(this.mouseX,this.mouseY);t&&this.teleportIndicator.position.copy(t)}if(this.transitioning){this.transitionProgress+=e*this.data.transitionSpeed;const t=this.easeInOutQuad(this.transitionProgress),s=t<.5?t:1.5-1*(t+.5);this.teleportIndicator.scale.set(1+s,1,1+s);const i=this.camRig.position;i.x=this.transitionCamPosStart.x+(this.transitionCamPosEnd.x-this.transitionCamPosStart.x)*t,i.y=this.transitionCamPosStart.y+(this.transitionCamPosEnd.y-this.transitionCamPosStart.y)*t,i.z=this.transitionCamPosStart.z+(this.transitionCamPosEnd.z-this.transitionCamPosStart.z)*t,this.transitionProgress>=1&&(this.transitioning=!1,i.copy(this.transitionCamPosEnd))}}})}])}));","// source: https://github.com/c-frame/aframe-extras/blob/67d113029b1769cea4002e59c1d6cafd3567bb7d/src/loaders/animation-mixer.js\nconst LoopMode = {\n  once: THREE.LoopOnce,\n  repeat: THREE.LoopRepeat,\n  pingpong: THREE.LoopPingPong\n};\n\n/**\n * animation-mixer\n *\n * Player for animation clips. Intended to be compatible with any model format that supports\n * skeletal or morph animations through THREE.AnimationMixer.\n * See: https://threejs.org/docs/?q=animation#Reference/Animation/AnimationMixer\n */\nmodule.exports = AFRAME.registerComponent('animation-mixer', {\n  schema: {\n    clip: { default: '*' },\n    duration: { default: 0 },\n    clampWhenFinished: { default: false, type: 'boolean' },\n    crossFadeDuration: { default: 0 },\n    loop: { default: 'repeat', oneOf: Object.keys(LoopMode) },\n    repetitions: { default: Infinity, min: 0 },\n    timeScale: { default: 1 },\n    startAt: { default: 0 }\n  },\n\n  init: function () {\n    /** @type {THREE.Mesh} */\n    this.model = null;\n    /** @type {THREE.AnimationMixer} */\n    this.mixer = null;\n    /** @type {Array<THREE.AnimationAction>} */\n    this.activeActions = [];\n\n    const model = this.el.getObject3D('mesh');\n\n    if (model) {\n      this.load(model);\n    } else {\n      this.el.addEventListener('model-loaded', (e) => {\n        this.load(e.detail.model);\n      });\n    }\n  },\n\n  load: function (model) {\n    const el = this.el;\n    this.model = model;\n    this.mixer = new THREE.AnimationMixer(model);\n    this.mixer.addEventListener('loop', (e) => {\n      el.emit('animation-loop', { action: e.action, loopDelta: e.loopDelta });\n    });\n    this.mixer.addEventListener('finished', (e) => {\n      el.emit('animation-finished', { action: e.action, direction: e.direction });\n    });\n    if (this.data.clip) this.update({});\n  },\n\n  remove: function () {\n    if (this.mixer) this.mixer.stopAllAction();\n  },\n\n  update: function (prevData) {\n    if (!prevData) return;\n\n    const data = this.data;\n    const changes = AFRAME.utils.diff(data, prevData);\n\n    // If selected clips have changed, restart animation.\n    if ('clip' in changes) {\n      this.stopAction();\n      if (data.clip) this.playAction();\n      return;\n    }\n\n    // Otherwise, modify running actions.\n    this.activeActions.forEach((action) => {\n      if ('duration' in changes && data.duration) {\n        action.setDuration(data.duration);\n      }\n      if ('clampWhenFinished' in changes) {\n        action.clampWhenFinished = data.clampWhenFinished;\n      }\n      if ('loop' in changes || 'repetitions' in changes) {\n        action.setLoop(LoopMode[data.loop], data.repetitions);\n      }\n      if ('timeScale' in changes) {\n        action.setEffectiveTimeScale(data.timeScale);\n      }\n    });\n  },\n\n  stopAction: function () {\n    const data = this.data;\n    for (let i = 0; i < this.activeActions.length; i++) {\n      data.crossFadeDuration\n        ? this.activeActions[i].fadeOut(data.crossFadeDuration)\n        : this.activeActions[i].stop();\n    }\n    this.activeActions.length = 0;\n  },\n\n  playAction: function () {\n    if (!this.mixer) return;\n\n    const model = this.model,\n      data = this.data,\n      clips = model.animations || (model.geometry || {}).animations || [];\n\n    if (!clips.length) return;\n\n    const re = wildcardToRegExp(data.clip);\n\n    for (let clip, i = 0; (clip = clips[i]); i++) {\n      if (clip.name.match(re)) {\n        const action = this.mixer.clipAction(clip, model);\n\n        action.enabled = true;\n        action.clampWhenFinished = data.clampWhenFinished;\n        if (data.duration) action.setDuration(data.duration);\n        if (data.timeScale !== 1) action.setEffectiveTimeScale(data.timeScale);\n        // animation-mixer.startAt and AnimationAction.startAt have very different meanings.\n        // animation-mixer.startAt indicates which frame in the animation to start at, in msecs.\n        // AnimationAction.startAt indicates when to start the animation (from the 1st frame),\n        // measured in global mixer time, in seconds.\n        action.startAt(this.mixer.time - data.startAt / 1000);\n        action\n          .setLoop(LoopMode[data.loop], data.repetitions)\n          .fadeIn(data.crossFadeDuration)\n          .play();\n        this.activeActions.push(action);\n      }\n    }\n  },\n\n  tick: function (t, dt) {\n    if (this.mixer && !isNaN(dt)) this.mixer.update(dt / 1000);\n  }\n});\n\n/**\n * Creates a RegExp from the given string, converting asterisks to .* expressions,\n * and escaping all other characters.\n */\nfunction wildcardToRegExp(s) {\n  return new RegExp('^' + s.split(/\\*+/).map(regExpEscape).join('.*') + '$');\n}\n\n/**\n * RegExp-escapes all characters in the given string.\n */\nfunction regExpEscape(s) {\n  return s.replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&');\n}\n","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nvar __assign=function(){return __assign=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},__assign.apply(this,arguments)},NotyfNotification=function(){function t(t){this.options=t,this.listeners={}}return t.prototype.on=function(t,i){var e=this.listeners[t]||[];this.listeners[t]=e.concat([i])},t.prototype.triggerEvent=function(t,i){var e=this;(this.listeners[t]||[]).forEach((function(t){return t({target:e,event:i})}))},t}();!function(t){t[t.Add=0]=\"Add\",t[t.Remove=1]=\"Remove\"}(exports.NotyfArrayEvent||(exports.NotyfArrayEvent={}));var NotyfArray=function(){function t(){this.notifications=[]}return t.prototype.push=function(t){this.notifications.push(t),this.updateFn(t,exports.NotyfArrayEvent.Add,this.notifications)},t.prototype.splice=function(t,i){var e=this.notifications.splice(t,i)[0];return this.updateFn(e,exports.NotyfArrayEvent.Remove,this.notifications),e},t.prototype.indexOf=function(t){return this.notifications.indexOf(t)},t.prototype.onUpdate=function(t){this.updateFn=t},t}();!function(t){t.Dismiss=\"dismiss\",t.Click=\"click\"}(exports.NotyfEvent||(exports.NotyfEvent={}));var DEFAULT_OPTIONS={types:[{type:\"success\",className:\"notyf__toast--success\",backgroundColor:\"#3dc763\",icon:{className:\"notyf__icon--success\",tagName:\"i\"}},{type:\"error\",className:\"notyf__toast--error\",backgroundColor:\"#ed3d3d\",icon:{className:\"notyf__icon--error\",tagName:\"i\"}}],duration:2e3,ripple:!0,position:{x:\"right\",y:\"bottom\"},dismissible:!1},NotyfView=function(){function t(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:\"flex-start\",center:\"center\",right:\"flex-end\"},this.Y_POSITION_FLEX_MAP={top:\"flex-start\",center:\"center\",bottom:\"flex-end\"};var t=document.createDocumentFragment(),i=this._createHTMLElement({tagName:\"div\",className:\"notyf\"});t.appendChild(i),document.body.appendChild(t),this.container=i,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return t.prototype.on=function(t,i){var e;this.events=__assign(__assign({},this.events),((e={})[t]=i,e))},t.prototype.update=function(t,i){i===exports.NotyfArrayEvent.Add?this.addNotification(t):i===exports.NotyfArrayEvent.Remove&&this.removeNotification(t)},t.prototype.removeNotification=function(t){var i,e,n=this,o=this._popRenderedNotification(t);o&&((i=o.node).classList.add(\"notyf__toast--disappear\"),i.addEventListener(this.animationEndEventName,e=function(t){t.target===i&&(i.removeEventListener(n.animationEndEventName,e),n.container.removeChild(i))}))},t.prototype.addNotification=function(t){var i=this._renderNotification(t);this.notifications.push({notification:t,node:i}),this._announce(t.options.message||\"Notification\")},t.prototype._renderNotification=function(t){var i,e=this._buildNotificationCard(t),n=t.options.className;return n&&(i=e.classList).add.apply(i,n.split(\" \")),this.container.appendChild(e),e},t.prototype._popRenderedNotification=function(t){for(var i=-1,e=0;e<this.notifications.length&&i<0;e++)this.notifications[e].notification===t&&(i=e);if(-1!==i)return this.notifications.splice(i,1)[0]},t.prototype.getXPosition=function(t){var i;return(null===(i=null==t?void 0:t.position)||void 0===i?void 0:i.x)||\"right\"},t.prototype.getYPosition=function(t){var i;return(null===(i=null==t?void 0:t.position)||void 0===i?void 0:i.y)||\"bottom\"},t.prototype.adjustContainerAlignment=function(t){var i=this.X_POSITION_FLEX_MAP[this.getXPosition(t)],e=this.Y_POSITION_FLEX_MAP[this.getYPosition(t)],n=this.container.style;n.setProperty(\"justify-content\",e),n.setProperty(\"align-items\",i)},t.prototype._buildNotificationCard=function(t){var i=this,e=t.options,n=e.icon;this.adjustContainerAlignment(e);var o=this._createHTMLElement({tagName:\"div\",className:\"notyf__toast\"}),s=this._createHTMLElement({tagName:\"div\",className:\"notyf__ripple\"}),r=this._createHTMLElement({tagName:\"div\",className:\"notyf__wrapper\"}),a=this._createHTMLElement({tagName:\"div\",className:\"notyf__message\"});a.innerHTML=e.message||\"\";var c=e.background||e.backgroundColor;if(n){var p=this._createHTMLElement({tagName:\"div\",className:\"notyf__icon\"});if((\"string\"==typeof n||n instanceof String)&&(p.innerHTML=new String(n).valueOf()),\"object\"==typeof n){var f=n.tagName,d=void 0===f?\"i\":f,l=n.className,u=n.text,y=n.color,v=void 0===y?c:y,h=this._createHTMLElement({tagName:d,className:l,text:u});v&&(h.style.color=v),p.appendChild(h)}r.appendChild(p)}if(r.appendChild(a),o.appendChild(r),c&&(e.ripple?(s.style.background=c,o.appendChild(s)):o.style.background=c),e.dismissible){var m=this._createHTMLElement({tagName:\"div\",className:\"notyf__dismiss\"}),_=this._createHTMLElement({tagName:\"button\",className:\"notyf__dismiss-btn\"});m.appendChild(_),r.appendChild(m),o.classList.add(\"notyf__toast--dismissible\"),_.addEventListener(\"click\",(function(e){var n,o;null===(o=(n=i.events)[exports.NotyfEvent.Dismiss])||void 0===o||o.call(n,{target:t,event:e}),e.stopPropagation()}))}o.addEventListener(\"click\",(function(e){var n,o;return null===(o=(n=i.events)[exports.NotyfEvent.Click])||void 0===o?void 0:o.call(n,{target:t,event:e})}));var N=\"top\"===this.getYPosition(e)?\"upper\":\"lower\";return o.classList.add(\"notyf__toast--\"+N),o},t.prototype._createHTMLElement=function(t){var i=t.tagName,e=t.className,n=t.text,o=document.createElement(i);return e&&(o.className=e),o.textContent=n||null,o},t.prototype._createA11yContainer=function(){var t=this._createHTMLElement({tagName:\"div\",className:\"notyf-announcer\"});t.setAttribute(\"aria-atomic\",\"true\"),t.setAttribute(\"aria-live\",\"polite\"),t.style.border=\"0\",t.style.clip=\"rect(0 0 0 0)\",t.style.height=\"1px\",t.style.margin=\"-1px\",t.style.overflow=\"hidden\",t.style.padding=\"0\",t.style.position=\"absolute\",t.style.width=\"1px\",t.style.outline=\"0\",document.body.appendChild(t),this.a11yContainer=t},t.prototype._announce=function(t){var i=this;this.a11yContainer.textContent=\"\",setTimeout((function(){i.a11yContainer.textContent=t}),100)},t.prototype._getAnimationEndEventName=function(){var t,i=document.createElement(\"_fake\"),e={MozTransition:\"animationend\",OTransition:\"oAnimationEnd\",WebkitTransition:\"webkitAnimationEnd\",transition:\"animationend\"};for(t in e)if(void 0!==i.style[t])return e[t];return\"animationend\"},t}(),Notyf=function(){function t(t){var i=this;this.dismiss=this._removeNotification,this.notifications=new NotyfArray,this.view=new NotyfView;var e=this.registerTypes(t);this.options=__assign(__assign({},DEFAULT_OPTIONS),t),this.options.types=e,this.notifications.onUpdate((function(t,e){return i.view.update(t,e)})),this.view.on(exports.NotyfEvent.Dismiss,(function(t){var e=t.target,n=t.event;i._removeNotification(e),e.triggerEvent(exports.NotyfEvent.Dismiss,n)})),this.view.on(exports.NotyfEvent.Click,(function(t){var i=t.target,e=t.event;return i.triggerEvent(exports.NotyfEvent.Click,e)}))}return t.prototype.error=function(t){var i=this.normalizeOptions(\"error\",t);return this.open(i)},t.prototype.success=function(t){var i=this.normalizeOptions(\"success\",t);return this.open(i)},t.prototype.open=function(t){var i=this.options.types.find((function(i){return i.type===t.type}))||{},e=__assign(__assign({},i),t);this.assignProps([\"ripple\",\"position\",\"dismissible\"],e);var n=new NotyfNotification(e);return this._pushNotification(n),n},t.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},t.prototype.assignProps=function(t,i){var e=this;t.forEach((function(t){i[t]=null==i[t]?e.options[t]:i[t]}))},t.prototype._pushNotification=function(t){var i=this;this.notifications.push(t);var e=void 0!==t.options.duration?t.options.duration:this.options.duration;e&&setTimeout((function(){return i._removeNotification(t)}),e)},t.prototype._removeNotification=function(t){var i=this.notifications.indexOf(t);-1!==i&&this.notifications.splice(i,1)},t.prototype.normalizeOptions=function(t,i){var e={type:t};return\"string\"==typeof i?e.message=i:\"object\"==typeof i&&(e=__assign(__assign({},e),i)),e},t.prototype.registerTypes=function(t){var i=(t&&t.types||[]).slice();return DEFAULT_OPTIONS.types.map((function(t){var e=-1;i.forEach((function(i,n){i.type===t.type&&(e=n)}));var n=-1!==e?i.splice(e,1)[0]:{};return __assign(__assign({},t),n)})).concat(i)},t}();exports.DEFAULT_OPTIONS=DEFAULT_OPTIONS,exports.Notyf=Notyf,exports.NotyfArray=NotyfArray,exports.NotyfNotification=NotyfNotification,exports.NotyfView=NotyfView;","const segmentVariants = {\n  /* sidewalk segments */\n  sidewalk: ['empty', 'sparse', 'normal', 'dense'],\n  'sidewalk-wayfinding': ['large'],\n  'sidewalk-bench': ['left', 'right', 'center'],\n  'sidewalk-bike-rack': [\n    'left|sidewalk-parallel',\n    'right|sidewalk-parallel',\n    'left|sidewalk',\n    'right|sidewalk'\n  ],\n  'sidewalk-tree': ['big', 'palm-tree'],\n  /* lights and utilities */\n  utilities: ['left', 'right'],\n  'sidewalk-lamp': [\n    'right|modern',\n    'both|modern',\n    'left|modern',\n    'right|traditional',\n    'both|traditional',\n    'left|traditional',\n    'right|pride',\n    'both|pride',\n    'left|pride'\n  ],\n  // furniture segments\n  parklet: ['left', 'right'],\n  'outdoor-dining': ['empty|sidewalk', 'empty|road'],\n  bikeshare: ['left|road', 'right|road', 'left|sidewalk', 'right|sidewalk'],\n  // bike and scooter segments\n  'bike-lane': [\n    'inbound|green|sidewalk',\n    'inbound|green|road',\n    'outbound|green|sidewalk',\n    'outbound|green|road',\n    'inbound|regular|sidewalk',\n    'inbound|regular|road',\n    'outbound|regular|sidewalk',\n    'outbound|regular|road',\n    'inbound|red|sidewalk',\n    'inbound|red|road',\n    'outbound|red|sidewalk',\n    'outbound|red|road'\n  ],\n  scooter: [\n    'inbound|regular',\n    'inbound|green',\n    'inbound|red',\n    'outbound|regular',\n    'outbound|green',\n    'outbound|red'\n  ],\n  // road segments\n  'bus-lane': [\n    'inbound|colored|typical',\n    'outbound|colored|typical',\n    'inbound|regular|typical',\n    'outbound|regular|typical',\n    'inbound|red|typical',\n    'outbound|red|typical'\n  ],\n  'drive-lane': [\n    'inbound|car',\n    'outbound|car',\n    'inbound|truck',\n    'outbound|truck',\n    'outbound|av',\n    'inbound|av',\n    'outbound|pedestrian',\n    'inbound|pedestrian',\n    'inbound|sharrow',\n    'outbound|sharrow'\n  ],\n  'turn-lane': [\n    'inbound|left',\n    'inbound|right',\n    'inbound|left-right-straight',\n    'inbound|shared',\n    'inbound|both',\n    'inbound|left-straight',\n    'inbound|right-straight',\n    'inbound|straight',\n    'outbound|left',\n    'outbound|right',\n    'outbound|left-right-straight',\n    'outbound|shared',\n    'outbound|both',\n    'outbound|left-straight',\n    'outbound|right-straight',\n    'outbound|straight'\n  ],\n  'parking-lane': [\n    'sideways|right',\n    'sideways|left',\n    'inbound|right',\n    'inbound|left',\n    'outbound|left',\n    'outbound|right',\n    'angled-front-left|left',\n    'angled-front-right|left',\n    'angled-rear-left|left',\n    'angled-rear-right|left',\n    'angled-front-left|right',\n    'angled-front-right|right',\n    'angled-rear-left|right',\n    'angled-rear-right|right'\n  ],\n  'food-truck': ['left', 'right'],\n  'flex-zone': [\n    'taxi|inbound|right',\n    'taxi|inbound|left',\n    'taxi|outbound|right',\n    'taxi|outbound|left',\n    'rideshare|outbound|right',\n    'rideshare|outbound|right',\n    'rideshare|inbound|right',\n    'rideshare|inbound|left'\n  ],\n  // rail vehicles\n  streetcar: [\n    'inbound|regular',\n    'inbound|colored',\n    'inbound|grass',\n    'outbound|regular',\n    'outbound|colored',\n    'outbound|grass'\n  ],\n  'light-rail': [\n    'inbound|regular',\n    'inbound|colored',\n    'inbound|grass',\n    'outbound|regular',\n    'outbound|colored',\n    'outbound|grass'\n  ],\n  // stations\n  'brt-station': ['center'],\n  'transit-shelter': [\n    'left|street-level',\n    'right|street-level',\n    'right|light-rail',\n    'left|light-rail'\n  ],\n  // divider and temporary\n  divider: [\n    'buffer',\n    'flowers',\n    'planting-strip',\n    'planter-box',\n    'palm-tree',\n    'big-tree',\n    'bush',\n    'dome',\n    'bollard',\n    'striped-buffer'\n  ],\n  temporary: [\n    'barricade',\n    'traffic-cone',\n    'jersey-barrier-plastic',\n    'jersey-barrier-concrete'\n  ],\n  // magic segment\n  'magic-carpet': ['aladdin']\n};\n\nmodule.exports.segmentVariants = segmentVariants;\n","// conversion map StreetPan -> Streetmix sidewalk segment types mapping\n/*\nStreetPlanType1:\n {\n\tStreetPlanSubtype: <String> StreetmixType,\n\t--- or ---\n\tStreetPlanSubtype: <Object> {\n\t\t\"tag\": StreetPlanTag,\n\t\t\"type\": StreetmixType,\n\t\t\"variantString\": Streetmix VariantString, can be formed based on other Streetplan parameters\n\t\t(Name or Tag) or be constant, like: 'sidewalk',\n\n\t\t\"variantStringAdd\": get parameter values from this list and generate variantString.\n\t\tOften variantString looks like this: 'outbound|regular|road' - example for bike-path.\n\t\tvariantStringAdd will be: 'direction|material|variantString',\n\n\t\t\"nameToVariantMap\": mapping rule StreetPlan O1-Name -> VariantString,\n\t\t\"tagToVariantMap\": mapping rule StreetPlan O1-Tags -> VariantString,\n\t\t\"names\": names (StreetPlan O1-Name) for this Streetmix Segment type\n\t\t},\n\t--- or ---\n\t// for one (O1-Tags) there can be different streetmix segment types,\n\t// which are determined by the name (O1-Name)\n\tStreetPlanSubtype: <Array> [\n\t\tdifferent options of tags (O1-Tags) and streetMix data for each\n\t]\n }\n*/\nconst mapping = {\n  Setback: {\n    '': { type: 'sidewalk', variantString: 'empty' },\n    Trees: { type: 'sidewalk-tree', variantString: 'big' },\n    tree: { type: 'divider', variantString: 'palm-tree' },\n    Benchs: { type: 'sidewalk-bench', variantStringAdd: 'side' }\n  },\n  Walkways: {\n    '': { type: 'sidewalk', variantString: 'empty' },\n    Trees: { type: 'sidewalk-tree', variantString: 'big' },\n    pedestrian: { type: 'sidewalk', variantString: 'dense' },\n    Benchs: { type: 'sidewalk-bench', variantStringAdd: 'side' },\n    Tables: { type: 'outdoor-dining', variantString: 'occupied|sidewalk' }\n  },\n  Furniture: {\n    '': { type: 'sidewalk', variantString: 'empty' },\n    Trees: { type: 'sidewalk-tree', variantString: 'big' },\n    season_tree: { type: 'sidewalk-tree', variantString: 'big' },\n    Shelters: {\n      type: 'transit-shelter',\n      variantString: 'street-level',\n      variantStringAdd: 'side|variantString'\n    },\n    Pedestrian: { type: 'sidewalk', variantString: 'dense' }\n  },\n  Curbside: {\n    '': { type: 'sidewalk', variantString: 'empty' },\n    Lights: {\n      type: 'sidewalk-lamp',\n      tagToVariantMap: {\n        'Historic Lights': 'traditional',\n        'Regular Lights': 'modern'\n      },\n      variantStringAdd: 'side|variantString'\n    },\n    Poles: { type: 'utilities', variantStringAdd: 'side' },\n    BikeRacks: {\n      type: 'sidewalk-bike-rack',\n      nameToVariantMap: {\n        'Sideview Modern': 'sidewalk-parallel',\n        Sideview: 'sidewalk-parallel',\n        'NYC Bike Rack': 'sidewalk'\n      },\n      variantStringAdd: 'side|variantString'\n    }\n  },\n  BikesPaths: {\n    '': { type: 'bike-lane', variantString: 'sidewalk' },\n    Bikes: {\n      type: 'bike-lane',\n      variantString: 'sidewalk',\n      variantStringAdd: 'direction|material|variantString'\n    }\n  },\n  Gutter: {\n    '': { type: 'divider', variantString: 'median' },\n    Gutter: { type: 'divider', variantString: 'median' }\n  },\n  Transit: {\n    '': {\n      tag: 'Bus Vehicles',\n      type: 'bus-lane',\n      variantString: 'typical',\n      variantStringAdd: 'direction|material|variantString'\n    },\n    Transit: [\n      {\n        tag: 'Rail Vehicles',\n        type: 'streetcar',\n        names: [\n          'StreetCar Yellow',\n          'StreetCar Blue',\n          'StreetCar Red 1',\n          'StreetCar Red 2'\n        ],\n        variantStringAdd: 'direction|material'\n      },\n      {\n        tag: 'Rail Vehicles',\n        type: 'light-rail',\n        names: ['UTA LightRail'],\n        variantStringAdd: 'direction|material'\n      },\n      // there are only reversed light rail vehicles in Streetplan\n      {\n        tag: 'Rail Vehicles Reversed',\n        type: 'light-rail',\n        variantStringAdd: 'direction|material'\n      },\n      {\n        tag: 'Bus Vehicles',\n        type: 'bus-lane',\n        variantString: 'typical',\n        variantStringAdd: 'direction|material|variantString'\n      }\n    ]\n  },\n  Cars: {\n    '': {\n      type: 'drive-lane',\n      variantString: 'car',\n      variantStringAdd: 'direction|variantString'\n    },\n    Autos: {\n      type: 'drive-lane',\n      variantString: 'car',\n      variantStringAdd: 'direction|variantString'\n    },\n    Truck: {\n      type: 'drive-lane',\n      variantString: 'truck',\n      variantStringAdd: 'direction|variantString'\n    }\n  },\n  Parking: {\n    '': {\n      tag: 'Parking - Parallel',\n      type: 'parking-lane',\n      variantStringAdd: 'direction|side'\n    },\n    Parallel: {\n      tag: 'Parking - Parallel',\n      type: 'parking-lane',\n      variantStringAdd: 'direction|side'\n    },\n    AngleNormal: {\n      tag: 'Parking - Angle',\n      type: 'parking-lane',\n      nameToVariantMap: {\n        'Away, L. Park, Head In': 'angled-rear-left',\n        'Toward, R. Park, Head In': 'angled-front-right',\n        'Toward, L. Park, Head In': 'angled-front-left',\n        'Away, R. Park, Head In': 'angled-rear-right'\n      },\n      variantStringAdd: 'side'\n    },\n    Perpendicular: {\n      type: 'parking-lane',\n      variantString: 'sideways',\n      variantStringAdd: 'variantString|side'\n    }\n  },\n  Buffers: {\n    '': { type: 'divider', variantString: 'median' },\n    Trees: { type: 'divider', variantString: 'big-tree' },\n    tree: { type: 'divider', variantString: 'palm-tree' },\n    season_tree: { type: 'divider', variantString: 'big-tree' },\n    median: { type: 'divider', variantString: 'planting-strip' },\n    planter: { type: 'divider', variantString: 'planting-strip' }\n  }\n};\n// copy repeating rules\nmapping['Buffers']['AngleNormal'] = mapping['Parking']['AngleNormal'];\nmapping['Buffers']['Autos'] = mapping['Cars']['Autos'];\nmapping['Buffers']['Purpendicular'] = mapping['Parking']['Perpendicular'];\nmapping['Median/Buffer'] = mapping['Buffers'];\nmapping['Setback']['tree'] = mapping['Buffers']['tree'];\nmapping['Setback']['Trees'] = mapping['Buffers']['Trees'];\nmapping['Setback']['season_tree'] = mapping['Buffers']['season_tree'];\n// fix for typo Purpendicular\nmapping['Parking']['Purpendicular'] = mapping['Parking']['Perpendicular'];\nmapping['Setback']['Purpendicular'] = mapping['Parking']['Perpendicular'];\nmapping['Setback']['AngleNormal'] = mapping['Parking']['AngleNormal'];\nmapping['Setback']['planter'] = mapping['Buffers']['planter'];\nmapping['Setback']['BikeRacks'] = mapping['Curbside']['BikeRacks'];\nmapping['Setback']['Tables'] = mapping['Walkways']['Tables'];\nmapping['Setback']['Poles'] = mapping['Curbside']['Poles'];\n\nmapping['Curbside']['Shelters'] = mapping['Furniture']['Shelters'];\nmapping['Curbside']['Benchs'] = mapping['Walkways']['Benchs'];\n\nmapping['Furniture']['planter'] = mapping['Buffers']['planter'];\nmapping['Furniture']['Benchs'] = mapping['Walkways']['Benchs'];\nmapping['Furniture']['BikeRacks'] = mapping['Curbside']['BikeRacks'];\nmapping['Furniture']['Tables'] = mapping['Walkways']['Tables'];\n\nconst directionMap = {\n  Coming: 'inbound',\n  Going: 'outbound',\n  // make default outbound direction for both variant\n  Both: 'both',\n  NA: ''\n};\n\nconst materialMap = {\n  'Asphalt Black': 'regular',\n  'Asphalt Blue': 'blue',\n  'Asphalt Red 1': 'red',\n  'Asphalt Red 2': 'red',\n  'Asphalt Green': 'green',\n  'Asphalt Old': 'regular',\n  Grass: 'grass',\n  'Grass Dead': 'grass'\n};\n\n// StreetMix variantString often has additional parameters via |, for example: taxi|outbound|right\n// generate a streetMix like variantString from the listed parameters in variantStringAdd\nfunction generateVariantString(variantStringKeys, streetmixData) {\n  const variantString = variantStringKeys\n    .split('|')\n    .map((currKey) => streetmixData[currKey])\n    .join('|');\n  return variantString;\n}\n\nfunction getDataFromSubtypeMap(convertRule, streetmixData, streetplanData) {\n  if (typeof convertRule === 'string') {\n    // convertRule is a Streetmix type.\n    // Later will add another options for this case\n    streetmixData['type'] = convertRule;\n  } else if (Array.isArray(convertRule)) {\n    // in this case, different segment subtype options\n    // are associated with the different Streetmix types\n\n    // find the desired Streetmix segment data from the array by Streetplan tag and names(?)\n    const variantData = convertRule.find((element) => {\n      const tagValMatches = element['tag'] === streetplanData['O1-Tags'];\n      if (tagValMatches && element['names']) {\n        return element['names'].includes(streetplanData['O1-Name']);\n      }\n      return tagValMatches;\n    });\n\n    streetmixData['variantString'] = '';\n\n    const variantString = variantData['variantString'];\n    if (variantString && typeof variantString === 'string') {\n      streetmixData['variantString'] = variantString;\n    }\n\n    // generate a streetMix like variantString from the listed parameter values\n    streetmixData['type'] = variantData['type'];\n    const variantStringKeys = variantData['variantStringAdd'];\n    if (variantStringKeys) {\n      streetmixData['variantString'] = generateVariantString(\n        variantStringKeys,\n        streetmixData\n      );\n    }\n  } else if (typeof convertRule === 'object') {\n    // in this case, different variants of the segment subtype\n    // are associated with different variantString of the Streetmix segment\n\n    streetmixData['type'] = convertRule['type'];\n    streetmixData['variantString'] = '';\n\n    const variantString = convertRule['variantString'];\n    if (variantString && typeof variantString === 'string') {\n      streetmixData['variantString'] = variantString;\n    }\n\n    // get variantString from {\"O1-Name\" (StreetPlan Object Name) : variantString} mapping data\n    const nameToVariantMap = convertRule['nameToVariantMap'];\n    if (nameToVariantMap && nameToVariantMap[streetplanData['O1-Name']]) {\n      streetmixData['variantString'] =\n        nameToVariantMap[streetplanData['O1-Name']];\n    }\n\n    // get variantString from {\"O1-Tags\" (StreetPlan Tag) : variantString} mapping data\n    const tagToVariantMap = convertRule['tagToVariantMap'];\n    if (tagToVariantMap && tagToVariantMap[streetplanData['O1-Tags']]) {\n      streetmixData['variantString'] =\n        tagToVariantMap[streetplanData['O1-Tags']];\n    }\n\n    // generate a streetMix like variantString from the listed parameter values\n    const variantStringKeys = convertRule['variantStringAdd'];\n    if (variantStringKeys) {\n      streetmixData['variantString'] = generateVariantString(\n        variantStringKeys,\n        streetmixData\n      );\n    }\n  }\n\n  return streetmixData;\n}\n\n// convert streetPlan segment data to Streetmix segment data\nfunction convertSegment(data) {\n  let streetmixData = {};\n  const streetplanType = data['Type'];\n  const streetplanSubtype = data['Subtype'];\n  // mapping rule for current Streetplan subtypes\n  const subtypeMap = mapping[streetplanType];\n\n  // convert elevation value to Streetmix format: 0, 1, 2\n  streetmixData['elevation'] = data['MaterialH'] / 0.5;\n  streetmixData['width'] = data['width'];\n  streetmixData['direction'] = directionMap[data['Direction']];\n  if (data['side']) {\n    streetmixData['side'] = data['side'];\n  }\n  if (data['Material']) {\n    streetmixData['material'] = materialMap[data['Material']];\n  }\n\n  if (subtypeMap) {\n    const convertRule = subtypeMap[streetplanSubtype];\n    if (convertRule) {\n      streetmixData = getDataFromSubtypeMap(convertRule, streetmixData, data);\n    } else {\n      streetmixData['type'] = streetplanType;\n      // STREET.notify.warningMessage(`The '${streetplanSubtype}' subtype of StreetPlan segment '${segmentType}' is not yet supported in 3DStreet`);\n      console.log(\n        `The '${streetplanSubtype}' subtype of StreetPlan segment '${streetplanType}' is not yet supported in 3DStreet`\n      );\n    }\n  } else {\n    streetmixData['type'] = streetplanType;\n    // STREET.notify.warningMessage(`The '${streetplanType}' StreetPlan segment type is not yet supported in 3DStreet`);\n    console.log(\n      `The '${streetplanType}' StreetPlan segment type is not yet supported in 3DStreet`\n    );\n  }\n  return streetmixData;\n}\n\nmodule.exports.convertSegment = convertSegment;\n","// utils for StreetPlan parsing\nconst mappingUtils = require('./conversion-map.js');\n\n// convert width from feet to meters\nfunction convertStreetValues(streetData) {\n  streetData.segments.forEach((segmentData) => {\n    segmentData.width *= 0.3048;\n  });\n}\n\n// convert street structure to look like Streetmix JSON Schema\nfunction convertStreetStruct(streetProject) {\n  const newStruct = {};\n  const streetplanName = Object.keys(streetProject)[0];\n  // streetplan alternative name\n  const streetplanAltName = Object.keys(streetProject[streetplanName])[0];\n  newStruct.name = streetplanName;\n  newStruct.altName = streetplanAltName;\n\n  // remove segment indexes\n  newStruct.segments = Object.values(\n    streetProject[streetplanName][streetplanAltName].segments\n  );\n\n  convertStreetValues(newStruct);\n\n  // remove buildings and setback for now. To add them in another place\n  newStruct.segments = convertSegmentData(newStruct.segments).filter(\n    (segmentData) => {\n      return !['Buildings', 'setback'].includes(segmentData['type']);\n    }\n  );\n\n  console.log('TEST. Converted JSON structure: ', newStruct);\n\n  return newStruct;\n}\n\nmodule.exports.convertStreetStruct = convertStreetStruct;\n\nfunction convertSegmentData(segments) {\n  return segments.map(mappingUtils.convertSegment);\n}\n","function isSidewalk(string) {\n  // eslint-disable-line no-unused-vars\n  // https://streetmix.net/api/v1/streets/3f1a9810-0a8f-11ea-adff-7fe273b63f1d\n  //  return if string sidewalk* or \"scooter-drop-zone\", bikeshare, flex-zone-curb, transit-shelter\n  const sidewalkList = [\n    'utilities',\n    'scooter-drop-zone',\n    'bikeshare',\n    'flex-zone-curb',\n    'transit-shelter',\n    'brt-station',\n    'street-vendor'\n  ];\n  return string.startsWith('sidewalk') || sidewalkList.includes(string);\n}\nmodule.exports.isSidewalk = isSidewalk;\n\n// generate a JSON array representing buildings\n// test createBuildingsArray(maxLength = 5) returns [{ tag: 'a-entity', mixin: 'SM3D_Bld_Mixed_Corner_4fl', position: '0 0 0' }]\n// test createBuildingsArray(maxLength = 10) returns [{ mixin: \"SM3D_Bld_Mixed_Corner_4fl\", position: \"0 0 0\", tag: \"a-entity\" }, {mixin: \"SM3D_Bld_Mixed_Double_5fl\", position: \"0 0 5\", tag: \"a-entity\"} ]\nfunction createBuildingsArray(maxLength = 150, buildingType = 'narrow') {\n  // eslint-disable-line no-unused-vars\n  var buildings, psuedoRandom;\n  if (buildingType === 'narrow' || buildingType === 'wide') {\n    buildings = [\n      { id: 'SM3D_Bld_Mixed_4fl', width: 5.251 },\n      { id: 'SM3D_Bld_Mixed_Double_5fl', width: 10.9041 },\n      { id: 'SM3D_Bld_Mixed_4fl_2', width: 5.309 },\n      { id: 'SM3D_Bld_Mixed_5fl', width: 5.903 },\n      { id: 'SM3D_Bld_Mixed_Corner_4fl', width: 5.644 }\n    ];\n    psuedoRandom = '41431323432402434130303230234102402341'; // 38 psuedorandom numbers 0-4, no identical units side-by-side\n  } else if (buildingType === 'residential') {\n    buildings = [\n      { id: 'SM_Bld_House_Preset_03_1800', width: 20 },\n      { id: 'SM_Bld_House_Preset_08_1809', width: 20 },\n      { id: 'SM_Bld_House_Preset_09_1845', width: 20 }\n    ];\n    psuedoRandom = '12021201210101212021201012012021201210'; // 38 psuedorandom numbers 0-2, no identical units side-by-side\n  } else if (buildingType === 'arcade') {\n    buildings = [\n      { id: 'arched-building-01', width: 9.191 },\n      { id: 'arched-building-02', width: 11.19 },\n      { id: 'arched-building-03', width: 13.191 },\n      { id: 'arched-building-04', width: 15.191 }\n    ];\n    psuedoRandom = '03120223130210321203123023103201232013'; // 38 psuedorandom numbers 0-3, no identical units side-by-side\n  } else {\n    return [];\n  }\n\n  var i = 0;\n  var length = 0;\n  var buildingsArray = [];\n\n  while (length < maxLength) {\n    // get a building using the psuedo random number\n    var building = buildings[parseInt(psuedoRandom[i])];\n    var buildingEntity = {\n      tag: 'a-entity',\n      mixin: building.id,\n      position: '' + (length + building.width / 2) + ' 0 0'\n    };\n\n    if (buildingEntity.mixin === 'SM_Bld_House_Preset_08_1809') {\n      buildingEntity.child = {\n        tag: 'a-plane',\n        class: 'driveway',\n        material: 'roughness:0.8',\n        position: '-6.25 0.6 -8.75',\n        rotation: '-90 0 0',\n        src: '#asphalt-texture',\n        width: 4,\n        height: 4.6\n      };\n    }\n\n    if (buildingEntity.mixin === 'SM_Bld_House_Preset_09_1845') {\n      buildingEntity.child = {\n        tag: 'a-plane',\n        class: 'driveway',\n        material: 'roughness:0.8',\n        position: '-2.5 0.6 -7',\n        rotation: '-90 0 0',\n        src: '#asphalt-texture',\n        width: 4,\n        height: 8\n      };\n    }\n    if (building.width + length <= maxLength) {\n      buildingsArray.push(buildingEntity);\n    }\n\n    length += building.width;\n    i++;\n  }\n\n  return buildingsArray;\n}\nmodule.exports.createBuildingsArray = createBuildingsArray;\n\n// for an array of objects representing HTML, remove entities except those that match the mixinId specified\nfunction filterBuildingsArrayByMixin(buildingsArray, mixinId) {\n  // eslint-disable-line no-unused-vars\n  var filteredBuildingsArray = [];\n  buildingsArray.forEach((currentEntity, index) => {\n    if (currentEntity.mixin === mixinId) {\n      filteredBuildingsArray.push(currentEntity);\n    }\n  });\n  return filteredBuildingsArray;\n}\nmodule.exports.filterBuildingsArrayByMixin = filterBuildingsArrayByMixin;\n\n// for an array of objects representing HTML, for each object remove the property matching the passed string `key`\nfunction removePropertyFromArray(htmlArray, key) {\n  // eslint-disable-line no-unused-vars\n  htmlArray.forEach((currentEntity, index) => {\n    delete currentEntity[key];\n  });\n  return htmlArray;\n}\nmodule.exports.removePropertyFromArray = removePropertyFromArray;\n\nfunction createClonedEntitiesArray({\n  mixin = '',\n  step = 15,\n  radius = 60,\n  rotation = '0 0 0',\n  positionXYString = '0 0',\n  randomY = false\n}) {\n  // eslint-disable-line no-unused-vars\n  var clonedEntitiesArray = [];\n\n  for (var j = radius * -1; j <= radius; j = j + step) {\n    var clonedEntity = {\n      tag: 'a-entity',\n      position: positionXYString + ' ' + j\n    };\n\n    if (mixin) {\n      clonedEntity.class = mixin;\n      clonedEntity.mixin = mixin;\n    }\n\n    if (randomY) {\n      clonedEntity.rotation = '0 ' + Math.floor(randomTestable() * 361) + ' 0'; // eslint-disable-line no-undef\n    } else {\n      clonedEntity.rotation = rotation;\n    }\n\n    clonedEntitiesArray.push(clonedEntity);\n  }\n\n  return clonedEntitiesArray;\n}\nmodule.exports.createClonedEntitiesArray = createClonedEntitiesArray;\n\n// TODO: rename to createAmbientSoundsArray\nfunction getAmbientSoundJSON(buildingsArray) {\n  // eslint-disable-line no-unused-vars\n  const ambientSounds = {\n    fence: '#suburbs-mp3',\n    grass: '#suburbs-mp3',\n    'parking-lot': '#parking-lot-mp3',\n    waterfront: '#waterfront',\n    residential: '#suburbs2-mp3',\n    narrow: '#ambientmp3',\n    wide: '#ambientmp3'\n  };\n\n  var soundsArray = [];\n  var prevURL = null;\n  buildingsArray.forEach((currentValue, index) => {\n    // <a-entity class=\"playme\" sound=\"src: #ambientmp3; positional: false; loop: true;\"></a-entity>\n    if (prevURL && prevURL === ambientSounds[currentValue]) {\n      return;\n    }\n    var soundEntity = {\n      tag: 'a-entity',\n      class: 'playme',\n      sound:\n        'src: ' +\n        ambientSounds[currentValue] +\n        '; positional: false; loop: true'\n    };\n    soundsArray.push(soundEntity);\n    prevURL = ambientSounds[currentValue];\n  });\n  return soundsArray;\n}\nmodule.exports.getAmbientSoundJSON = getAmbientSoundJSON;\n","// given an object such as { mixin: \"SM3D_Bld_Mixed_Corner_4fl\", position: \"0 0 0\", tag: \"a-entity\" } return an HTML Element with matching attributes\nfunction createElementFromObject(object = {}) {\n  // eslint-disable-line no-unused-vars\n  // assumes each object has a \"tag\" key/value pair TODO: \"a-entity\" is default tag if none is present\n  const el = document.createElement(object.tag);\n  delete object.tag;\n  for (const [key, value] of Object.entries(object)) {\n    if (key === 'child') {\n      var childEl = document.createElement(value.tag);\n      for (const [childKey, childValue] of Object.entries(value)) {\n        childEl.setAttribute(childKey, childValue);\n      }\n      el.appendChild(childEl);\n    }\n    el.setAttribute(key, value);\n  }\n  return el;\n}\nmodule.exports.createElementFromObject = createElementFromObject;\n\n// return a parent element with children appended from the array of objects\nfunction appendChildElementsFromArray(array = [], parentEl) {\n  // eslint-disable-line no-unused-vars\n  // for each object that represents an \"a-entity\" element to be created\n  array.forEach(function (object, index) {\n    parentEl.appendChild(createElementFromObject(object));\n  });\n  return parentEl;\n}\nmodule.exports.appendChildElementsFromArray = appendChildElementsFromArray;\n","function streetmixUserToAPI(userURL) {\n  // eslint-disable-line no-unused-vars\n  // this takes in a user facing Streetmix.net URL like https://streetmix.net/kfarr/3/a-frame-city-builder-street-only\n  // and turns it into the API redirect URL like https://streetmix.net/api/v1/streets?namespacedId=3&creatorId=kfarr\n  var pathArray = new URL(userURL).pathname.split('/');\n  const creatorId = pathArray[1];\n  const namespacedId = pathArray[2];\n  if (creatorId === '-') {\n    return 'https://streetmix.net/api/v1/streets?namespacedId=' + namespacedId;\n  } else {\n    return (\n      'https://streetmix.net/api/v1/streets?namespacedId=' +\n      namespacedId +\n      '&creatorId=' +\n      creatorId\n    );\n  }\n}\nmodule.exports.streetmixUserToAPI = streetmixUserToAPI;\n\nfunction pathStartsWithAPI(urlString) {\n  // First, check the URL path to see if it starts with /api/\n  const url = document.createElement('a');\n  url.href = urlString;\n  const pathname = url.pathname;\n  const topDir = pathname.split('/')[1];\n  return topDir === 'api';\n}\nmodule.exports.pathStartsWithAPI = pathStartsWithAPI;\n\nfunction streetmixAPIToUser(APIURL) {\n  // eslint-disable-line no-unused-vars\n  // this takes in a Streetmix.net API redirect URL like https://streetmix.net/api/v1/streets?namespacedId=3&creatorId=kfarr\n  // and turns it into the user facing friendly Streetmix.net URL like https://streetmix.net/kfarr/3/a-frame-city-builder-street-only\n\n  // modified from: https://stackoverflow.com/questions/2090551/parse-query-string-in-javascript\n  function getQueryVariable(queryString, variable) {\n    var vars = queryString.split('&');\n    for (var i = 0; i < vars.length; i++) {\n      var pair = vars[i].split('=');\n      if (decodeURIComponent(pair[0]) === variable) {\n        return decodeURIComponent(pair[1]);\n      }\n    }\n    console.log('Query variable %s not found', variable);\n  }\n  var queryString = new URL(APIURL).search.substring(1);\n  var namespacedId = getQueryVariable(queryString, 'namespacedId');\n  var creatorId = getQueryVariable(queryString, 'creatorId');\n  if (typeof creatorId === 'undefined') {\n    creatorId = '-';\n  }\n\n  return 'https://streetmix.net/' + creatorId + '/' + namespacedId;\n}\nmodule.exports.streetmixAPIToUser = streetmixAPIToUser;\n\n// convert all feet values to meters for schemaVersion < 30\nfunction convertStreetValues(streetData) {\n  if (streetData.schemaVersion < 30) {\n    // convert width from feet to meters\n    streetData.segments.forEach((segmentData) => {\n      segmentData.width *= 0.3048;\n    });\n    if (streetData.width) streetData.width *= 0.3048;\n  }\n  return streetData;\n}\nmodule.exports.convertStreetValues = convertStreetValues;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","/* global AFRAME, XMLHttpRequest, VERSION */\n\nif (typeof VERSION !== 'undefined') {\n  console.log(`3DStreet Version: ${VERSION}`);\n}\n\nvar streetmixParsers = require('./aframe-streetmix-parsers');\nvar streetmixUtils = require('./tested/streetmix-utils');\nrequire('./json-utils_1.1.js');\nrequire('./components/gltf-part');\nrequire('./components/ocean');\nrequire('./components/svg-extruder.js');\nrequire('./lib/aframe-cursor-teleport-component.min.js');\nrequire('./lib/animation-mixer.js');\nrequire('./assets.js');\nrequire('./components/notify.js');\nrequire('./components/create-from-json');\nrequire('./components/screentock.js');\nrequire('aframe-atlas-uvs-component');\nrequire('./components/streetplan-loader');\nrequire('./components/street-geo.js');\n\nAFRAME.registerComponent('street', {\n  schema: {\n    JSON: { type: 'string' },\n    type: { default: 'streetmixSegmentsMetric' }, // alt: sharedRowMeters, streetmixJSONResponse\n    left: { default: '' },\n    right: { default: '' },\n    showGround: { default: true },\n    showStriping: { default: true },\n    showVehicles: { default: true },\n    globalAnimated: { default: false },\n    length: { default: 60 } // new default of 60 from 0.4.4\n  },\n  update: function (oldData) {\n    // fired once at start and at each subsequent change of a schema value\n    var data = this.data;\n\n    if (data.JSON.length === 0) {\n      if (oldData.JSON !== undefined && oldData.JSON.length === 0) {\n        return;\n      } // this has happened before, surpress console log\n      console.log(\n        '[street]',\n        'No JSON provided yet, but it might be set at runtime'\n      );\n      return;\n    }\n\n    const streetmixSegments = JSON.parse(data.JSON);\n\n    // remove .street-parent and .buildings-parent elements, if they exists, with old scene elements.\n    // Because they will be created next in the processSegments and processBuildings functions\n    const streetParent = this.el.querySelector('.street-parent');\n    if (streetParent) {\n      streetParent.remove();\n    }\n    const buildingParent = this.el.querySelector('.buildings-parent');\n    if (buildingParent) {\n      buildingParent.remove();\n    }\n\n    const streetEl = streetmixParsers.processSegments(\n      streetmixSegments.streetmixSegmentsMetric,\n      data.showStriping,\n      data.length,\n      data.globalAnimated,\n      data.showVehicles\n    );\n    this.el.append(streetEl);\n\n    if (data.left || data.right) {\n      const streetWidth = streetmixSegments.streetmixSegmentsMetric.reduce(\n        (streetWidth, segmentData) => streetWidth + segmentData.width,\n        0\n      );\n      const buildingsEl = streetmixParsers.processBuildings(\n        data.left,\n        data.right,\n        streetWidth,\n        data.showGround,\n        data.length\n      );\n      this.el.append(buildingsEl);\n    }\n  }\n});\n\nAFRAME.registerComponent('streetmix-loader', {\n  dependencies: ['street'],\n  schema: {\n    streetmixStreetURL: { type: 'string' },\n    streetmixAPIURL: { type: 'string' },\n    showBuildings: { default: true },\n    name: { default: '' }\n  },\n  update: function (oldData) {\n    // fired at start and at each subsequent change of any schema value\n    // This method may fire a few times when viewing a streetmix street in 3dstreet:\n    // First to find the proper path, once to actually load the street, and then subsequent updates such as street name\n    var data = this.data;\n    var el = this.el;\n\n    // if the loader has run once already, and upon update neither URL has changed, do not take action\n    if (\n      oldData.streetmixStreetURL === data.streetmixStreetURL &&\n      oldData.streetmixAPIURL === data.streetmixAPIURL\n    ) {\n      // console.log('[streetmix-loader]', 'Neither streetmixStreetURL nor streetmixAPIURL have changed in this component data update, not reloading street.')\n      return;\n    }\n\n    // if no value for 'streetmixAPIURL' then let's see if there's a streetmixURL\n    if (data.streetmixAPIURL.length === 0) {\n      if (data.streetmixStreetURL.length > 0) {\n        const streetmixAPIURL = streetmixUtils.streetmixUserToAPI(\n          data.streetmixStreetURL\n        );\n        console.log(\n          '[streetmix-loader]',\n          'setting `streetmixAPIURL` to',\n          streetmixAPIURL\n        );\n        el.setAttribute('streetmix-loader', 'streetmixAPIURL', streetmixAPIURL);\n        return;\n      }\n      console.log(\n        '[streetmix-loader]',\n        'Neither `streetmixAPIURL` nor `streetmixStreetURL` properties provided, please provide at least one.'\n      );\n      return;\n    }\n\n    var request = new XMLHttpRequest();\n    console.log('[streetmix-loader]', 'GET ' + data.streetmixAPIURL);\n\n    request.open('GET', data.streetmixAPIURL, true);\n    request.onload = function () {\n      if (this.status >= 200 && this.status < 400) {\n        // Connection success\n        const streetmixResponseObject = JSON.parse(this.response);\n        // convert units of measurement if necessary\n        const streetData = streetmixUtils.convertStreetValues(\n          streetmixResponseObject.data.street\n        );\n        const streetmixSegments = streetData.segments;\n\n        const streetmixName = streetmixResponseObject.name;\n        console.log('streetmixName', streetmixName);\n        el.setAttribute('streetmix-loader', 'name', streetmixName);\n\n        let currentSceneTitle;\n        if (AFRAME.scenes[0] && AFRAME.scenes[0].getAttribute('metadata')) {\n          currentSceneTitle =\n            AFRAME.scenes[0].getAttribute('metadata').sceneTitle;\n        }\n        if (!currentSceneTitle) {\n          // only set title from streetmix if none exists\n          AFRAME.scenes[0].setAttribute(\n            'metadata',\n            'sceneTitle',\n            streetmixName\n          );\n          console.log(\n            'therefore setting metadata sceneTitle as streetmixName',\n            streetmixName\n          );\n        }\n\n        el.setAttribute('data-layer-name', 'Streetmix • ' + streetmixName);\n\n        if (data.showBuildings) {\n          el.setAttribute('street', 'right', streetData.rightBuildingVariant);\n          el.setAttribute('street', 'left', streetData.leftBuildingVariant);\n        }\n        el.setAttribute('street', 'type', 'streetmixSegmentsMetric');\n        // set JSON attribute last or it messes things up\n        el.setAttribute(\n          'street',\n          'JSON',\n          JSON.stringify({ streetmixSegmentsMetric: streetmixSegments })\n        );\n        el.emit('streetmix-loader-street-loaded');\n      } else {\n        // We reached our target server, but it returned an error\n        console.log(\n          '[streetmix-loader]',\n          'Loading Error: We reached the target server, but it returned an error'\n        );\n      }\n    };\n    request.onerror = function () {\n      // There was a connection error of some sort\n      console.log(\n        '[streetmix-loader]',\n        'Loading Error: There was a connection error of some sort'\n      );\n    };\n    request.send();\n  }\n});\n\nAFRAME.registerComponent('intersection', {\n  schema: {\n    dimensions: { type: 'string', default: '20 20' },\n    sidewalk: { type: 'string', default: '0 0 0 0' },\n    northeastcurb: { type: 'string', default: '0 0' },\n    southwestcurb: { type: 'string', default: '0 0' },\n    southeastcurb: { type: 'string', default: '0 0' },\n    northwestcurb: { type: 'string', default: '0 0' },\n    stopsign: { type: 'string', default: '0 0 0 0' },\n    trafficsignal: { type: 'string', default: '0 0 0 0' },\n    crosswalk: { type: 'string', default: '0 0 0 0' }\n  },\n  init: function () {\n    var data = this.data;\n    var el = this.el;\n\n    // remove all child nodes if exists\n    while (el.firstChild) {\n      el.removeChild(el.lastChild);\n    }\n    const dimensionsArray = data.dimensions.split(' ').map((i) => Number(i));\n    const positionArray = [\n      this.el.getAttribute('position').x,\n      this.el.getAttribute('position').y,\n      this.el.getAttribute('position').z\n    ];\n    const sidewalkArray = data.sidewalk.split(' ').map((i) => Number(i));\n    const northeastcurbArray = data.northeastcurb\n      .split(' ')\n      .map((i) => Number(i));\n    const southwestcurbArray = data.southwestcurb\n      .split(' ')\n      .map((i) => Number(i));\n    const southeastcurbArray = data.southeastcurb\n      .split(' ')\n      .map((i) => Number(i));\n    const northwestcurbArray = data.northwestcurb\n      .split(' ')\n      .map((i) => Number(i));\n    const stopsignArray = data.stopsign.split(' ').map((i) => Number(i));\n    const trafficsignalArray = data.trafficsignal\n      .split(' ')\n      .map((i) => Number(i));\n    const crosswalklArray = data.crosswalk.split(' ').map((i) => Number(i));\n\n    const intersectWidth = dimensionsArray[0];\n    const intersectDepth = dimensionsArray[1];\n\n    this.el.setAttribute(\n      'geometry',\n      `primitive:box; width: ${intersectWidth}; height: ${intersectDepth}; depth:0.2`\n    );\n    this.el.setAttribute('position', {\n      x: positionArray[0],\n      y: -0.1,\n      z: positionArray[2]\n    });\n    this.el.setAttribute('rotation', '-90 0 0');\n    this.el.setAttribute(\n      'material',\n      'src: #asphalt-texture; repeat:5 5; roughness:1'\n    );\n\n    function createSidewalkElem({\n      length,\n      width,\n      positionVec,\n      scaleVec = { x: 1, y: 1, z: 1 },\n      rotationVec\n    }) {\n      const sd = document.createElement('a-entity');\n      const repeatCountInter = [];\n      repeatCountInter[0] = width / 2;\n      // every 2 meters repeat sidewalk texture\n      repeatCountInter[1] = parseInt(length / 2);\n\n      sd.setAttribute('geometry', 'primitive', 'box');\n      sd.setAttribute('geometry', 'height: 0.4');\n      sd.setAttribute('position', positionVec);\n      sd.setAttribute('scale', scaleVec);\n      sd.setAttribute('geometry', 'depth', length);\n      sd.setAttribute('geometry', 'width', width);\n      sd.setAttribute('rotation', rotationVec);\n      sd.setAttribute('mixin', 'sidewalk');\n      sd.setAttribute(\n        'material',\n        `repeat: ${repeatCountInter[0]} ${repeatCountInter[1]}`\n      );\n      el.appendChild(sd);\n    }\n\n    // describe sidewalk parameters\n    const sidewalkParams = {\n      west: {\n        positionVec: { x: intersectWidth / 2 - sidewalkArray[0] / 2, z: 0.1 },\n        rotationVec: { x: 90, y: 0, z: 0 },\n        length: intersectDepth,\n        width: sidewalkArray[0]\n      },\n      east: {\n        positionVec: { x: -intersectWidth / 2 + sidewalkArray[1] / 2, z: 0.1 },\n        rotationVec: { x: 90, y: 0, z: 0 },\n        length: intersectDepth,\n        width: sidewalkArray[1]\n      },\n      north: {\n        positionVec: {\n          y: -intersectDepth / 2 + sidewalkArray[2] / 2,\n          // add x offset to avoid sidewalk's element overlap\n          x: sidewalkArray[1] / 2 - sidewalkArray[0] / 2,\n          z: 0.1\n        },\n        rotationVec: { x: 0, y: 90, z: -90 },\n        // minus the width of the crossing sidewalk\n        length: intersectWidth - sidewalkArray[1] - sidewalkArray[0],\n        width: sidewalkArray[2]\n      },\n      south: {\n        positionVec: {\n          y: intersectDepth / 2 - sidewalkArray[3] / 2,\n          // add x offset to avoid sidewalk's element overlap\n          x: sidewalkArray[1] / 2 - sidewalkArray[0] / 2,\n          z: 0.1\n        },\n        rotationVec: { x: 0, y: 90, z: -90 },\n        // minus the width of the crossing sidewalk\n        length: intersectWidth - sidewalkArray[1] - sidewalkArray[0],\n        width: sidewalkArray[3]\n      }\n    };\n\n    // create sidewalks if they are given in sidewalkArray\n    const selectedSidewalks = Object.keys(sidewalkParams).filter(\n      (el, ind) => sidewalkArray[ind]\n    );\n\n    selectedSidewalks.forEach((sidewalkName, ind) => {\n      const params = sidewalkParams[sidewalkName];\n      createSidewalkElem(params);\n    });\n\n    // describe curb parameters\n    const curbParams = {\n      northeast: {\n        positionVec: {\n          x: intersectWidth / 2 - northeastcurbArray[0] / 2,\n          y: intersectDepth / 2 - northeastcurbArray[1] / 2,\n          z: 0.1\n        },\n        rotationVec: { x: 0, y: 90, z: -90 },\n        length: northeastcurbArray[0],\n        width: northeastcurbArray[1]\n      },\n      southwest: {\n        positionVec: {\n          x: -intersectWidth / 2 + southwestcurbArray[0] / 2,\n          y: -intersectDepth / 2 + southwestcurbArray[1] / 2,\n          z: 0.1\n        },\n        rotationVec: { x: 0, y: 90, z: -90 },\n        length: southwestcurbArray[0],\n        width: southwestcurbArray[1]\n      },\n      southeast: {\n        positionVec: {\n          x: intersectWidth / 2 - southeastcurbArray[0] / 2,\n          y: -intersectDepth / 2 + southeastcurbArray[1] / 2,\n          z: 0.1\n        },\n        rotationVec: { x: 0, y: 90, z: -90 },\n        length: southeastcurbArray[0],\n        width: southeastcurbArray[1]\n      },\n      northwest: {\n        positionVec: {\n          x: -intersectWidth / 2 + northwestcurbArray[0] / 2,\n          y: intersectDepth / 2 - northwestcurbArray[1] / 2,\n          z: 0.1\n        },\n        rotationVec: { x: 0, y: 90, z: -90 },\n        length: northwestcurbArray[0],\n        width: northwestcurbArray[1]\n      }\n    };\n\n    // create curbs if they are given\n    for (const [curbName, params] of Object.entries(curbParams)) {\n      if (data[`${curbName}curb`] !== '0 0') {\n        createSidewalkElem(params);\n      }\n    }\n\n    if (stopsignArray[0]) {\n      const ss1 = document.createElement('a-entity');\n      ss1.setAttribute('position', {\n        x: intersectWidth / 2,\n        y: intersectDepth / 3,\n        z: 0.1\n      });\n      ss1.setAttribute('rotation', { x: 0, y: 90, z: 90 });\n      ss1.setAttribute('mixin', 'stop_sign');\n      el.appendChild(ss1);\n    }\n    if (stopsignArray[1]) {\n      const ss2 = document.createElement('a-entity');\n      ss2.setAttribute('position', {\n        x: -intersectWidth / 2,\n        y: -intersectDepth / 3,\n        z: 0.1\n      });\n      ss2.setAttribute('rotation', { x: 0, y: -90, z: -90 });\n      ss2.setAttribute('mixin', 'stop_sign');\n      el.appendChild(ss2);\n    }\n    if (stopsignArray[2]) {\n      const ss3 = document.createElement('a-entity');\n      ss3.setAttribute('position', {\n        x: -intersectWidth / 3,\n        y: intersectDepth / 2,\n        z: 0.1\n      });\n      ss3.setAttribute('rotation', { x: -90, y: 90, z: 90 });\n      ss3.setAttribute('mixin', 'stop_sign');\n      el.appendChild(ss3);\n    }\n    if (stopsignArray[3]) {\n      const ss4 = document.createElement('a-entity');\n      ss4.setAttribute('position', {\n        x: intersectWidth / 3,\n        y: -intersectDepth / 2,\n        z: 0.1\n      });\n      ss4.setAttribute('rotation', { x: 90, y: -90, z: -90 });\n      ss4.setAttribute('mixin', 'stop_sign');\n      el.appendChild(ss4);\n    }\n\n    if (trafficsignalArray[0]) {\n      const ts1 = document.createElement('a-entity');\n      ts1.setAttribute('position', {\n        x: intersectWidth / 2,\n        y: intersectDepth / 3,\n        z: 0.3\n      });\n      ts1.setAttribute('rotation', { x: 210, y: 90, z: 90 });\n      ts1.setAttribute('mixin', 'signal_left');\n      el.appendChild(ts1);\n      const ts2 = document.createElement('a-entity');\n      ts2.setAttribute('position', {\n        x: intersectWidth / 2,\n        y: -intersectDepth / 3,\n        z: 0.3\n      });\n      ts2.setAttribute('rotation', { x: 180, y: 90, z: 90 });\n      ts2.setAttribute('mixin', 'signal_right');\n      el.appendChild(ts2);\n    }\n    if (trafficsignalArray[1]) {\n      const ts3 = document.createElement('a-entity');\n      ts3.setAttribute('position', {\n        x: -intersectWidth / 2,\n        y: -intersectDepth / 3,\n        z: 0.3\n      });\n      ts3.setAttribute('rotation', { x: 30, y: 90, z: 90 });\n      ts3.setAttribute('mixin', 'signal_left');\n      el.appendChild(ts3);\n      const ts4 = document.createElement('a-entity');\n      ts4.setAttribute('position', {\n        x: -intersectWidth / 2,\n        y: intersectDepth / 3,\n        z: 0.3\n      });\n      ts4.setAttribute('rotation', { x: 0, y: 90, z: 90 });\n      ts4.setAttribute('mixin', 'signal_right');\n      el.appendChild(ts4);\n    }\n    if (trafficsignalArray[2]) {\n      const ts5 = document.createElement('a-entity');\n      ts5.setAttribute('position', {\n        x: -intersectWidth / 3,\n        y: intersectDepth / 2,\n        z: 0.1\n      });\n      ts5.setAttribute('rotation', { x: 120, y: 90, z: 90 });\n      ts5.setAttribute('mixin', 'signal_left');\n      el.appendChild(ts5);\n      const ts6 = document.createElement('a-entity');\n      ts6.setAttribute('position', {\n        x: intersectWidth / 3,\n        y: intersectDepth / 2,\n        z: 0.1\n      });\n      ts6.setAttribute('rotation', { x: 90, y: 90, z: 90 });\n      ts6.setAttribute('mixin', 'signal_right');\n      el.appendChild(ts6);\n    }\n    if (trafficsignalArray[3]) {\n      const ts7 = document.createElement('a-entity');\n      ts7.setAttribute('position', {\n        x: intersectWidth / 3,\n        y: -intersectDepth / 2,\n        z: 0.1\n      });\n      ts7.setAttribute('rotation', { x: -60, y: 90, z: 90 });\n      ts7.setAttribute('mixin', 'signal_left');\n      el.appendChild(ts7);\n      const ts8 = document.createElement('a-entity');\n      ts8.setAttribute('position', {\n        x: -intersectWidth / 3,\n        y: -intersectDepth / 2,\n        z: 0.1\n      });\n      ts8.setAttribute('rotation', { x: -90, y: 90, z: 90 });\n      ts8.setAttribute('mixin', 'signal_right');\n      el.appendChild(ts8);\n    }\n\n    if (crosswalklArray[0]) {\n      const cw1 = document.createElement('a-entity');\n      cw1.setAttribute('position', { x: intersectWidth / 2 - 2, z: 0.11 });\n      cw1.setAttribute('rotation', { x: 0, y: 0, z: 180 });\n      cw1.setAttribute('scale', { y: intersectDepth / 12 });\n      cw1.setAttribute('mixin', 'markings crosswalk-zebra');\n      el.appendChild(cw1);\n    }\n    if (crosswalklArray[1]) {\n      const cw2 = document.createElement('a-entity');\n      cw2.setAttribute('position', { x: -intersectWidth / 2 + 2, z: 0.11 });\n      cw2.setAttribute('rotation', { x: 0, y: 0, z: 180 });\n      cw2.setAttribute('scale', { y: intersectDepth / 12 });\n      cw2.setAttribute('mixin', 'markings crosswalk-zebra');\n      el.appendChild(cw2);\n    }\n    if (crosswalklArray[2]) {\n      const cw3 = document.createElement('a-entity');\n      cw3.setAttribute('position', { y: -intersectDepth / 2 + 2, z: 0.11 });\n      cw3.setAttribute('rotation', { x: 0, y: 0, z: 90 });\n      cw3.setAttribute('scale', { y: intersectWidth / 12 });\n      cw3.setAttribute('mixin', 'markings crosswalk-zebra');\n      el.appendChild(cw3);\n    }\n    if (crosswalklArray[3]) {\n      const cw4 = document.createElement('a-entity');\n      cw4.setAttribute('position', { y: intersectDepth / 2 - 2, z: 0.11 });\n      cw4.setAttribute('rotation', { x: 0, y: 0, z: 90 });\n      cw4.setAttribute('scale', { y: intersectWidth / 12 });\n      cw4.setAttribute('mixin', 'markings crosswalk-zebra');\n      el.appendChild(cw4);\n    }\n  }\n});\n\nAFRAME.registerComponent('street-environment', {\n  schema: {\n    preset: {\n      type: 'string',\n      default: 'day',\n      oneOf: [\n        'day',\n        'night',\n        'color',\n        'sunny-morning',\n        'cloudy-afternoon',\n        'sunny-afternoon',\n        'sunny-noon',\n        'foggy',\n        'cloudy'\n      ]\n    },\n    backgroundColor: { type: 'color', default: '#FFF' }\n  },\n  setEnvOption: function () {\n    const sky = this.sky;\n    const light1 = this.light1;\n    const light2 = this.light2;\n    const assetsPathRoot = '//assets.3dstreet.app/';\n\n    if (this.data.preset === 'night') {\n      light1.setAttribute('light', 'intensity', 0.5);\n      light2.setAttribute('light', 'intensity', 0.15);\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#444');\n      sky.setAttribute('src', '#sky-night');\n      sky.setAttribute('rotation', '0 0 0');\n    } else if (this.data.preset === 'day') {\n      // TODO: create a parent with children\n      light1.setAttribute('light', 'intensity', 0.8);\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute('src', '#sky');\n      sky.setAttribute('rotation', '0 20 0');\n      light2.setAttribute(\n        'light',\n        'intensity: 2.2; castShadow: true; shadowCameraBottom: -20; shadowCameraLeft: -30; shadowCameraRight: 40; shadowCameraTop: 30; shadowMapHeight: 2048; shadowMapWidth: 2048'\n      );\n      light2.setAttribute('position', '-40 56 -16');\n    } else if (this.data.preset === 'sunny-morning') {\n      light1.setAttribute('light', 'intensity', 0.8);\n      light2.setAttribute(\n        'light',\n        'intensity: 2.2; castShadow: true; shadowCameraBottom: -20; shadowCameraLeft: -30; shadowCameraRight: 40; shadowCameraTop: 30; shadowMapHeight: 2048; shadowMapWidth: 2048'\n      );\n      light2.setAttribute('position', '-60 56 -16');\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute(\n        'src',\n        `url(${assetsPathRoot}images/skies/2048-polyhaven-qwantani_puresky-sdr.jpeg)`\n      );\n      sky.setAttribute('rotation', '0 0 0');\n    } else if (this.data.preset === 'cloudy-afternoon') {\n      light1.setAttribute('light', 'intensity', 2);\n      light2.setAttribute('light', 'intensity', 0.6);\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute(\n        'src',\n        `url(${assetsPathRoot}images/skies/2048-mud_road_puresky-sdr.jpeg)`\n      );\n      sky.setAttribute('rotation', '0 0 0');\n    } else if (this.data.preset === 'sunny-afternoon') {\n      light1.setAttribute('light', 'intensity', 2);\n      light2.setAttribute(\n        'light',\n        'intensity: 2.2; castShadow: true; shadowCameraBottom: -20; shadowCameraLeft: -30; shadowCameraRight: 40; shadowCameraTop: 30; shadowMapHeight: 2048; shadowMapWidth: 2048'\n      );\n      light2.setAttribute('position', '60 56 -16');\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute(\n        'src',\n        `url(${assetsPathRoot}images/skies/2048-kloofendal_43d_clear_puresky-sdr.jpeg)`\n      );\n      sky.setAttribute('rotation', '0 0 0');\n    } else if (this.data.preset === 'sunny-noon') {\n      light1.setAttribute('light', 'intensity', 2);\n      light2.setAttribute(\n        'light',\n        'intensity: 2.2; castShadow: true; shadowCameraBottom: -20; shadowCameraLeft: -30; shadowCameraRight: 40; shadowCameraTop: 30; shadowMapHeight: 2048; shadowMapWidth: 2048'\n      );\n      light2.setAttribute('position', '5 56 -16');\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute(\n        'src',\n        `url(${assetsPathRoot}images/skies/2048-kloppenheim_05_puresky-sdr.jpeg)`\n      );\n      sky.setAttribute('rotation', '0 0 0');\n    } else if (this.data.preset === 'foggy') {\n      light1.setAttribute('light', 'intensity', 2);\n      light2.setAttribute('light', 'intensity: 0.6; castShadow: false;');\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute(\n        'src',\n        `url(${assetsPathRoot}images/skies/2048-kloofendal_misty_morning_puresky-sdr.jpeg)`\n      );\n      sky.setAttribute('rotation', '0 0 0');\n    } else if (this.data.preset === 'cloudy') {\n      light1.setAttribute('light', 'intensity', 2);\n      light2.setAttribute('light', 'intensity', 0.6);\n      sky.setAttribute('visible', true);\n      sky.setAttribute('color', '#FFF');\n      sky.setAttribute(\n        'src',\n        `url(${assetsPathRoot}images/skies/2048-kloofendal_48d_partly_cloudy_puresky-sdr.jpeg)`\n      );\n      sky.setAttribute('rotation', '0 0 0');\n    } else {\n      // color\n      sky.setAttribute('visible', false);\n      this.scene.setAttribute('background', 'color', this.data.backgroundColor);\n    }\n  },\n  init: function () {\n    const el = this.el;\n    this.scene = document.querySelector('a-scene');\n    this.light1 = document.createElement('a-entity');\n    const light1 = this.light1;\n    light1.setAttribute('id', 'env-light1');\n    light1.setAttribute('light', { type: 'ambient', color: '#FFF' });\n    el.appendChild(light1);\n\n    this.light2 = document.createElement('a-entity');\n    const light2 = this.light2;\n    light2.setAttribute('id', 'env-light2');\n    light2.setAttribute('position', '-60 56 -16');\n    light2.setAttribute(\n      'light',\n      'intensity: 2.2; castShadow: true; shadowCameraBottom: -20; shadowCameraLeft: -30; shadowCameraRight: 40; shadowCameraTop: 30; shadowMapHeight: 2048; shadowMapWidth: 2048'\n    );\n    el.appendChild(light2);\n\n    this.sky = document.createElement('a-sky');\n    const sky = this.sky;\n    sky.setAttribute('id', 'env-sky');\n    sky.setAttribute('data-ignore-raycaster', '');\n    el.appendChild(sky);\n  },\n  update: function (oldData) {\n    this.setEnvOption();\n  }\n});\n\n// Vehicle wheel Animation\nAFRAME.registerComponent('wheel', {\n  schema: {\n    speed: { type: 'number', default: 1 },\n    wheelDiameter: { type: 'number', default: 1 }\n  },\n\n  init: function () {\n    const el = this.el;\n    const self = this;\n    el.addEventListener('model-loaded', (e) => {\n      const vehicle = el.getObject3D('mesh');\n      if (!vehicle) {\n        return;\n      }\n\n      self.wheel_F_L = vehicle.getObjectByName('wheel_F_L');\n      self.wheel_F_R = vehicle.getObjectByName('wheel_F_R');\n      self.wheel_B_L = vehicle.getObjectByName('wheel_B_L');\n      self.wheel_B_R = vehicle.getObjectByName('wheel_B_R');\n\n      // For Truck extra Wheels\n      self.wheel_B_L_2 = vehicle.getObjectByName('wheel_B_L_2');\n      self.wheel_B_R_2 = vehicle.getObjectByName('wheel_B_R_2');\n    });\n  },\n  tick: function (t, dt) {\n    const speed = this.data.speed / 1000;\n    const wheelDiameter = this.data.wheelDiameter;\n\n    const rateOfRotation = 2 * (speed / wheelDiameter) * dt;\n\n    if (this.wheel_F_L) {\n      this.wheel_F_L.rotateY(rateOfRotation);\n    }\n    if (this.wheel_F_R) {\n      this.wheel_F_R.rotateY(rateOfRotation);\n    }\n    if (this.wheel_B_L) {\n      this.wheel_B_L.rotateY(rateOfRotation);\n    }\n\n    if (this.wheel_B_L_2) {\n      this.wheel_B_L_2.rotateY(rateOfRotation);\n    }\n\n    if (this.wheel_B_R_2) {\n      this.wheel_B_R_2.rotateY(rateOfRotation);\n    }\n    if (this.wheel_B_R) {\n      this.wheel_B_R.rotateY(rateOfRotation);\n    }\n  }\n});\n"],"names":["root","factory","exports","module","define","amd","a","i","self","uvs","THREE","Vector2","getGridUvs","row","column","totalRows","totalColumns","columnWidth","rowHeight","set","AFRAME","registerComponent","dependencies","schema","type","default","update","data","this","geometry","el","getObject3D","float32Array","Float32Array","x","y","setAttribute","BufferAttribute","uvsNeedUpdate","canvasId","canvasHeight","canvasWidth","debug","numColumns","numRows","multiple","init","canvas","document","createElement","id","height","width","ctx","getContext","body","appendChild","style","left","top","position","zIndex","drawTexture","image","complete","onload","gridHeight","gridWidth","drawImage","streetmixParsersTested","require","segmentVariants","cloneMixinAsChildren","_ref","_ref$objectMixinId","objectMixinId","_ref$parentEl","parentEl","_ref$step","step","_ref$radius","radius","_ref$rotation","rotation","_ref$positionXYString","positionXYString","_ref$length","length","undefined","_ref$randomY","randomY","j","placedObjectEl","addEventListener","evt","target","Math","floor","random","append","createStencilsParentElement","createRailsElement","railsPosX","railsGeometry","primitive","depth","color","metalness","emissive","emissiveIntensity","roughness","createTracksParentElement","tram","trolley","createParentElement","className","createDividerVariant","variantName","clonedObjectRadius","arguments","dividerParentEl","concat","createClonedVariants","getRandomIntInclusive","min","max","ceil","getRandomArbitrary","getZPositions","start","end","len","Array","fill","map","_","idx","sort","createSidewalkClonedVariants","segmentWidthInMeters","density","elevationPosY","streetLength","direction","animated","xValueRange","zValueRange","totalPedestrianNumber","parseInt","empty","sparse","normal","dense","String","xVal","zVal","pop","animationDirection","z","addLinearStreetAnimation","getBusLaneMixin","variant","randomPosition","entity","axis","object3d","box","objectLength","objSizeAttr","newObject","object3D","_getStartEndPosition","Box3","setFromObject","setFunc","toUpperCase","newPosition","createChooChooElement","variantList","showVehicles","rotationY","positionZ","createBusElement","busParentEl","busObjectEl","reusableObjectEl","speed","xPos","yVal","zPos","totalStreetDuration","halfStreet","startingDuration","abs","animationAttrs1","property","easing","loop","from","to","dur","animationAttrs2","delay","createDriveLaneElement","count","carStep","_variantList","lineVariant","carType","rotationVariants","inbound","outbound","sideways","right","driveLaneParentEl","carParams","car","mixin","wheelDiameter","microvan","truck","av","halfParkingLength","randPlaces","slice","carSizeZ","includes","carSizeValueZ","forEach","randPositionZ","maxDist","randOffset","createCar","params","createFoodTruckElement","foodTruckParentEl","createMagicCarpetElement","magicCarpetParentEl","reusableObjectEl1","reusableObjectEl2","randPlacedElements","objLength","placeLength","createOutdoorDining","posY","outdoorDiningParentEl","randPosZ","createMicroMobilityElement","segmentType","microMobilityParentEl","bikeCount","cyclistMixins","countCyclist","mixinId","createFlexZoneElement","flexZoneParentEl","createBenchesParentElement","createBikeRacksParentElement","createBikeShareStationElement","rotationCloneY","createParkletElement","parkletParent","createTreesParentElement","createLampsParentElement","createBusStopElement","rotationBusStopY","createBrtStationElement","createSegmentElement","positionY","repeatCount","elevation","segmentEl","createSeparatorElement","scalePlane","supportCheck","segmentVariantString","supportedVariants","STREET","notify","warningMessage","console","log","processSegments","segments","showStriping","globalAnimated","isLaneIsh","typeString","reduce","newArray","currentValue","currentIndex","arr","previousValue","variantString","split","push","insertSeparatorSegments","streetParentEl","streetEl","offset","streetWidth","segmentData","createCenteredStreetElement","classList","add","wayfindingParentEl","cumulativeWidthInMeters","segmentParentEl","segmentPositionX","isOutbound","groundMixinId","stencilsParentEl","tracksParentEl","markerMixinId","replace","m","mixinString","safehitsParentEl","treesParentEl","reusableObjectStencilsParentEl","isAnimated","benchesParentEl","bikeRacksParentEl","utilityPoleElems","lampsParentEl","parkingMixin","markingsRotZ","markingLength","markingPosX","markingPosXY","clonedStencilRadius","isSidewalk","dirtBox","processBuildings","showGround","buildingElement","index","groundParentEl","side","sideMultiplier","groundPositionX","buildingPositionX","segmentsHeight","segmentsDepth","segmentsWidth","grass","fence","residential","narrow","wide","arcade","buildingPos","newBuildings","buildingType","buildingsArray","createBuildingsArray","buildingJSONString","JSON","stringify","createBuilding","objectPositionX","StreetAssets","_AFRAME$ANode","_this","_classCallCheck","_callSuper","isAssetItem","_inherits","ANode","key","value","categories","getAttribute","assetUrl","assetsHTML","surfacesRoughness","assetsObj","people","vehicles","buildings","stencils","dividers","sky","grounds","addCategoryNamesToMixins","html","categoryName","doc","DOMParser","parseFromString","querySelectorAll","mixinNode","documentElement","innerHTML","existsCategoryArray","Object","keys","categoryAttrArray","filter","buildAssetHTML","insertAdjacentHTML","prototype","load","call","customElements","domModifiedHandler","nodeName","assets","querySelector","removeEventListener","streetAssets","createFromJSONUtilsTested","jsonString","oldData","string","firstChild","removeChild","lastChild","appendChildElementsFromArray","parse","LOADING_MODELS","MODELS","buffer","part","src","dracoLoader","systems","getDRACOLoader","getModel","modelPart","setObject3D","cb","then","model","selectFromModel","Promise","resolve","loader","GLTFLoader","setDRACOLoader","gltfModel","scene","scenes","error","mesh","getObjectByName","getObjectByProperty","clone","toNonIndexed","Geometry","fromBufferGeometry","Notyf","duration","ripple","dismissible","message","types","background","icon","options","messType","successMessage","messageText","errorMessage","messageType","open","newMessage","tick","t","components","material","normalMap","sin","cos","normalScale","amplitude","amplitudeVariance","speedVariance","play","children","waves","posAttribute","getZ","ang","PI","amp","dt","vprops","setZ","needsUpdate","registerPrimitive","defaultComponents","shader","normalTextureRepeat","normalTextureOffset","opacity","getY","setY","_regeneratorRuntime","e","r","n","hasOwnProperty","o","defineProperty","Symbol","iterator","c","asyncIterator","u","toStringTag","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","arg","h","l","f","s","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","_invoke","AsyncIterator","invoke","_typeof","__await","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","reverse","prev","charAt","stop","rval","handle","finish","delegateYield","asyncGeneratorStep","gen","reject","_next","_throw","info","_asyncToGenerator","fn","args","apply","err","_takeScreenshotNow","takeScreenshot","filename","imgElementSelector","takeScreenshotNow","_callee3","imgElement","inspector","renderer","toggleHelpers","createCanvasWithScreenshot","addTitleToCanvas","addLogoToCanvas","downloadImageDataURL","saveFilename","screenshotCanvas","_context3","dataURL","scnrenshotCanvas","element","url","display","click","screenWidth","screenHeight","font","textAlign","fillStyle","fillText","utils","getCurrentSceneTitle","show","opened","sceneHelpers","visible","removeAttribute","INSPECTOR","_callee","aframeCanvas","ctxScreenshot","_context","hidden","_x4","_ref2","_callee2","logoImg","logoSVG","_context2","Image","window","btoa","outerHTML","_x5","render","camera","domElement","toDataURL","_x","_x2","_x3","longitude","latitude","maps","mapTypes","elevationHeightConstant","_step","updatedData","diff","_iterator","_createForOfIteratorHelper","mapType","createMapFunction","bind","mapbox2dCreate","mapbox2dElement","accessToken","center","zoom","pxToWorldRatio","google3dCreate","google3dElement","long","lat","googleApiKey","geoTransform","maximumSSE","maximumMem","cameraEl","google3dUpdate","google3d","mapbox2dUpdate","mapbox2d","streetplanUtils","streetplanStreetURL","streetplanAPIURL","streetplanEncJSON","showBuildings","streetplanResponseParse","streetplanResponseObject","currentSceneTitle","streetplanProject","project","streetData","convertStreetStruct","streetplanSegments","streetplanName","sceneEl","sceneTitle","rightBuildingVariant","leftBuildingVariant","streetmixSegmentsMetric","emit","that","streetplanJSON","decodeURIComponent","request","XMLHttpRequest","status","response","onerror","send","SVGLoader","svgString","bevelEnabled","bevelThickness","bevelSize","bevelOffset","bevelSegments","topElement","topColor","topSrc","lineColor","createTopEntity","topGeometryArray","mergedGeometry","mergedGeometryFromArray","translate","mergedShapeMesh","Mesh","materialFromSrc","removeObject3D","imgSrc","texture","textureImg","Texture","encoding","sRGBEncoding","wrapS","RepeatWrapping","wrapT","repeat","MeshStandardMaterial","geometryArray","BufferGeometryUtils","mergeGeometries","computeBoundingBox","computeVertexNormals","rotateX","scale","extrudeFromSVG","svgData","extrudeSettings","extrudedGeometryArray","paths","path","createShapes","shape","topGeometry","ExtrudeGeometry","stokeMaterial","LineBasicMaterial","linesGeometry","EdgesGeometry","lines","LineSegments","mergedMesh","assetsUrl","getElementData","isEntity","elementTree","elemObj","tagName","toLowerCase","entityComponents","geometryAttr","componentName","modifiedProperty","getModifiedProperty","isEmpty","toPropString","getAttributes","childNodes","child","nodeType","Node","ELEMENT_NODE","propData","isArray","toString","isVector3","isVector2","isVector4","coordinates","entries","_slicedToArray","join","object","getCurrentSceneId","match","currentSceneId","sceneId","urlSceneId","location","hash","convertDOMElToObject","sceneEntities","_i","_sceneEntities","entityData","title","version","removeProps","street","renameProps","intersection","shallowEqual","object1","object2","keys1","keys2","_i3","_keys","getComponentProperty","defaultData","_getMixedValue2","component","propertyName","source","reversedMixins","mixinEls","attributes","getMixedValue","mixinCompName","mixinsData","isSingleProperty","defaultValue","deepEqual","createEntities","entitiesData","_step2","sceneElement","removeEntities","_iterator2","sceneChildElement","getElementById","remove","entityElement","createEntityFromObj","_entity$classList","_i4","_arr","attr","_step3","_iterator3","createElementsFromJSON","streetJSON","streetObject","validJSONString","streetContainerEl","filterJSONstreet","removeValueCheck","removeVal","stringJSON","compAttributes","removeKey","styleParser","_i2","_attrNames","attrName","attrVal","renameKey","reKey","RegExp","replaceAll","titleText","titleElement","detail","createTitleElement","titleDiv","newContent","createTextNode","updateTitleText","textContent","defaultURL","runOnce","streetURL","substring","fetchJSON","requestURL","jsonData","inputStreetmix","streetmixURL","prompt","setTimeout","fileJSON","reader","FileReader","result","readAsText","files","_THREE","Box2","BufferGeometry","FileLoader","Float32BufferAttribute","Loader","Matrix3","Path","Shape","ShapePath","ShapeUtils","SRGBColorSpace","Vector3","COLOR_SPACE_SVG","_Loader","manager","defaultDPI","defaultUnit","shapePath","BIGNUMBER","IntersectionLocationType","ORIGIN","DESTINATION","BETWEEN","LEFT","RIGHT","BEHIND","BEYOND","classifyResult","loc","findEdgeIntersection","a0","a1","b0","b1","x1","x2","x3","x4","y1","y2","y3","y4","nom1","denom","t1","t2","classifyPoint","point","toPrecision","edgeStart","edgeEnd","ax","ay","bx","by","sa","Number","EPSILON","sqrt","scanlineMinX","scanlineMaxX","simplePaths","subPaths","points","getPoints","maxY","minY","maxX","minX","curves","isCW","isClockWise","identifier","boundingBox","sp","isAHole","simplePath","allPaths","_fillRule","centerBoundingBox","getCenter","scanlineIntersections","scanline","allIntersections","containsPoint","path1","path2","intersectionsRaw","intersections","path1EdgeStart","path1EdgeEnd","_loop","path2EdgeStart","index2","path2EdgeEnd","find","getIntersections","i1","i2","getScanlineIntersections","baseIntersections","otherIntersections","firstXOfPath","stack","isHole","isHoleFor","for","lastCWValue","warn","isHoleTo","userData","fillRule","shapesToReturn","hole","holes","lineJoin","lineCap","miterLimit","strokeColor","strokeWidth","strokeLineJoin","strokeLineCap","strokeMiterLimit","arcDivisions","minDistance","vertices","normals","pointsToStrokeWithBuffers","vertexOffset","tempV2_1","tempV2_2","tempV2_3","tempV2_4","tempV2_5","tempV2_6","tempV2_7","lastPointL","lastPointR","point0L","point0R","currentPointL","currentPointR","nextPointL","nextPointR","innerPoint","outerPoint","numPoints","dupPoints","distanceTo","newPoints","removeDuplicatedPoints","currentPoint","nextPoint","u1","innerSideModified","joinIsOnLeftSide","isMiter","isClosed","equals","previousPoint","strokeWidth2","deltaU","u0","initialJoinIsOnLeftSide","numVertices","currentCoordinate","currentCoordinateUV","getNormal","multiplyScalar","copy","sub","iPoint","normal1","subVectors","dot","normalize","miterSide","setLength","negate","miterLength2","segmentLengthPrev","divideScalar","segmentLengthNext","makeSegmentTriangles","makeSegmentWithBevelJoin","createSegmentTrianglesWithMiddleSection","makeCircularSector","miterFraction","addVertex","addCapGeometry","lastOuter","lastInner","toArray","p1","p2","angle","acos","il","rotateAround","addVectors","vl","onLoad","onProgress","onError","scope","setPath","setRequestHeader","requestHeader","setWithCredentials","withCredentials","text","itemError","parseArcCommand","rx","ry","x_axis_rotation","large_arc_flag","sweep_flag","dx2","dy2","x1p","y1p","rxs","rys","x1ps","y1ps","cr","dq","pq","q","cxp","cyp","cx","cy","theta","svgAngle","delta","currentPath","absellipse","lineTo","ux","uy","vx","vy","parseStyle","node","assign","stylesheetStyles","hasAttribute","classSelectors","Boolean","trim","stylesheets","addStyle","svgName","jsName","adjustFunction","startsWith","clamp","parseFloatWithUnits","positive","getReflection","b","parseFloats","input","flags","stride","current","RE","SEPARATOR","WHITESPACE","DIGIT","SIGN","POINT","COMMA","EXP","FLAGS","state","seenComma","number","exponent","throwSyntaxError","partial","SyntaxError","newNumber","pow","test","units","unitConversion","theUnit","endsWith","parseFloat","isTransformFlipped","te","elements","isTransformSkewed","basisDot","sx","getTransformScaleX","sy","getTransformScaleY","transformStack","tempTransform0","tempTransform1","tempTransform2","tempTransform3","tempV2","tempV3","currentTransform","xml","parseNode","transform","tx","ty","transformsTexts","tIndex","transformText","openParPos","indexOf","closeParPos","transformType","array","identity","makeTranslation","makeRotation","multiplyMatrices","scaleX","scaleY","tan","premultiply","parseNodeTransform","getNodeTransform","isDefsNode","sheet","cssRules","stylesheet","selectorList","selectorText","definitions","fromEntries","parseCSSStylesheet","control","firstPoint","isFirstPoint","doSetFirstPoint","commands","command","numbers","jl","moveTo","bezierCurveTo","quadraticCurveTo","autoClose","parsePathNode","w","bci","parseRectNode","parsePolygonNode","parsePolylineNode","subpath","absarc","parseCircleNode","parseEllipseNode","parseLineNode","usedNodeId","getAttributeNS","usedNode","viewportElement","setStyle","transfVec2","v2","applyMatrix3","transfEllipseGeneric","curve","A","B","C","rt1","rt2","cs","sn","sm","df","rt","xRadius","yRadius","cosTheta","aRotation","sinTheta","v1","f1","f2","mF","mFInv","invert","mQe","transpose","multiply","ed","rt1sqrt","rt2sqrt","atan2","aEndAngle","aStartAngle","mDsqrt","mRT","mDRF","transformAngle","phi","_Vector3$applyMatrix","cosR","sinR","aClockwise","transfEllipseNoSkew","isLineCurve","isCubicBezierCurve","v0","v3","isQuadraticBezierCurve","isEllipseCurve","aX","aY","transformPath","fillOpacity","strokeOpacity","get","__esModule","cameraHead","cameraRig","collisionEntities","ignoreEntities","landingMaxAngle","landingNormal","transitionSpeed","mobile","device","isMobile","traverse","Camera","cam","camRig","rayCaster","Raycaster","referenceNormal","rayCastObjects","RingGeometry","MeshBasicMaterial","CylinderGeometry","TextureLoader","transparent","depthTest","Group","teleportIndicator","transitioning","transitionProgress","transitionCamPosStart","transitionCamPosEnd","updateRaycastObjects","getMouseState","getTeleportPosition","isValidNormalsAngle","transition","mouseMove","mouseDown","mouseUp","easeInOutQuad","dispose","collisionMesh","pause","_this2","isMesh","collision","PlaneGeometry","MeshNormalMaterial","getBoundingClientRect","clientX","clientY","touches","bottom","setFromCamera","intersectObjects","face","angleTo","MathUtils","RAD2DEG","mouseX","mouseY","mouseXOrig","mouseYOrig","LoopMode","once","LoopOnce","LoopRepeat","pingpong","LoopPingPong","regExpEscape","clip","clampWhenFinished","crossFadeDuration","oneOf","repetitions","Infinity","timeScale","startAt","mixer","activeActions","AnimationMixer","action","loopDelta","stopAllAction","prevData","changes","stopAction","playAction","setDuration","setLoop","setEffectiveTimeScale","fadeOut","clips","animations","re","clipAction","enabled","time","fadeIn","__assign","NotyfNotification","listeners","on","triggerEvent","event","NotyfArrayEvent","Add","Remove","NotyfArray","notifications","updateFn","splice","onUpdate","Dismiss","Click","NotyfEvent","DEFAULT_OPTIONS","backgroundColor","NotyfView","events","X_POSITION_FLEX_MAP","Y_POSITION_FLEX_MAP","createDocumentFragment","_createHTMLElement","container","animationEndEventName","_getAnimationEndEventName","_createA11yContainer","addNotification","removeNotification","_popRenderedNotification","_renderNotification","notification","_announce","_buildNotificationCard","getXPosition","getYPosition","adjustContainerAlignment","setProperty","valueOf","stopPropagation","N","border","margin","overflow","padding","outline","a11yContainer","MozTransition","OTransition","WebkitTransition","dismiss","_removeNotification","view","registerTypes","normalizeOptions","success","assignProps","_pushNotification","dismissAll","sidewalk","utilities","parklet","bikeshare","scooter","streetcar","divider","temporary","mapping","Setback","Trees","tree","Benchs","variantStringAdd","Walkways","pedestrian","Tables","Furniture","season_tree","Shelters","Pedestrian","Curbside","Lights","tagToVariantMap","Poles","BikeRacks","nameToVariantMap","Sideview","BikesPaths","Bikes","Gutter","Transit","tag","names","Cars","Autos","Truck","Parking","Parallel","AngleNormal","Perpendicular","Buffers","median","planter","directionMap","Coming","Going","Both","NA","materialMap","Grass","generateVariantString","variantStringKeys","streetmixData","currKey","convertSegment","streetplanType","streetplanSubtype","subtypeMap","convertRule","streetplanData","variantData","tagValMatches","getDataFromSubtypeMap","mappingUtils","streetProject","newStruct","streetplanAltName","altName","psuedoRandom","maxLength","building","buildingEntity","class","filterBuildingsArrayByMixin","filteredBuildingsArray","currentEntity","removePropertyFromArray","htmlArray","createClonedEntitiesArray","_ref$mixin","clonedEntitiesArray","clonedEntity","randomTestable","getAmbientSoundJSON","ambientSounds","waterfront","soundsArray","prevURL","soundEntity","sound","createElementFromObject","_Object$entries","_Object$entries$_i","childEl","_Object$entries2","_Object$entries2$_i","childKey","childValue","streetmixUserToAPI","userURL","pathArray","URL","pathname","creatorId","namespacedId","pathStartsWithAPI","urlString","href","streetmixAPIToUser","APIURL","getQueryVariable","queryString","variable","vars","pair","search","convertStreetValues","schemaVersion","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","nmd","VERSION","streetmixParsers","streetmixUtils","streetmixSegments","streetParent","buildingParent","buildingsEl","streetmixStreetURL","streetmixAPIURL","streetmixResponseObject","streetmixName","dimensions","northeastcurb","southwestcurb","southeastcurb","northwestcurb","stopsign","trafficsignal","crosswalk","dimensionsArray","positionArray","sidewalkArray","northeastcurbArray","southwestcurbArray","southeastcurbArray","northwestcurbArray","stopsignArray","trafficsignalArray","crosswalklArray","intersectWidth","intersectDepth","createSidewalkElem","positionVec","_ref$scaleVec","scaleVec","rotationVec","sd","repeatCountInter","sidewalkParams","west","east","north","south","ind","sidewalkName","curbParams","northeast","southwest","southeast","northwest","curbName","ss1","ss2","ss3","ss4","ts1","ts2","ts3","ts4","ts5","ts6","ts7","ts8","cw1","cw2","cw3","cw4","preset","setEnvOption","light1","light2","assetsPathRoot","vehicle","wheel_F_L","wheel_F_R","wheel_B_L","wheel_B_R","wheel_B_L_2","wheel_B_R_2","rateOfRotation","rotateY"],"sourceRoot":""}