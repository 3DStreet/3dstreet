!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var r in i)("object"==typeof exports?exports:t)[r]=i[r]}}(self,(function(){return t={631:t=>{var e=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];function i(t,i,r,a){const n=1/a,s=1/r;return e[0].set(n*i,s*t+s),e[1].set(n*i,s*t),e[2].set(n*i+n,s*t),e[3].set(n*i+n,s*t+s),e}AFRAME.registerComponent("atlas-uvs",{dependencies:["geometry"],schema:{totalColumns:{type:"int",default:1},totalRows:{type:"int",default:1},column:{type:"int",default:1},row:{type:"int",default:1}},update:function(){const t=this.data,e=i(t.row-1,t.column-1,t.totalRows,t.totalColumns),r=this.el.getObject3D("mesh").geometry;var a=new Float32Array([e[0].x,e[0].y,e[3].x,e[3].y,e[1].x,e[1].y,e[2].x,e[2].y]);r.setAttribute("uv",new THREE.BufferAttribute(a,2)),r.uvsNeedUpdate=!0}}),AFRAME.registerComponent("dynamic-texture-atlas",{schema:{canvasId:{default:"dynamicAtlas"},canvasHeight:{default:1024},canvasWidth:{default:1024},debug:{default:!1},numColumns:{default:8},numRows:{default:8}},multiple:!0,init:function(){const t=this.canvas=document.createElement("canvas");t.id=this.data.canvasId,t.height=this.data.canvasHeight,t.width=this.data.canvasWidth,this.ctx=t.getContext("2d"),document.body.appendChild(t),this.data.debug&&(t.style.left=0,t.style.top=0,t.style.position="fixed",t.style.zIndex=9999999999)},drawTexture:function(t,e,r,a,n){const s=this.canvas,o=this.data;t.complete||(t.onload=()=>{this.drawTexture(t,e,r)});const l=n||s.height/o.numRows,d=a||s.width/o.numColumns;return this.ctx.drawImage(t,d*e,d*r,d,l),i(e,r,o.numRows,o.numColumns)}}),t.exports.getGridUvs=i},844:(t,e,i)=>{var r=i(199),a=i(394),n={"bike-lane":1.8,"drive-lane":3,divider:.3,"parking-lane":3,sidewalk:3,"sidewalk-tree":3,"turn-lane":3,"bus-lane":3,"light-rail":3,streetcar:3,"sidewalk-wayfinding":3,"sidewalk-lamp":3,"sidewalk-bike-rack":3,"sidewalk-bench":3,"scooter-drop-zone":3,scooter:1.8,bikeshare:3,"flex-zone-curb":3,"transit-shelter":3,temporary:3,"food-truck":3,"flex-zone":3,"outdoor-dining":3,parklet:3,utilities:3};function s(t){for(var e=t.objectMixinId,i=void 0===e?"":e,r=t.parentEl,a=void 0===r?null:r,n=t.step,s=void 0===n?15:n,o=t.radius,l=void 0===o?60:o,d=t.rotation,c=void 0===d?"0 0 0":d,m=t.positionXYString,p=void 0===m?"0 0":m,u=t.randomY,f=void 0!==u&&u,h=-1*l;h<=l;h+=s){var x=document.createElement("a-entity");x.setAttribute("class",i),x.setAttribute("position",p+" "+h),x.setAttribute("mixin",i),f?x.setAttribute("rotation","0 "+Math.floor(361*Math.random())+" 0"):x.setAttribute("rotation",c),a.append(x)}}function o(t){var e=document.createElement("a-entity");return e.setAttribute("class","stencils-parent"),e.setAttribute("position",t),e}function l(t){var e=document.createElement("a-entity");return e.setAttribute("class","track-parent"),e.setAttribute("position",t+" -0.2 0"),e}function d(t){var e=document.createElement("a-entity");return e.setAttribute("class","safehit-parent"),e.setAttribute("position",t+" 0 0"),e}function c(t,e){var i=document.createElement("a-entity");return i.setAttribute("class",e),i.setAttribute("position",t+" 0 0"),i}function m(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2.25,a=c(e,"dividers-".concat(t,"-parent"));return s({objectMixinId:"dividers-".concat(t),parentEl:a,step:r,radius:i}),a}function p(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2.25,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0 0 0",n=c(e,"".concat(t,"-parent"));return s({objectMixinId:t,parentEl:n,step:r,radius:i,rotation:a}),n}function u(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1)+t)}function f(t,e){return Math.random()*(e-t)+t}function h(t,e,i){var r=Math.floor((e-t)/i)+1;return Array(r).fill().map((function(e,r){return t+r*i})).sort((function(){return.5-Math.random()}))}function x(t,e,i,r){var a,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"random",s=[-.37*e,.37*e],o=h(-.5*r,.5*r,1.5);a="sparse"===i?parseInt(.0625*r,10):"normal"===i?parseInt(.125*r,10):parseInt(.25*r,10);for(var l=c(t,"pedestrians-parent"),d=0;d<a;d++){var m="char"+String(u(1,16)),p=f(s[0],s[1])+" 0 "+o.pop(),x=document.createElement("a-entity");x.setAttribute("position",p),x.setAttribute("mixin",m),(Math.random()<.5&&"random"===n||"outbound"===n)&&x.setAttribute("rotation","0 180 0"),l.append(x)}return l}function g(t){return"colored"===t?"surface-red bus-lane":"grass"===t?"surface-green bus-lane":"bus-lane"}function b(t,e,i){var r="inbound"===t[0]?0:180,a=document.createElement("a-entity");return a.setAttribute("class",e),a.setAttribute("position",i+" 0 0"),a.setAttribute("rotation","0 "+r+" 0"),a.setAttribute("mixin",e),a}function y(t,e){var i=document.createElement("a-entity"),r=90*t,a=document.createElement("a-entity");return a.setAttribute("position",e+" 1.4 0"),a.setAttribute("rotation","0 "+r+" 0"),a.setAttribute("mixin","bus"),i.append(a),i}function v(t,e,i,r){var a=document.createElement("a-entity"),n=document.createElement("a-entity"),s="inbound"===t[0]?0:180;if(n.setAttribute("position",e+" 0 0"),n.setAttribute("rotation","0 "+s+" 0"),"car"===t[1])n.setAttribute("mixin","sedan");else if("microvan"===t[1])n.setAttribute("mixin","suv");else if("truck"===t[1])n.setAttribute("mixin","box-truck");else if("pedestrian"===t[1])return x(e,i,"normal",r,t[0]);return a.append(n),a}function w(t,e){var i=document.createElement("a-entity"),r=document.createElement("a-entity"),a="left"===t[0]?0:180;return r.setAttribute("position",e+" 0 0"),r.setAttribute("rotation","0 "+a+" 0"),r.setAttribute("mixin","food-trailer"),i.append(r),i}function A(t){var e=document.createElement("a-entity"),i=document.createElement("a-entity");return i.setAttribute("position",t+" 0 0"),i.setAttribute("mixin","outdoor_dining"),e.append(i),e}function _(t,e,i){var r=document.createElement("a-entity"),a=document.createElement("a-entity"),n="inbound"===t[0]?0:180;return a.setAttribute("position",e+" 0 0"),a.setAttribute("rotation","0 "+n+" 0"),"bike-lane"===i?a.setAttribute("mixin","Bicycle_1"):a.setAttribute("mixin","ElectricScooter_1"),r.append(a),r}function E(t,e){var i=document.createElement("a-entity"),r=document.createElement("a-entity"),a="inbound"===t[1]?0:180;return r.setAttribute("position",e+" 0 0"),r.setAttribute("rotation","0 "+a+" 0"),"taxi"===t[0]?r.setAttribute("mixin","sedan-taxi"):"rideshare"===t[0]&&r.setAttribute("mixin","sedan"),i.append(r),i}function M(t){var e,i=document.createElement("a-entity");return(e=document.createElement("a-entity")).setAttribute("position",t+" 1 0"),e.setAttribute("mixin","wayfinding-box"),i.append(e),(e=document.createElement("a-entity")).setAttribute("position",t+" 1.2 0.06"),e.setAttribute("geometry","primitive: plane; width: 0.8; height: 1.6"),e.setAttribute("material","src:#wayfinding-map"),i.append(e),(e=document.createElement("a-entity")).setAttribute("position",t+" 1.2 -0.06"),e.setAttribute("rotation","0 180 0"),e.setAttribute("geometry","primitive: plane; width: 0.8; height: 1.6"),e.setAttribute("material","src:#wayfinding-map"),i.append(e),i}function S(t){var e=document.createElement("a-entity");return e.setAttribute("class","bench-parent"),e.setAttribute("position",t+" 0 3.5"),e}function k(t){var e=document.createElement("a-entity");return e.setAttribute("class","bikerack-parent"),e.setAttribute("position",t+" 0 -3.5"),e}function j(t,e){var i=document.createElement("a-entity");i.setAttribute("class","bikeshare"),i.setAttribute("position",t+" 0 0"),i.setAttribute("mixin","bikeshare");var r="left"===e[0]?90:270;return i.setAttribute("rotation","0 "+r+" 0"),i}function C(t,e){var i=document.createElement("a-entity");i.setAttribute("class","parklet"),i.setAttribute("position",t+" .02 0"),i.setAttribute("mixin","parklet");var r="left"===e[0]?90:270;return i.setAttribute("rotation","0 "+r+" 0"),i}function R(t){var e=document.createElement("a-entity");return e.setAttribute("class","tree-parent"),e.setAttribute("position",t+" 0 7"),e}function I(t){var e=document.createElement("a-entity");return e.setAttribute("class","lamp-parent"),e.setAttribute("position",t+" 0 0"),e}function L(t,e,i){var r=document.createElement("a-entity");return r.setAttribute("class","bus-stop"),r.setAttribute("position",t+.75*e+" 0 0"),r.setAttribute("rotation","-90 "+i+" 0"),r.setAttribute("mixin","bus-stop"),r}function P(t,e,i,r,a,n){var s=document.createElement("a-entity"),o=t+" "+n/150+" 1";return s.setAttribute("scale",o),s.setAttribute("position",e+" "+i+" 0"),s.setAttribute("rotation","270 "+r+" 0"),s.setAttribute("mixin",a),s}t.exports.processSegments=function(t,e,i){var c=i/2;i>12&&(c=(i-12)/2),e&&(t=function(t){function e(t){return"lane"===t.slice(t.length-4)||"light-rail"===t||"streetcar"===t}return t.reduce((function(t,i,r,a){if(0===r)return t.concat(i);var n=a[r-1];if(e(i.type)&&e(n.type)){var s="solid";i.type===n.type&&(s="dashed"),("drive-lane"===i.type&&"turn-lane"===n.type||"drive-lane"===n.type&&"turn-lane"===i.type)&&(s="dashed"),i.variantString.split("|")[0]!==n.variantString.split("|")[0]&&(s="doubleyellow","bike-lane"===i.type&&"bike-lane"===n.type&&(s="shortdashedyellow")),"turn-lane"===i.type&&"shared"===i.variantString.split("|")[1]?s="soliddashedyellow":"turn-lane"===n.type&&"shared"===n.variantString.split("|")[1]&&(s="soliddashedyellowinverted"),t.push({type:"separator",variantString:s,width:0})}return(e(i.type)&&"divider"===n.type||e(n.type)&&"divider"===i.type)&&t.push({type:"separator",variantString:"solid",width:0}),t.push(i),t}),[])}(t));var u=function(t){var e=document.createElement("a-entity"),i=0-a.calcStreetWidth(t)/2;return e.setAttribute("position",i+" 0 0"),e}(t);u.classList.add("street-parent");for(var f,h=0,B=0;B<t.length;B++){var D=document.createElement("a-entity");D.classList.add("segment-parent-"+B);var O=t[B].type,T=.3048*t[B].width,F=T/n[O],N=(h+=T)-.5*T,H=0,U=t[B].variantString.split("|"),z="inbound"===U[0]?180:0,J="outbound"===U[0]?1:-1,G=t[B].type;if("drive-lane"===t[B].type&&"sharrow"===U[1]){var Y=o(N+" 0.015 0");s({objectMixinId:"stencils sharrow",parentEl:Y,rotation:"-90 "+z+" 0",step:10,radius:c}),D.append(Y)}else if("bike-lane"===t[B].type||"scooter"===t[B].type){var V=o(N+" 0.015 0");G="red"===(f=U[1])?"surface-red bike-lane":"green"===f?"surface-green bike-lane":"bike-lane",s({objectMixinId:"stencils bike-arrow",parentEl:V,rotation:"-90 "+z+" 0",step:20,radius:c}),D.append(V),D.append(_(U,N,t[B].type))}else if("light-rail"===t[B].type||"streetcar"===t[B].type){G=g(U[1]);var W="streetcar"===t[B].type?"trolley":"tram";D.append(b(U,W,N));var q=l(N);s({objectMixinId:"track",parentEl:q,step:20.25,radius:c}),D.append(q)}else if("turn-lane"===t[B].type){G="drive-lane";var X=U[1];"inbound"===U[0]&&(X=X.replace(/left|right/g,(function(t){return"left"===t?"right":"left"}))),"shared"===U[1]&&(X="left"),"left-right-straight"===U[1]&&(X="all");var Q="stencils "+X,$=o(N+" 0.015 0");if(s({objectMixinId:Q,parentEl:$,rotation:"-90 "+z+" 0",step:15,radius:c}),D.append($),"shared"===U[1]){var K=o(N+" 0.015 "+-3*J);s({objectMixinId:Q,parentEl:K,rotation:"-90 "+(z+180)+" 0",step:15,radius:c}),D.append(K)}}else if("divider"===t[B].type&&"bollard"===U[0]){G="divider";var Z=d(N);s({objectMixinId:"safehit",parentEl:Z,step:4,radius:c}),D.append(Z)}else if("divider"===t[B].type&&"flowers"===U[0])G="grass",D.append(m("flowers",N,c,2.25));else if("divider"===t[B].type&&"planting-strip"===U[0])G="grass",D.append(m("planting-strip",N,c,2.25));else if("divider"===t[B].type&&"planter-box"===U[0])G="grass",D.append(m("planter-box",N,c,2.45));else if("divider"===t[B].type&&"palm-tree"===U[0]){G="grass";var tt=R(N);s({objectMixinId:"palm-tree",parentEl:tt,randomY:!0,radius:c}),D.append(tt)}else if("divider"===t[B].type&&"big-tree"===U[0]){G="grass";var et=R(N);s({objectMixinId:"tree3",parentEl:et,randomY:!0,radius:c}),D.append(et)}else if("divider"===t[B].type&&"bush"===U[0])G="grass",D.append(m("bush",N,c,2.25));else if("divider"===t[B].type&&"dome"===U[0])G="divider",D.append(m("dome",N,c,2.25));else if("temporary"===t[B].type&&"barricade"===U[0])G="drive-lane",D.append(p("temporary-barricade",N,c,2.25));else if("temporary"===t[B].type&&"traffic-cone"===U[0])G="drive-lane",D.append(p("temporary-traffic-cone",N,c,2.25));else if("temporary"===t[B].type&&"jersey-barrier-plastic"===U[0])G="drive-lane",D.append(p("temporary-jersey-barrier-plastic",N,c,2.25));else if("temporary"===t[B].type&&"jersey-barrier-concrete"===U[0])G="drive-lane",D.append(p("temporary-jersey-barrier-concrete",N,c,2.93));else if("bus-lane"===t[B].type){G=g(U[1]),D.append(y(J,N));var it=void 0;s({objectMixinId:"stencils word-bus",parentEl:it=o(N+" 0.015 0"),rotation:"-90 "+z+" 0",step:50,radius:c}),D.append(it),s({objectMixinId:"stencils word-taxi",parentEl:it=o(N+" 0.015 10"),rotation:"-90 "+z+" 0",step:50,radius:c}),D.append(it),s({objectMixinId:"stencils word-only",parentEl:it=o(N+" 0.015 20"),rotation:"-90 "+z+" 0",step:50,radius:c}),D.append(it)}else if("drive-lane"===t[B].type)D.append(v(U,N,T,i));else if("food-truck"===t[B].type)G="drive-lane",D.append(w(U,N));else if("flex-zone"===t[B].type)G="drive-lane",D.append(E(U,N));else if("sidewalk"===t[B].type&&"empty"!==U[0])D.append(x(N,T,U[0],i));else if("sidewalk-wayfinding"===t[B].type)D.append(M(N));else if("sidewalk-bench"===t[B].type){var rt=S(N),at="right"===U[0]?-90:90;"center"===U[0]?(s({objectMixinId:"bench_orientation_center",parentEl:rt,rotation:"0 "+at+" 0",radius:c}),D.append(rt)):(s({objectMixinId:"bench",parentEl:rt,rotation:"0 "+at+" 0",radius:c}),D.append(rt))}else if("sidewalk-bike-rack"===t[B].type){var nt=k(N);s({objectMixinId:"bikerack",parentEl:nt,rotation:"0 "+("sidewalk-parallel"===U[1]?90:0)+" 0",radius:c}),D.append(nt)}else if("outdoor-dining"===t[B].type)G="road"===U[1]?"drive-lane":"sidewalk",D.append(A(N));else if("parklet"===t[B].type)G="drive-lane",D.append(C(N,U));else if("bikeshare"===t[B].type)D.append(j(N,U));else if("utilities"===t[B].type){var st="right"===U[0]?"0 180 0":"0 0 0";D.append(p("utility_pole",N,c,15,st))}else if("sidewalk-tree"===t[B].type){var ot=R(N);s({objectMixinId:W="palm-tree"===U[0]?"palm-tree":"tree3",parentEl:ot,randomY:!0,radius:c}),D.append(ot)}else if("sidewalk-lamp"!==t[B].type||"modern"!==U[1]&&"pride"!==U[1])if("sidewalk-lamp"===t[B].type&&"traditional"===U[1]){var lt=I(N);s({objectMixinId:"lamp-traditional",parentEl:lt,radius:c}),D.append(lt)}else if("transit-shelter"===t[B].type){var dt="right"===U[0]?0:180,ct="right"===U[0]?1:-1;D.append(L(N,ct,dt))}else"separator"===t[B].type&&"dashed"===U[0]?(G="markings dashed-stripe",H+=.01,F=1):"separator"===t[B].type&&"solid"===U[0]?(G="markings solid-stripe",H+=.01,F=1):"separator"===t[B].type&&"doubleyellow"===U[0]?(G="markings solid-doubleyellow",H+=.01,F=1):"separator"===t[B].type&&"shortdashedyellow"===U[0]?(G="markings yellow short-dashed-stripe",H+=.01,F=1):"separator"===t[B].type&&"soliddashedyellow"===U[0]?(G="markings yellow solid-dashed",H+=.01,F=1):"separator"===t[B].type&&"soliddashedyellowinverted"===U[0]?(G="markings yellow solid-dashed",H+=.01,F=1,z="180"):"parking-lane"===t[B].type&&(G="drive-lane");else{var mt=I(N);"both"===U[0]?(s({objectMixinId:"lamp-modern-double",parentEl:mt,rotation:"0 0 0",radius:c}),D.append(mt)):(s({objectMixinId:"lamp-modern",parentEl:mt,rotation:"0 "+("right"===U[0]?0:180)+" 0",radius:c}),D.append(mt)),"pride"!==U[1]||"right"!==U[0]&&"both"!==U[0]||s({objectMixinId:"pride-flag",parentEl:mt,positionXYString:"0.409 5",radius:c}),"pride"!==U[1]||"left"!==U[0]&&"both"!==U[0]||s({objectMixinId:"pride-flag",parentEl:mt,rotation:"0 -180 0",positionXYString:"-0.409 5",radius:c})}r.isSidewalk(t[B].type)&&(G="sidewalk"),D.append(P(F,N,H,z,G,i)),u.append(D)}return u},t.exports.processBuildings=function(t,e,i,a,n){var o=document.createElement("a-entity");o.classList.add("buildings-parent");var l=150;return[t,e].forEach((function(t,e){if(0!==t.length){var n=0===e?"left":"right",d="left"===n?-1:1,c=(75+i/2)*d;if(a){var m=JSON.stringify(r.createGroundArray(t)),p=document.createElement("a-entity");p.setAttribute("create-from-json","jsonString",m),p.setAttribute("position",c+" 0 0"),p.classList.add("ground-"+n),o.appendChild(p)}if("narrow"===t||"wide"===t){var u=r.createBuildingsArray(l),f=JSON.stringify(u),h=document.createElement("a-entity");h.setAttribute("position",c+-72*d+" 0 "+75*d),h.setAttribute("rotation","0 "+90*d+" 0"),h.setAttribute("create-from-json","jsonString",f),h.classList.add("block-"+n),o.append(h)}if("residential"===t){var x=r.createBuildingsArray(l,"residential"),g=JSON.stringify(x),b=document.createElement("a-entity");b.setAttribute("position",c+-64*d+" -0.75 "+75*d),b.setAttribute("rotation","0 "+90*d+" 0"),b.setAttribute("create-from-json","jsonString",g),b.classList.add("suburbia-"+n),o.append(b)}if("waterfront"===t){var y=c-d*l/2,v=document.createElement("a-entity");v.setAttribute("class","seawall-parent"),v.setAttribute("position",y+" 0 10"),v.classList.add("seawall-parent-"+n),o.appendChild(v),s({objectMixinId:"seawall",parentEl:v,rotation:"0 90 0"+("right"===n?-90:90)+" 0",step:15,radius:70})}if("fence"===t||"parking-lot"===t){var w=c-d*l/2,A=document.createElement("a-entity");A.setAttribute("class","fence-parent"),A.setAttribute("position",w+" 0 0"),A.classList.add("fence-parent-"+c),s({objectMixinId:"fence",parentEl:A,rotation:"0 "+("right"===n?-90:90)+" 0",step:9.25,radius:70}),o.appendChild(A)}}})),o}},234:()=>{var t,e;t=!1,e=new THREE.FileLoader,window.AFRAME.registerElement("streetmix-assets",{prototype:Object.create(window.AFRAME.ANode.prototype,{createdCallback:{value:function(){this.setAttribute("src",""),this.isAssetItem=!0,this.isAssets=!0,this.fileLoader=e,this.timeout=null}},attachedCallback:{value:function(){if(!t){var e;this.parentNode&&this.parentNode.hasLoaded&&console.warn("Assets have already loaded. streetmix-assets may have problems"),t=!0,this.innerHTML=((e=this.getAttribute("url"))||(e="https://github.3d.st/"),console.log("[street]","Using street assets from",e),'\n  \n          \x3c!-- sidewalk props --\x3e\n          <a-asset-item id="bus-stop-glb" src="'.concat(e,'assets/objects/ccFO2EGGIq9-bus-stop.glb"></a-asset-item>\n          <img id="wayfinding-map" src="').concat(e,'assets/objects/wayfinding.jpg" crossorigin="anonymous" />\n          <a-asset-item id="streetProps" src="').concat(e,'assets/objects/street-props.glb"></a-asset-item>\n          <a-mixin id="outdoor_dining" gltf-part-plus="src: #streetProps; part: outdoor_dining"></a-mixin>\n          <a-mixin id="bench_orientation_center" gltf-part-plus="src: #streetProps; part: bench_orientation_center"></a-mixin>\n          <a-mixin id="parklet" gltf-part-plus="src: #streetProps; part: parklet"></a-mixin>\n          <a-mixin id="utility_pole" gltf-part-plus="src: #streetProps; part: utility_pole"></a-mixin>\n          <a-mixin id="lamp-modern" gltf-part-plus="src: #streetProps; part: street-light"></a-mixin>\n          <a-mixin id="lamp-modern-double" gltf-part-plus="src: #streetProps; part: street-light-double"></a-mixin>\n          <a-mixin id="bikerack" gltf-part-plus="src: #streetProps; part: bike_rack";></a-mixin>\n          <a-mixin id="bikeshare" gltf-part-plus="src: #streetProps; part: bike_share"></a-mixin>\n          <a-mixin id="lamp-traditional" gltf-part-plus="src: #streetProps; part: lamp_post_traditional"; scale="2 2 2"></a-mixin>\n          <a-mixin id="palm-tree" gltf-part-plus="src: #streetProps; part: palmtree"; scale="1 1.5 1"></a-mixin>\n          <a-mixin id="bench" gltf-part-plus="src: #streetProps; part: park_bench"></a-mixin>\n          <a-mixin id="seawall" gltf-part-plus="src: #streetProps; part: sea_wall"></a-mixin>\n          <a-mixin id="track" gltf-part-plus="src: #streetProps; part: track"></a-mixin>\n          <a-mixin id="tree3" gltf-part-plus="src: #streetProps; part: tree-01"; scale="1.25 1.25 1.25"></a-mixin>\n          <a-mixin id="transit-shelter" gltf-part-plus="src: #streetProps; part: transit-shelter-1"; scale="1.25 1.25 1.25"></a-mixin>\n\n          \x3c!-- human characters --\x3e\n          <a-asset-item id="humans" src="').concat(e,'assets/objects/humanoid/human-characters-poses-1.glb"></a-asset-item>\n          <a-mixin id="char1" gltf-part-plus="src: #humans; part: Character_1"></a-mixin>\n          <a-mixin id="char2" gltf-part-plus="src: #humans; part: Character_2"></a-mixin>\n          <a-mixin id="char3" gltf-part-plus="src: #humans; part: Character_3"></a-mixin>\n          <a-mixin id="char4" gltf-part-plus="src: #humans; part: Character_4"></a-mixin>\n          <a-mixin id="char5" gltf-part-plus="src: #humans; part: Character_5"></a-mixin>\n          <a-mixin id="char6" gltf-part-plus="src: #humans; part: Character_6"></a-mixin>\n          <a-mixin id="char7" gltf-part-plus="src: #humans; part: Character_7"></a-mixin>\n          <a-mixin id="char8" gltf-part-plus="src: #humans; part: Character_8"></a-mixin>\n          <a-asset-item id="humans2" src="').concat(e,'assets/objects/humanoid/human-characters-poses-2.glb"></a-asset-item>\n          <a-mixin id="char9" gltf-part-plus="src: #humans2; part: Character_9"></a-mixin>\n          <a-mixin id="char10" gltf-part-plus="src: #humans2; part: Character_10"></a-mixin>\n          <a-mixin id="char11" gltf-part-plus="src: #humans2; part: Character_11"></a-mixin>\n          <a-mixin id="char12" gltf-part-plus="src: #humans2; part: Character_12"></a-mixin>\n          <a-mixin id="char13" gltf-part-plus="src: #humans2; part: Character_13"></a-mixin>\n          <a-mixin id="char14" gltf-part-plus="src: #humans2; part: Character_14"></a-mixin>\n          <a-mixin id="char15" gltf-part-plus="src: #humans2; part: Character_15"></a-mixin>\n          <a-mixin id="char16" gltf-part-plus="src: #humans2; part: Character_16"></a-mixin>\n  \n          \x3c!-- vehicles --\x3e\n          <a-asset-item id="trammodel" src="').concat(e,'assets/objects/tram_siemens_avenio.gltf"></a-asset-item>\n          <a-asset-item id="trolleymodel" src="').concat(e,'assets/objects/godarvilletram.gltf"></a-asset-item>\n          <a-asset-item id="xd40" src="').concat(e,'assets/objects/bus/xd40-draco.glb"></a-asset-item>\n          <a-asset-item id="vehicles" src="').concat(e,'assets/objects/vehicles.glb"></a-asset-item>\n          <a-mixin id="box-truck" gltf-part-plus="src: #vehicles; part: box-truck"></a-mixin>\n          <a-mixin id="city-bus" gltf-part-plus="src: #vehicles; part: city-bus"></a-mixin>\n          <a-mixin id="food-trailer" gltf-part-plus="src: #vehicles; part: food-trailer"></a-mixin>\n          <a-mixin id="sedan" gltf-part-plus="src: #vehicles; part: sedan"></a-mixin>\n          <a-mixin id="sedan-taxi" gltf-part-plus="src: #vehicles; part: sedan-taxi"></a-mixin>\n          <a-mixin id="suv" gltf-part-plus="src: #vehicles; part: suv"></a-mixin>\n\n          \x3c!-- micro mobility vehicles --\x3e\n          <a-asset-item id="microMobilityDevices" src="').concat(e,'assets/objects/micro-mobility-devices_v01.glb"></a-asset-item>\n          <a-mixin id="Bicycle_1" gltf-part-plus="src: #microMobilityDevices; part: Bicycle_1"></a-mixin>\n          <a-mixin id="ElectricScooter_1" gltf-part-plus="src: #microMobilityDevices; part: ElectricScooter_1"></a-mixin>\n\n          \x3c!-- blocks --\x3e\n          <a-asset-item id="blockmodel" src="').concat(e,'assets/objects/buildings.glb"></a-asset-item>\n          <a-asset-item id="suburbiamodel" src="').concat(e,'assets/objects/suburbia/suburbia-fixwindowuvs-only3-draco.glb"></a-asset-item>\n          <a-asset-item id="dividers" src="').concat(e,'assets/objects/dividers.glb"></a-asset-item>\n          <a-asset-item id="fence-model" src="').concat(e,'assets/objects/fence4/fence4.gltf"></a-asset-item>\n            \n          <img id="stencils-atlas" src="').concat(e,'assets/materials/stencils-atlas_2048.png" crossorigin="anonymous" />\n          <img id="markings-atlas" src="').concat(e,'assets/materials/lane-markings-atlas_1024.png" crossorigin="anonymous" />\n  \n          \x3c!-- optimized textures - used by default --\x3e\n          <img id="seamless-road" src="').concat(e,'assets/materials/TexturesCom_Roads0086_1_seamless_S_rotate.jpg" crossorigin="anonymous">\n          <img id="hatched-base" src="').concat(e,'assets/materials/hatched_Base_Color.jpg" crossorigin="anonymous">\n          <img id="hatched-normal" src="').concat(e,'assets/materials/hatched_Normal.jpg" crossorigin="anonymous">\n          <img id="seamless-sidewalk" src="').concat(e,'assets/materials/TexturesCom_FloorsRegular0301_1_seamless_S.jpg" crossorigin="anonymous">\n          <a-mixin id="drive-lane" geometry="width:3;height:150;primitive:plane" material="repeat:0.3 25;offset:0.55 0;src:#seamless-road;"></a-mixin>\n          <a-mixin id="bike-lane" geometry="width:1.8;height:150;primitive:plane" material="repeat:0.3 25;offset:0.55 0;roughness:1;metalness:0;src:#seamless-road;"></a-mixin>\n          <a-mixin id="sidewalk" anisotropy geometry="width:3;height:150;primitive:plane" material="repeat:1.5 75;src:#seamless-sidewalk;"></a-mixin>\n          <a-mixin id="bus-lane" geometry="width:3;height:150;primitive:plane" material="repeat:0.3 25;offset:0.55 0;src:#seamless-road;"></a-mixin>\n          <a-mixin id="divider" geometry="width:0.3;height:150;primitive:plane" material="repeat:1 150;offset:0.415 0;normalTextureOffset:0.415 0;src:#hatched-base;normalTextureRepeat:0.21 150;normalMap:#hatched-normal"></a-mixin>\n          <a-mixin id="grass" geometry="width:0.3;height:150;primitive:plane" material="repeat:1 150;offset:0.415 0;src:#grass-texture;"></a-mixin>\n\n          \x3c!-- lane separator markings atlas --\x3e\n          <a-mixin id="markings" anisotropy atlas-uvs="totalRows: 1; totalColumns: 8; row: 1" scale="1 1 1" material="src: #markings-atlas;alphaTest: 0;transparent:true;repeat:1 25;" geometry="primitive: plane; buffer: false; skipCache: true; width:0.2; height:150;"></a-mixin>\n          <a-mixin id="solid-stripe" atlas-uvs="column: 3"></a-mixin>\n          <a-mixin id="dashed-stripe" atlas-uvs="column: 4"></a-mixin>\n          <a-mixin id="short-dashed-stripe" atlas-uvs="column: 4" material="repeat:1 50;"></a-mixin>\n          <a-mixin id="solid-doubleyellow" atlas-uvs="totalColumns: 4; column: 3" geometry="width: 0.5"></a-mixin>\n          <a-mixin id="solid-dashed" atlas-uvs="totalColumns: 4; column: 2" geometry="width: 0.4"></a-mixin>\n  \n          \x3c!-- color modifier mixins --\x3e\n          <a-mixin id="yellow" material="color:#f7d117"></a-mixin>\n          <a-mixin id="surface-green" material="color:#adff83"></a-mixin>\n          <a-mixin id="surface-red" material="color:#ff9393"></a-mixin>\n  \n          \x3c!-- stencils atlas --\x3e\n          <a-mixin id="stencils" anisotropy atlas-uvs="totalRows: 4; totalColumns: 4" scale="2 2 2" material="src: #stencils-atlas;alphaTest: 0;transparent:true;" geometry="primitive: plane; buffer: false; skipCache: true"></a-mixin>\n          <a-mixin id="right" atlas-uvs="column: 3; row: 2"></a-mixin>\n          <a-mixin id="left" atlas-uvs="column: 3; row: 3"></a-mixin>\n          <a-mixin id="both" atlas-uvs="column: 2; row: 1"></a-mixin>\n          <a-mixin id="all" atlas-uvs="column: 3; row: 1"></a-mixin>\n          <a-mixin id="left-straight" atlas-uvs="column: 2; row: 3"></a-mixin>\n          <a-mixin id="right-straight" atlas-uvs="column: 2; row: 2"></a-mixin>\n          <a-mixin id="straight" atlas-uvs="column: 2; row: 4"></a-mixin>\n          <a-mixin id="sharrow" atlas-uvs="totalRows: 4; totalColumns: 8; column: 2; row: 3" scale="1.5 3 1"></a-mixin>\n          <a-mixin id="bike-arrow" atlas-uvs="totalRows: 2; totalColumns: 8; column: 1; row: 2" scale="1 4 1"></a-mixin>\n          <a-mixin id="word-bus" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 4" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-lane" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 4" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-taxi" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 3" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-only" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 3" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-yield" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 2" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-slow" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 2" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-xing" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 1" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-stop" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 1" scale="3 3 3"></a-mixin>\n          <a-mixin id="perpendicular-stalls" atlas-uvs="totalRows: 4; totalColumns: 8; column: 5; row: 4" scale="5 10 5"></a-mixin>\n          <a-mixin id="parking-delimiter" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 7" scale="1.8 1.8 1.8"></a-mixin>\n  \n          \x3c!-- vehicles --\x3e\n          <a-mixin id="bus" anisotropy gltf-model="#xd40" scale="1.55 1.55 1.55"></a-mixin>\n          <a-mixin id="tram" anisotropy gltf-model="#trammodel"></a-mixin>\n          <a-mixin id="trolley" gltf-model="#trolleymodel"></a-mixin>\n  \n          \x3c!-- street props --\x3e\n          <a-mixin id="pride-flag" position="0.409 3.345 0" rotation="0 0 0" scale="0.5 0.75 0" geometry="width:2;height:2;primitive:plane" material="side:double; src:').concat(e,'assets/materials/rainbow-flag-poles_512.png;transparent: true;"></a-mixin>\n          <a-mixin id="bus-stop" gltf-model="#bus-stop-glb" rotation="-90 0 0" scale="0.001 0.001 0.001" ></a-mixin>\n          <a-mixin id="wayfinding-box" geometry="primitive: box; height: 2; width: 0.84; depth: 0.1" material="color: gray"></a-mixin>\n  \n          \x3c!-- buildings and blocks --\x3e\n          <a-mixin id="block" gltf-model="#blockmodel" scale="1 1 1"></a-mixin>\n          <a-mixin id="suburbia" gltf-model="#suburbiamodel" scale="1 1 1"></a-mixin>\n  \n          <a-mixin id="SM3D_Bld_Mixed_Corner_4fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_Corner_4fl" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_Double_5fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_Double_5fl" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_4fl_2" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_4fl_2" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_5fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_5fl" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_4fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_4fl" model-center="bottomAlign: true"></a-mixin>\n  \n          <a-mixin id="SM_Bld_House_Preset_03_1800" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #suburbiamodel; part: SM_Bld_House_Preset_03_1800" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM_Bld_House_Preset_08_1809" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #suburbiamodel; part: SM_Bld_House_Preset_08_1809" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM_Bld_House_Preset_09_1845" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #suburbiamodel; part: SM_Bld_House_Preset_09_1845" model-center="bottomAlign: true"></a-mixin>\n  \n          <a-mixin id="fence" gltf-model="#fence-model" scale="0.1 0.1 0.1"></a-mixin>\n\n          \x3c!-- dividers --\x3e\n          <a-mixin id="dividers-flowers" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: flowers"></a-mixin>\n          <a-mixin id="dividers-planting-strip" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: planting-strip"></a-mixin>\n          <a-mixin id="dividers-planter-box" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: planter-box"></a-mixin>\n          <a-mixin id="dividers-bush" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: bush"></a-mixin>\n          <a-mixin id="dividers-dome" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: dome"></a-mixin>\n          <a-mixin id="safehit" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: bollard"></a-mixin>\n          <a-mixin id="temporary-barricade" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: barricade"></a-mixin>\n          <a-mixin id="temporary-traffic-cone" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: traffic-cone"></a-mixin>\n          <a-mixin id="temporary-jersey-barrier-plastic" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: jersey-barrier-plastic"></a-mixin>\n          <a-mixin id="temporary-jersey-barrier-concrete" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #dividers; part: jersey-barrier-concrete"></a-mixin>\n\n          \x3c!-- grounds --\x3e\n          <img id="grass-texture" src="').concat(e,'assets/materials/TexturesCom_Grass0052_1_seamless_S.jpg" crossorigin="anonymous">\n          <img id="parking-lot-texture" src="').concat(e,'assets/materials/TexturesCom_Roads0111_1_seamless_S.jpg" crossorigin="anonymous">\n          <img id="asphalt-texture" src="').concat(e,'assets/materials/TexturesCom_AsphaltDamaged0057_1_seamless_S.jpg" crossorigin="anonymous">\n\n          <a-mixin id="ground-grass" rotation="-90 0 0" geometry="primitive:plane;height:150;width:150" material="src:#grass-texture;repeat:5 5;roughness:1"></a-mixin>\n          <a-mixin id="ground-parking-lot" rotation="-90 0 0" geometry="primitive:plane;height:150;width:150" material="src:#parking-lot-texture;repeat:2 4;roughness:1"></a-mixin>\n          <a-mixin id="ground-asphalt" rotation="-90 0 0" geometry="primitive:plane;height:150;width:150" material="src:#asphalt-texture;repeat:5 5;roughness:1"></a-mixin>\n  \n          \x3c!-- ui / future use --\x3e\n          <img id="subtitle" src="').concat(e,'assets/materials/subtitle.png" crossorigin="anonymous" />\n  '));var i=this.parentNode;this.setAttribute("timeout",i.getAttribute("timeout")),this.parentNode.isScene=!0,Object.getPrototypeOf(i).attachedCallback.call(this),this.parentNode.isScene=!1}}},load:{value:function(){AFRAME.ANode.prototype.load.call(this,null,(function(t){return t.isAssetItem&&t.hasAttribute("src")}))}}})}),window.addEventListener("DOMContentLoaded",(function(e){if(!t){var i=document.querySelector("a-assets");i||(i=document.createElement("a-assets")),i.hasLoaded&&console.warn("Assets already loaded. May lead to bugs");var r=document.createElement("streetmix-assets");i.append(r),document.querySelector("a-scene").append(i)}})),document.addEventListener("DOMSubtreeModified",(function t(e){if("A-SCENE"===e.target.nodeName){var i=e.target.querySelector("a-assets");if(i||(i=document.createElement("a-assets"),e.target.append(i)),i.querySelector("streetmix-assets"))document.removeEventListener("DOMSubtreeModified",t);else{var r=document.createElement("streetmix-assets");i.append(r),document.removeEventListener("DOMSubtreeModified",t)}}}),!1)},391:(t,e,i)=>{var r=i(334);AFRAME.registerComponent("create-from-json",{schema:{jsonString:{type:"string",default:""}},update:function(t){var e=this.data,i=this.el;if(t.string&&e.string!==t.string)for(;i.firstChild;)i.removeChild(i.lastChild);r.appendChildElementsFromArray(JSON.parse(e.jsonString),i)}})},579:(t,e,i)=>{var r=i(844),a=i(394);i(234),i(391),i(631),i(172),AFRAME.registerComponent("street",{schema:{JSON:{type:"string"},type:{default:"streetmixSegmentsFeet"},left:{default:""},right:{default:""},showGround:{default:!0},showStriping:{default:!0},length:{default:150}},update:function(t){var e=this.data;if(0!==e.JSON.length){var i=JSON.parse(e.JSON),n=r.processSegments(i.streetmixSegmentsFeet,e.showStriping,e.length);if(this.el.append(n),e.left||e.right){var s=a.calcStreetWidth(i.streetmixSegmentsFeet,e.autoStriping),o=r.processBuildings(e.left,e.right,s,e.showGround,e.length);this.el.append(o)}}else{if(void 0!==t.JSON&&0===t.JSON.length)return;console.log("[street]","No JSON provided yet, but it might be set at runtime")}}}),AFRAME.registerComponent("streetmix-loader",{dependencies:["street"],schema:{streetmixStreetURL:{type:"string"},streetmixAPIURL:{type:"string"},showBuildings:{default:!0},name:{default:""}},update:function(t){var e=this.data,i=this.el;if(t.streetmixStreetURL!==e.streetmixStreetURL||t.streetmixAPIURL!==e.streetmixAPIURL)if(0!==e.streetmixAPIURL.length){var r=new XMLHttpRequest;console.log("[streetmix-loader]","GET "+e.streetmixAPIURL),r.open("GET",e.streetmixAPIURL,!0),r.onload=function(){if(this.status>=200&&this.status<400){var t=JSON.parse(this.response),r=t.data.street.segments,a=t.name;i.setAttribute("streetmix-loader","name",a),e.showBuildings&&(i.setAttribute("street","right",t.data.street.rightBuildingVariant),i.setAttribute("street","left",t.data.street.leftBuildingVariant)),i.setAttribute("street","type","streetmixSegmentsFeet"),i.setAttribute("street","JSON",JSON.stringify({streetmixSegmentsFeet:r})),i.emit("streetmix-loader-street-loaded")}else console.log("[streetmix-loader]","Loading Error: We reached the target server, but it returned an error")},r.onerror=function(){console.log("[streetmix-loader]","Loading Error: There was a connection error of some sort")},r.send()}else{if(e.streetmixStreetURL.length>0){var n=a.streetmixUserToAPI(e.streetmixStreetURL);return console.log("[streetmix-loader]","setting `streetmixAPIURL` to",n),void i.setAttribute("streetmix-loader","streetmixAPIURL",n)}console.log("[streetmix-loader]","Neither `streetmixAPIURL` nor `streetmixStreetURL` properties provided, please provide at least one.")}}})},172:()=>{function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var e={},i={};AFRAME.registerComponent("gltf-part-plus",{schema:{buffer:{default:!0},part:{type:"string"},src:{type:"asset"},resetPosition:{default:!1}},init:function(){this.dracoLoader=document.querySelector("a-scene").systems["gltf-model"].getDRACOLoader()},update:function(){var t=this.el,e=this.data;!this.data.part&&this.data.src||this.getModel((function(i){i&&(e.resetPosition&&(t.setAttribute("position",i.position.x+" "+i.position.y+" "+i.position.z),i.position.set(0,0,0)),t.setObject3D("mesh",i),t.emit("model-loaded",{format:"gltf",part:this.modelPart}))}))},getModel:function(t){var r=this;if(!i[this.data.src])return e[this.data.src]?e[this.data.src].then((function(e){t(r.selectFromModel(e))})):void(e[this.data.src]=new Promise((function(a){var n=new THREE.GLTFLoader;r.dracoLoader&&n.setDRACOLoader(r.dracoLoader),n.load(r.data.src,(function(n){var s=n.scene||n.scenes[0];i[r.data.src]=s,delete e[r.data.src],t(r.selectFromModel(s)),a(s)}),(function(){}),console.error)})));t(this.selectFromModel(i[this.data.src]))},selectFromModel:function(t){var e,i;if(i=t.getObjectByName(this.data.part))return e=i.getObjectByProperty("type","Mesh").clone(!0),this.data.buffer?(e.geometry=e.geometry.toNonIndexed(),e):(e.geometry=(new THREE.Geometry).fromBufferGeometry(e.geometry),e);console.error("[gltf-part] `"+this.data.part+"` not found in model.")}}),AFRAME.registerComponent("model-center",{schema:{bottomAlign:{default:!1}},init:function(){var t=this;this.el.addEventListener("model-loaded",(function(e){var i=t.el.getObject3D("mesh");if(i.position.set(0,0,0),i.geometry.center(),t.data.bottomAlign){var r=(new THREE.Box3).setFromObject(i),a=r.max.sub(r.min).y;i.position.y=a/2}}))}}),AFRAME.registerComponent("anisotropy",{schema:{default:0},dependencies:["material","geometry"],init:function(){var t=this;this.maxAnisotropy=this.el.sceneEl.renderer.capabilities.getMaxAnisotropy(),["model-loaded","materialtextureloaded"].forEach((function(e){return t.el.addEventListener(e,(function(){var e=t.el.getObject3D("mesh"),i=t.data;0===(i=+i||0)&&(i=t.maxAnisotropy),e.traverse((function(t){!0===t.isMesh&&null!==t.material.map&&(t.material.map.anisotropy=i,t.material.map.needsUpdate=!0)}))}),!1)}))}}),AFRAME.registerComponent("instancedmesh",{schema:{retainParent:{default:!1},retainChildren:{default:!1},inheritMat:{default:!0},mergeInstances:{default:!1},frustumCulled:{default:!0}},init:function(){},update:function(){var e,i,r,a,n,s=this,o=this.el,l=this.el.children,d=0,c=(e=new THREE.Vector3,i=new THREE.Euler,r=new THREE.Vector3,a=new THREE.Quaternion,function(t,n){e.x=o.children[t].object3D.position.x,e.y=o.children[t].object3D.position.y,e.z=o.children[t].object3D.position.z,i.x=o.children[t].object3D.rotation.x,i.y=o.children[t].object3D.rotation.y,i.z=o.children[t].object3D.rotation.z,a.setFromEuler(i),r.x=o.children[t].object3D.scale.x,r.y=o.children[t].object3D.scale.y,r.z=o.children[t].object3D.scale.z,n.compose(e,a,r)}),m=function(e,i){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,i){if(e){if("string"==typeof e)return t(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,i):void 0}}(e))||i&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw s}}}}(l);try{for(m.s();!(n=m.n()).done;)n.value,d+=1}catch(t){m.e(t)}finally{m.f()}var p=this.el.getObject3D("mesh");if(p){var u=p.material.clone(),f=null;p.traverse((function(t){!0===t.isMesh&&(f=t.geometry)}));for(var h=new THREE.InstancedMesh(f,u,d),x=0;x<d;x++){var g=new THREE.Matrix4;c(x,g),h.setMatrixAt(x,g)}h.frustumCulled=this.data.frustumCulled,this.el.object3D.add(h),this.data.retainParent||this.el.object3D.remove(p),this.data.inheritMat&&(this.el.components.material.material=u)}else this.el.addEventListener("model-loaded",(function(t){s.update(s.data)}))}})},199:t=>{t.exports.isSidewalk=function(t){return t.startsWith("sidewalk")||["utilities","scooter-drop-zone","bikeshare","flex-zone-curb","transit-shelter"].includes(t)},t.exports.createBuildingsArray=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"narrow";"narrow"===r||"wide"===r?(t=[{id:"SM3D_Bld_Mixed_4fl",width:5.25221},{id:"SM3D_Bld_Mixed_Double_5fl",width:10.9041},{id:"SM3D_Bld_Mixed_4fl_2",width:5.58889},{id:"SM3D_Bld_Mixed_5fl",width:6.47593},{id:"SM3D_Bld_Mixed_Corner_4fl",width:6.94809}],e="41431323432402434130303230234102402341"):"residential"===r&&(t=[{id:"SM_Bld_House_Preset_03_1800",width:20},{id:"SM_Bld_House_Preset_08_1809",width:20},{id:"SM_Bld_House_Preset_09_1845",width:20}],e="12021201210101212021201012012021201210");for(var a=0,n=0,s=[];n<i;){var o=t[parseInt(e[a])],l={tag:"a-entity",mixin:o.id,position:n+o.width/2+" 0 0"};s.push(l),n+=o.width,a++}return s},t.exports.filterBuildingsArrayByMixin=function(t,e){var i=[];return t.forEach((function(t,r){t.mixin===e&&i.push(t)})),i},t.exports.removePropertyFromArray=function(t,e){return t.forEach((function(t,i){delete t[e]})),t},t.exports.createClonedEntitiesArray=function(t){for(var e=t.mixin,i=void 0===e?"":e,r=t.step,a=void 0===r?15:r,n=t.radius,s=void 0===n?60:n,o=t.rotation,l=void 0===o?"0 0 0":o,d=t.positionXYString,c=void 0===d?"0 0":d,m=t.randomY,p=void 0!==m&&m,u=[],f=-1*s;f<=s;f+=a){var h={tag:"a-entity",position:c+" "+f};i&&(h.class=i,h.mixin=i),h.rotation=p?"0 "+Math.floor(361*randomTestable())+" 0":l,u.push(h)}return u},t.exports.getAmbientSoundJSON=function(t){var e={fence:"#suburbs-mp3",grass:"#suburbs-mp3","parking-lot":"#parking-lot-mp3",waterfront:"#waterfront",residential:"#suburbs2-mp3",narrow:"#ambientmp3",wide:"#ambientmp3"},i=[],r=null;return t.forEach((function(t,a){if(!r||r!==e[t]){var n={tag:"a-entity",class:"playme",sound:"src: "+e[t]+"; positional: false; loop: true"};i.push(n),r=e[t]}})),i},t.exports.createGroundArray=function(t){var e=[],i="ground-grass";if("waterfront"===t)return e;["narrow","wide"].includes(t)&&(i="ground-asphalt"),"parking-lot"===t&&(i="ground-parking-lot");var r={tag:"a-entity",position:"0 -0.2 0",mixin:i};return e.push(r),e}},334:t=>{function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],r=!0,a=!1,n=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){a=!0,n=t}finally{try{r||null==o.return||o.return()}finally{if(a)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=document.createElement(t.tag);delete t.tag;for(var r=0,a=Object.entries(t);r<a.length;r++){var n=e(a[r],2),s=n[0],o=n[1];i.setAttribute(s,o)}return i}t.exports.createElementFromObject=r,t.exports.appendChildElementsFromArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return t.forEach((function(t,i){e.appendChild(r(t))})),e}},394:t=>{t.exports.streetmixUserToAPI=function(t){var e=new URL(t).pathname.split("/"),i=e[1],r=e[2];return"-"===i?"https://streetmix.net/api/v1/streets?namespacedId="+r:"https://streetmix.net/api/v1/streets?namespacedId="+r+"&creatorId="+i},t.exports.pathStartsWithAPI=function(t){var e=document.createElement("a");return e.href=t,"api"===e.pathname.split("/")[1]},t.exports.streetmixAPIToUser=function(t){function e(t,e){for(var i=t.split("&"),r=0;r<i.length;r++){var a=i[r].split("=");if(decodeURIComponent(a[0])===e)return decodeURIComponent(a[1])}console.log("Query variable %s not found",e)}var i=new URL(t).search.substring(1),r=e(i,"namespacedId"),a=e(i,"creatorId");return void 0===a&&(a="-"),"https://streetmix.net/"+a+"/"+r},t.exports.calcStreetWidth=function(t){var e=0;return t.forEach((function(t){var i=t.width;e+=.3048*i})),e}}},e={},function i(r){if(e[r])return e[r].exports;var a=e[r]={exports:{}};return t[r](a,a.exports,i),a.exports}(579);var t,e}));