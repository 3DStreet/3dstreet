!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var a in i)("object"==typeof exports?exports:t)[a]=i[a]}}(self,(function(){return t={631:t=>{var e=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];function i(t,i,a,n){const r=1/n,s=1/a;return e[0].set(r*i,s*t+s),e[1].set(r*i,s*t),e[2].set(r*i+r,s*t),e[3].set(r*i+r,s*t+s),e}AFRAME.registerComponent("atlas-uvs",{dependencies:["geometry"],schema:{totalColumns:{type:"int",default:1},totalRows:{type:"int",default:1},column:{type:"int",default:1},row:{type:"int",default:1}},update:function(){const t=this.data,e=i(t.row-1,t.column-1,t.totalRows,t.totalColumns),a=this.el.getObject3D("mesh").geometry;a.faceVertexUvs[0][0][0].copy(e[0]),a.faceVertexUvs[0][0][1].copy(e[1]),a.faceVertexUvs[0][0][2].copy(e[3]),a.faceVertexUvs[0][1][0].copy(e[1]),a.faceVertexUvs[0][1][1].copy(e[2]),a.faceVertexUvs[0][1][2].copy(e[3]),a.uvsNeedUpdate=!0}}),AFRAME.registerComponent("dynamic-texture-atlas",{schema:{canvasId:{default:"dynamicAtlas"},canvasHeight:{default:1024},canvasWidth:{default:1024},debug:{default:!1},numColumns:{default:8},numRows:{default:8}},multiple:!0,init:function(){const t=this.canvas=document.createElement("canvas");t.id=this.data.canvasId,t.height=this.data.canvasHeight,t.width=this.data.canvasWidth,this.ctx=t.getContext("2d"),document.body.appendChild(t),this.data.debug&&(t.style.left=0,t.style.top=0,t.style.position="fixed",t.style.zIndex=9999999999)},drawTexture:function(t,e,a,n,r){const s=this.canvas,o=this.data;t.complete||(t.onload=()=>{this.drawTexture(t,e,a)});const l=r||s.height/o.numRows,d=n||s.width/o.numColumns;return this.ctx.drawImage(t,d*e,d*a,d,l),i(e,a,o.numRows,o.numColumns)}}),t.exports.getGridUvs=i},125:()=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var t=new THREE.Vector3(0,0,1),e=THREE.Math.degToRad;AFRAME.registerComponent("curve-point",{schema:{},init:function(){this.el.addEventListener("componentchanged",this.changeHandler.bind(this)),this.el.emit("curve-point-change")},changeHandler:function(t){"position"==t.detail.name&&this.el.emit("curve-point-change")}}),AFRAME.registerComponent("curve",{schema:{type:{type:"string",default:"CatmullRom",oneOf:["CatmullRom","CubicBezier","QuadraticBezier","Line"]},closed:{type:"boolean",default:!1}},init:function(){this.pathPoints=null,this.curve=null,this.el.addEventListener("curve-point-change",this.update.bind(this))},update:function(t){if(this.points=Array.from(this.el.querySelectorAll("a-curve-point, [curve-point]")),this.points.length<=1)console.warn("At least 2 curve-points needed to draw a curve"),this.curve=null;else{var e=this.points.map((function(t){return void 0!==t.x&&void 0!==t.y&&void 0!==t.z?t:t.object3D.getWorldPosition()}));if(!AFRAME.utils.deepEqual(e,this.pathPoints)||"CustomEvent"!==t&&!AFRAME.utils.deepEqual(this.data,t)){if(this.curve=null,this.pathPoints=e,this.threeConstructor=THREE.CatmullRomCurve3,!this.threeConstructor)throw new Error("No Three constructor of type (case sensitive): "+this.data.type+"Curve3");this.curve=new this.threeConstructor(this.pathPoints),this.curve.closed=this.data.closed,this.el.emit("curve-updated")}}},remove:function(){this.el.removeEventListener("curve-point-change",this.update.bind(this))},closestPointInLocalSpace:function(t,e,i,n){if(!this.curve)throw Error("Curve not instantiated yet.");e=e||.1/this.curve.getLength(),n=n||.5;var r=(i=i||.5)+(n/=2),s=i-n,o=this.curve.getPointAt(r),l=this.curve.getPointAt(s),d=o.distanceTo(t),c=l.distanceTo(t),u=d<c;if(n<e){var m=this.curve.getTangentAt(u?r:s);if(n<e)return{result:u?r:s,location:u?o:l,distance:u?d:c,normal:a(m),tangent:m}}return d<c?this.closestPointInLocalSpace(t,e,r,n):this.closestPointInLocalSpace(t,e,s,n)}});var i=new THREE.Quaternion;function a(e){var a=new THREE.Vector3(0,1,0);return i.setFromUnitVectors(t,e),a.applyQuaternion(i),a}AFRAME.registerShader("line",{schema:{color:{default:"#ff0000"}},init:function(t){this.material=new THREE.LineBasicMaterial(t)},update:function(t){this.material=new THREE.LineBasicMaterial(t)}}),AFRAME.registerComponent("draw-curve",{schema:{curve:{type:"selector"}},init:function(){this.data.curve.addEventListener("curve-updated",this.update.bind(this))},update:function(){if(this.data.curve&&(this.curve=this.data.curve.components.curve),this.curve&&this.curve.curve){var t=this.el.getOrCreateObject3D("mesh",THREE.Line);lineMaterial=t.material?t.material:new THREE.LineBasicMaterial({color:"#ff0000"});var e=new THREE.Geometry;e.vertices=this.curve.curve.getPoints(10*this.curve.curve.points.length),this.el.setObject3D("mesh",new THREE.Line(e,lineMaterial))}},remove:function(){this.data.curve.removeEventListener("curve-updated",this.update.bind(this)),this.el.getObject3D("mesh").geometry=new THREE.Geometry}}),AFRAME.registerComponent("clone-along-curve",{schema:{curve:{type:"selector"},spacing:{default:1},rotation:{type:"vec3",default:"0 0 0"},scale:{type:"vec3",default:"1 1 1"}},init:function(){this.el.addEventListener("model-loaded",this.update.bind(this)),this.data.curve.addEventListener("curve-updated",this.update.bind(this))},update:function(){if(this.remove(),this.data.curve&&(this.curve=this.data.curve.components.curve),!this.el.getObject3D("clones")&&this.curve&&this.curve.curve){var i=this.el.getObject3D("mesh"),a=this.curve.curve.getLength(),n=0,r=this.el.getOrCreateObject3D("clones",THREE.Group),s=new THREE.Object3D;for(i.scale.set(this.data.scale.x,this.data.scale.y,this.data.scale.z),i.rotation.set(e(this.data.rotation.x),e(this.data.rotation.y),e(this.data.rotation.z)),i.rotation.order="YXZ",s.add(i);n<=a;){var o=s.clone(!0);o.position.copy(this.curve.curve.getPointAt(n/a)),tangent=this.curve.curve.getTangentAt(n/a).normalize(),o.quaternion.setFromUnitVectors(t,tangent),r.add(o),n+=this.data.spacing}}},remove:function(){this.curve=null,this.el.getObject3D("clones")&&this.el.removeObject3D("clones")}}),AFRAME.registerPrimitive("a-draw-curve",{defaultComponents:{"draw-curve":{}},mappings:{curveref:"draw-curve.curve"}}),AFRAME.registerPrimitive("a-curve-point",{defaultComponents:{"curve-point":{}},mappings:{}}),AFRAME.registerPrimitive("a-curve",{defaultComponents:{curve:{}},mappings:{type:"curve.type"}})},485:()=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var t={},e={};AFRAME.registerComponent("gltf-part-plus",{schema:{buffer:{default:!0},part:{type:"string"},src:{type:"asset"},resetPosition:{default:!1}},init:function(){this.dracoLoader=document.querySelector("a-scene").systems["gltf-model"].getDRACOLoader()},update:function(){var t=this.el,e=this.data;!this.data.part&&this.data.src||this.getModel((function(i){i&&(e.resetPosition&&(t.setAttribute("position",i.position.x+" "+i.position.y+" "+i.position.z),i.position.set(0,0,0)),t.setObject3D("mesh",i),t.emit("model-loaded",{format:"gltf",part:this.modelPart}))}))},getModel:function(i){var a=this;if(!e[this.data.src])return t[this.data.src]?t[this.data.src].then((function(t){i(a.selectFromModel(t))})):void(t[this.data.src]=new Promise((function(n){var r=new THREE.GLTFLoader;a.dracoLoader&&r.setDRACOLoader(a.dracoLoader),r.load(a.data.src,(function(r){var s=r.scene||r.scenes[0];e[a.data.src]=s,delete t[a.data.src],i(a.selectFromModel(s)),n(s)}),(function(){}),console.error)})));i(this.selectFromModel(e[this.data.src]))},selectFromModel:function(t){var e,i;if(i=t.getObjectByName(this.data.part))return e=i.getObjectByProperty("type","Mesh").clone(!0),this.data.buffer?(e.geometry=e.geometry.toNonIndexed(),e):(e.geometry=(new THREE.Geometry).fromBufferGeometry(e.geometry),e);console.error("[gltf-part] `"+this.data.part+"` not found in model.")}}),AFRAME.registerComponent("model-center",{schema:{bottomAlign:{default:!1}},init:function(){this.el.addEventListener("model-loaded",(t=>{var e=this.el.getObject3D("mesh");if(e.position.set(0,0,0),e.geometry.center(),this.data.bottomAlign){var i=(new THREE.Box3).setFromObject(e),a=i.max.sub(i.min).y;e.position.y=a/2}}))}}),AFRAME.registerComponent("anisotropy",{schema:{default:0},dependencies:["material","geometry"],init:function(){this.maxAnisotropy=this.el.sceneEl.renderer.capabilities.getMaxAnisotropy(),["model-loaded","materialtextureloaded"].forEach((t=>this.el.addEventListener(t,(()=>{const t=this.el.getObject3D("mesh");var e=this.data;0===(e=+e||0)&&(e=this.maxAnisotropy),t.traverse((t=>{!0===t.isMesh&&null!==t.material.map&&(t.material.map.anisotropy=e,t.material.map.needsUpdate=!0)}))}),!1)))}}),AFRAME.registerComponent("instancedmesh",{schema:{retainParent:{default:!1},retainChildren:{default:!1},inheritMat:{default:!0},mergeInstances:{default:!1},frustumCulled:{default:!0}},init:function(){},update:function(){var t,e,i,a,n=this.el,r=this.el.children,s=0,o=(t=new THREE.Vector3,e=new THREE.Euler,i=new THREE.Vector3,a=new THREE.Quaternion,function(r,s){t.x=n.children[r].object3D.position.x,t.y=n.children[r].object3D.position.y,t.z=n.children[r].object3D.position.z,e.x=n.children[r].object3D.rotation.x,e.y=n.children[r].object3D.rotation.y,e.z=n.children[r].object3D.rotation.z,a.setFromEuler(e),i.x=n.children[r].object3D.scale.x,i.y=n.children[r].object3D.scale.y,i.z=n.children[r].object3D.scale.z,s.compose(t,a,i)});for(var l of r)s+=1;var d=this.el.getObject3D("mesh");if(d){var c=d.material.clone(),u=null;d.traverse((function(t){!0===t.isMesh&&(u=t.geometry)}));for(var m=new THREE.InstancedMesh(u,c,s),p=0;p<s;p++){var h=new THREE.Matrix4;o(p,h),m.setMatrixAt(p,h)}m.frustumCulled=this.data.frustumCulled,this.el.object3D.add(m),this.data.retainParent||this.el.object3D.remove(d),this.data.inheritMat&&(this.el.components.material.material=c)}else this.el.addEventListener("model-loaded",(t=>{this.update(this.data)}))}})},956:(t,e,i)=>{var a=i(394);function n(){var t=location.hash.substring(1);t&&("api"!==new URL(t).pathname.split("/")[1]&&(t=a.streetmixUserToAPI(t)),document.querySelector(".set-from-input").setAttribute("street","streetmixURL: "+t+"; buildings: true;"),document.getElementById("input-url").value=a.streetmixAPIToUser(t))}window.streetmixLoaders={initStreet:function(){document.getElementById("input-url").onkeypress=function(t){t||(t=window.event),"13"===(t.keyCode||t.which)&&function(){var t=document.getElementById("input-url").value;if(t){"api"!==new URL(t).pathname.split("/")[1]&&(t=a.streetmixUserToAPI(t));var e=window.location.hash==="#"+a.streetmixAPIToUser(t);window.location.hash="#"+a.streetmixAPIToUser(t),e&&n()}}()};var t=window.location.hash.substring(1);if(!t)return t="https://streetmix.net/api/v1/streets?namespacedId=3&creatorId=kfarr",window.location.hash="#"+a.streetmixAPIToUser(t),void(document.getElementById("input-url").value=a.streetmixAPIToUser(t));"api"!==new URL(t).pathname.split("/")[1]&&(t=a.streetmixUserToAPI(t)),document.querySelector(".set-from-input").setAttribute("street","streetmixURL: "+t+"; buildings: true;"),window.location.hash="#"+a.streetmixAPIToUser(t),document.getElementById("input-url").value=a.streetmixAPIToUser(t)}},window.streetmixLoaders.locationHashChanged=n},844:(t,e,i)=>{var a=i(199),n=i(394),r={enabled:!1},s={suffix:"-t1"},o={"bike-lane":1.8,"drive-lane":3,divider:.3,"parking-lane":3,sidewalk:3,"sidewalk-tree":3,"turn-lane":3,"bus-lane":3,"light-rail":3,streetcar:3,"sidewalk-wayfinding":3,"sidewalk-lamp":3,"sidewalk-bike-rack":3,"sidewalk-bench":3,"scooter-drop-zone":3,scooter:1.8,bikeshare:3,"flex-zone-curb":3,"transit-shelter":3};function l(t){for(var e=t.objectMixinId,i=void 0===e?"":e,a=t.parentEl,n=void 0===a?null:a,r=t.step,s=void 0===r?15:r,o=t.radius,l=void 0===o?60:o,c=t.rotation,u=void 0===c?"0 0 0":c,m=t.positionXYString,p=void 0===m?"0 0":m,h=t.randomY,g=void 0!==h&&h,f=-1*l;f<=l;f+=s){var v=document.createElement("a-entity");v.setAttribute("class",i),v.setAttribute("position",p+" "+f),v.setAttribute("mixin",i),g?v.setAttribute("rotation","0 "+Math.floor(361*d())+" 0"):v.setAttribute("rotation",u),n.append(v)}}function d(){return Math.random()}function c(t){var e=document.createElement("a-entity");return e.setAttribute("class","stencils-parent"),e.setAttribute("position",t),e}function u(t){var e=document.createElement("a-entity");return e.setAttribute("class","track-parent"),e.setAttribute("position",t+" -0.2 0"),e}function m(t){var e=document.createElement("a-entity");return e.setAttribute("class","safehit-parent"),e.setAttribute("position",t+" 0 0"),e}function p(t){return"colored"===t?"surface-red bus-lane":"grass"===t?"surface-green bus-lane":"bus-lane"}function h(t,e,i){var a="inbound"===t[0]?0:180,n=document.createElement("a-entity");return n.setAttribute("class",e),n.setAttribute("position",i+" 0 0"),n.setAttribute("rotation","0 "+a+" 0"),n.setAttribute("mixin",e),n}function g(t,e){var i=document.createElement("a-entity"),a=90*t,n=document.createElement("a-entity");n.setAttribute("class","bus"),n.setAttribute("position",e+" 1.4 0"),n.setAttribute("rotation","0 "+a+" 0"),n.setAttribute("mixin","bus"),i.append(n);var r=document.createElement("a-entity");return r.setAttribute("class","bus-shadow"),r.setAttribute("position",e+" 0.01 0"),r.setAttribute("rotation","-90 "+a+" 0"),r.setAttribute("mixin","bus-shadow"),i.append(r),i}function f(t,e,i){var a,n,r=document.createElement("a-entity");return n=document.createElement("a-entity"),a="inbound"===t[0]?0:180,n.setAttribute("class","car"),n.setAttribute("position",e+" 0 0"),n.setAttribute("rotation","0 "+a+" 0"),n.setAttribute("mixin","car"),r.append(n),n=document.createElement("a-entity"),a="inbound"===t[0]?-90:90,(n=document.createElement("a-entity")).setAttribute("class","car-shadow"),n.setAttribute("position",e+" 0.01 0"),n.setAttribute("rotation","-90 "+a+" 0"),n.setAttribute("mixin","car-shadow"),r.append(n),r}function v(t){var e,i=document.createElement("a-entity");return(e=document.createElement("a-entity")).setAttribute("position",t+" 1 0"),e.setAttribute("mixin","wayfinding-box"),i.append(e),(e=document.createElement("a-entity")).setAttribute("position",t+" 1.2 0.06"),e.setAttribute("geometry","primitive: plane; width: 0.8; height: 1.6"),e.setAttribute("material","src:#wayfinding-map"),i.append(e),(e=document.createElement("a-entity")).setAttribute("position",t+" 1.2 -0.06"),e.setAttribute("rotation","0 180 0"),e.setAttribute("geometry","primitive: plane; width: 0.8; height: 1.6"),e.setAttribute("material","src:#wayfinding-map"),i.append(e),i}function b(t){var e=document.createElement("a-entity");return e.setAttribute("class","bench-parent"),e.setAttribute("position",t+" 0 3.5"),e}function x(t,e,i){var a=document.createElement("a-curve");return a.setAttribute("id",t),a.innerHTML='\n        <a-curve-point id="checkpoint1" position="'.concat(e," 0 ").concat(75*i,'"></a-curve-point>\n        <a-curve-point id="checkpoint2" position="').concat(e,' 0 0"></a-curve-point>\n        <a-curve-point id="checkpoint3" position="').concat(e," 0 ").concat(-75*i,'"></a-curve-point>\n      '),a}function y(t){var e=document.createElement("a-entity");return e.setAttribute("class","bikerack-parent"),e.setAttribute("position",t+" 0 -3.5"),e}function w(t,e){var i=document.createElement("a-entity");i.setAttribute("class","bikeshare"),i.setAttribute("position",t+" 0 0"),i.setAttribute("mixin","bikeshare");var a="left"===e[0]?90:270;return i.setAttribute("rotation","0 "+a+" 0"),i}function A(t){var e=document.createElement("a-entity");return e.setAttribute("class","tree-parent"),e.setAttribute("position",t+" 0 7"),e}function E(t){var e=document.createElement("a-entity");return e.setAttribute("class","lamp-parent"),e.setAttribute("position",t+" 0 0"),e}function _(t,e,i){var a=document.createElement("a-entity");return a.setAttribute("class","bus-stop"),a.setAttribute("position",t+.75*e+" 0 0"),a.setAttribute("rotation","-90 "+i+" 0"),a.setAttribute("mixin","bus-stop"),a}function M(t,e,i,a,n){var r=document.createElement("a-entity");return r.setAttribute("scale",t+" 1 1"),r.setAttribute("position",e+" "+i+" 0"),r.setAttribute("rotation","270 "+a+" 0"),r.setAttribute("mixin",n+s.suffix),r}t.exports.processSegments=function(t){var e=function(t){var e=document.createElement("a-entity"),i=0-n.calcStreetWidth(t)/2;return e.setAttribute("position",i+" 0 0"),e}(t=function(t){function e(t){return"lane"===t.slice(t.length-4)||"light-rail"===t||"streetcar"===t}return t.reduce((function(t,i,a,n){if(0===a)return t.concat(i);var r=n[a-1];if(e(i.type)&&e(r.type)){var s="solid";i.type===r.type&&(s="dashed"),("drive-lane"===i.type&&"turn-lane"===r.type||"drive-lane"===r.type&&"turn-lane"===i.type)&&(s="dashed"),i.variantString.split("|")[0]!==r.variantString.split("|")[0]&&(s="doubleyellow","bike-lane"===i.type&&"bike-lane"===r.type&&(s="shortdashedyellow")),"turn-lane"===i.type&&"shared"===i.variantString.split("|")[1]?s="soliddashedyellow":"turn-lane"===r.type&&"shared"===r.variantString.split("|")[1]&&(s="soliddashedyellowinverted"),t.push({type:"separator",variantString:s,width:0})}return(e(i.type)&&"divider"===r.type||e(r.type)&&"divider"===i.type)&&t.push({type:"separator",variantString:"solid",width:0}),t.push(i),t}),[])}(t));e.classList.add("street-parent");for(var i,r=0,s=0;s<t.length;s++){var d=document.createElement("a-entity");d.classList.add("segment-parent-"+s);var S=t[s].type,k=.3048*t[s].width,j=k/o[S],C=(r+=k)-.5*k,R=0,T=t[s].variantString.split("|"),I="inbound"===T[0]?180:0,D="outbound"===T[0]?1:-1,B=t[s].type;if("drive-lane"===t[s].type&&"sharrow"===T[1]){var L=c(C+" 0.015 0");l({objectMixinId:"stencils sharrow",parentEl:L,rotation:"-90 "+I+" 0",step:10,radius:70}),d.append(L)}else if("bike-lane"===t[s].type||"scooter"===t[s].type){var P=c(C+" 0.015 0");B="red"===(i=T[1])?"surface-red bike-lane":"green"===i?"surface-green bike-lane":"bike-lane",l({objectMixinId:"stencils bike-lane",parentEl:P,rotation:"-90 "+I+" 0",step:20,radius:70}),d.append(P)}else if("light-rail"===t[s].type||"streetcar"===t[s].type){B=p(T[1]);var O="streetcar"===t[s].type?"trolley":"tram",F="path-"+s;d.append(x(F,C,D)),d.append(h(T,O,C));var H=u(C);l({objectMixinId:"track",parentEl:H,step:20.25,radius:80}),d.append(H)}else if("turn-lane"===t[s].type){B="drive-lane";var U=T[1];"inbound"===T[0]&&(U=U.replace(/left|right/g,(function(t){return"left"===t?"right":"left"}))),"shared"===T[1]&&(U="left"),"left-right-straight"===T[1]&&(U="all");var N="stencils "+U,z=c(C+" 0.015 0");if(l({objectMixinId:N,parentEl:z,rotation:"-90 "+I+" 0",step:15,radius:70}),d.append(z),"shared"===T[1]){var V=c(C+" 0.015 "+-3*D);l({objectMixinId:N,parentEl:V,rotation:"-90 "+(I+180)+" 0",step:15,radius:70}),d.append(V)}}else if("divider"===t[s].type&&"bollard"===T[0]){B="divider";var q=m(C);l({objectMixinId:"safehit",parentEl:q,step:4,radius:70}),d.append(q)}else if("bus-lane"===t[s].type){B=p(T[1]),d.append(g(D,C));var G=void 0;l({objectMixinId:"stencils word-bus",parentEl:G=c(C+" 0.015 0"),rotation:"-90 "+I+" 0",step:50,radius:70}),d.append(G),l({objectMixinId:"stencils word-taxi",parentEl:G=c(C+" 0.015 10"),rotation:"-90 "+I+" 0",step:50,radius:70}),d.append(G),l({objectMixinId:"stencils word-only",parentEl:G=c(C+" 0.015 20"),rotation:"-90 "+I+" 0",step:50,radius:70}),d.append(G)}else if("drive-lane"===t[s].type)d.append(f(T,C));else if("sidewalk-wayfinding"===t[s].type)d.append(v(C));else if("sidewalk-bench"===t[s].type){var J=b(C),Y="right"===T[0]?-90:90;"center"===T[0]||(l({objectMixinId:"bench",parentEl:J,rotation:"0 "+Y+" 0"}),d.append(J))}else if("sidewalk-bike-rack"===t[s].type){var W=y(C);l({objectMixinId:"bikerack",parentEl:W,rotation:"0 "+("sidewalk-parallel"===T[1]?90:0)+" 0"}),d.append(W)}else if("bikeshare"===t[s].type)d.append(w(C,T));else if("sidewalk-tree"===t[s].type){var X=A(C);l({objectMixinId:O="palm-tree"===T[0]?"palm-tree":"tree3",parentEl:X,randomY:!0}),d.append(X)}else if("sidewalk-lamp"!==t[s].type||"modern"!==T[1]&&"pride"!==T[1])if("sidewalk-lamp"===t[s].type&&"traditional"===T[1]){var Q=E(C);l({objectMixinId:"lamp-traditional",parentEl:Q}),d.append(Q)}else if("transit-shelter"===t[s].type){var K="right"===T[0]?0:180,Z="right"===T[0]?1:-1;d.append(_(C,Z,K))}else"separator"===t[s].type&&"dashed"===T[0]?(B="markings dashed-stripe",R+=.01,j=1):"separator"===t[s].type&&"solid"===T[0]?(B="markings solid-stripe",R+=.01,j=1):"separator"===t[s].type&&"doubleyellow"===T[0]?(B="markings solid-doubleyellow",R+=.01,j=1):"separator"===t[s].type&&"shortdashedyellow"===T[0]?(B="markings yellow short-dashed-stripe",R+=.01,j=1):"separator"===t[s].type&&"soliddashedyellow"===T[0]?(B="markings yellow solid-dashed",R+=.01,j=1):"separator"===t[s].type&&"soliddashedyellowinverted"===T[0]?(B="markings yellow solid-dashed",R+=.01,j=1,I="180"):"parking-lane"===t[s].type&&(B="drive-lane");else{var $=E(C);l({objectMixinId:"lamp-modern",parentEl:$,rotation:"0 "+("right"===T[0]?-90:90)+" 0"}),d.append($),"both"===T[0]&&l({objectMixinId:"lamp-modern",parentEl:$,rotation:"0 -90 0"}),"pride"!==T[1]||"right"!==T[0]&&"both"!==T[0]||l({objectMixinId:"pride-flag",parentEl:$,positionXYString:"0.409 3.345"}),"pride"!==T[1]||"left"!==T[0]&&"both"!==T[0]||l({objectMixinId:"pride-flag",parentEl:$,rotation:"0 -180 0",positionXYString:"-0.409 3.345"})}a.isSidewalk(t[s].type)&&(B="sidewalk"),d.append(M(j,C,R,I,B)),e.append(d)}return e},t.exports.processBuildings=function(t,e){var i=[t.leftBuildingVariant,t.rightBuildingVariant],s=JSON.stringify(a.getAmbientSoundJSON(i)),o=document.createElement("a-entity");o.setAttribute("create-from-json","jsonString",s),e.appendChild(o),i.forEach((function(i,s){var o=0===s?"left":"right",l="left"===o?-1:1,c=(75+n.calcStreetWidth(t.segments)/2)*l,u=JSON.stringify(a.createGroundArray(i)),m=document.createElement("a-entity");if(m.setAttribute("create-from-json","jsonString",u),m.setAttribute("position",c+" 0 0"),e.appendChild(m),"narrow"===i||"wide"===i){var p=a.createBuildingsArray(maxLength=150);if(r.enabled)[{id:"SM3D_Bld_Mixed_4fl",width:5.25221},{id:"SM3D_Bld_Mixed_Double_5fl",width:10.9041},{id:"SM3D_Bld_Mixed_4fl_2",width:5.58889},{id:"SM3D_Bld_Mixed_5fl",width:6.47593},{id:"SM3D_Bld_Mixed_Corner_4fl",width:6.94809}].forEach((function(t,i){var n=a.filterBuildingsArrayByMixin(p,t.id),r=a.removePropertyFromArray(n,"mixin"),s=JSON.stringify(r),d=document.createElement("a-entity");d.setAttribute("position",c+-72*l+" 0 "+75*l),d.setAttribute("rotation","0 "+90*l+" 0"),d.setAttribute("mixin",t.id),d.setAttribute("create-from-json","jsonString",s),d.setAttribute("instancedmesh","inheritMat: false; frustumCulled: false; center: true; bottomAlign: true"),d.setAttribute("class","block-instance-"+o),e.appendChild(d)}));else{var h=JSON.stringify(p);(v=document.createElement("a-entity")).setAttribute("position",c+-72*l+" 0 "+75*l),v.setAttribute("rotation","0 "+90*l+" 0"),v.setAttribute("create-from-json","jsonString",h),v.setAttribute("id","block-"+o),e.appendChild(v)}}if("residential"===i){var g=a.createBuildingsArray(maxLength=150,buildingType="residential");h=JSON.stringify(g),(v=document.createElement("a-entity")).setAttribute("position",c+-64*l+" -0.75 "+75*l),v.setAttribute("rotation","0 "+90*l+" 0"),v.setAttribute("create-from-json","jsonString",h),v.setAttribute("id","suburbia-"+o),e.appendChild(v)}if("waterfront"===i){var f=c-150*l/2;(v=document.createElement("a-entity")).setAttribute("class","seawall-parent"),v.setAttribute("position",f+" 0 10"),v.setAttribute("id","seawall-parent-"+c),e.appendChild(v),function(t){for(var e=t.objectMixinId,i=void 0===e?"":e,a=t.parentId,n=void 0===a?"":a,r=t.step,s=void 0===r?15:r,o=t.radius,l=void 0===o?60:o,c=t.rotation,u=void 0===c?"0 0 0":c,m=t.positionXYString,p=void 0===m?"0 0":m,h=t.randomY,g=void 0!==h&&h,f=-1*l;f<=l;f+=s){var v=document.createElement("a-entity");v.setAttribute("class",i),v.setAttribute("position",p+" "+f),v.setAttribute("mixin",i),g?v.setAttribute("rotation","0 "+Math.floor(361*d())+" 0"):v.setAttribute("rotation",u),document.getElementById(n).appendChild(v)}}({objectMixinId:"seawall",parentId:"seawall-parent-"+c,rotation:"-90 "+(x="right"===o?-90:90)+" 0",step:15,radius:70})}if("fence"===i||"parking-lot"===i){var v,b=c-150*l/2;(v=document.createElement("a-entity")).setAttribute("class","fence-parent"),v.setAttribute("position",b+" 0 0"),v.setAttribute("id","fence-parent-"+c);var x="right"===o?-90:90,y=JSON.stringify(a.createClonedEntitiesArray({mixin:"fence",rotation:"0 "+x+" 0",step:9.25,radius:70}));v.setAttribute("create-from-json","jsonString: "+y),e.appendChild(v)}}))}},234:()=>{var t,e;t=!1,e=new THREE.FileLoader,window.AFRAME.registerElement("streetmix-assets",{prototype:Object.create(window.AFRAME.ANode.prototype,{createdCallback:{value:function(){this.setAttribute("src",""),this.isAssetItem=!0,this.isAssets=!0,this.fileLoader=e,this.timeout=null}},attachedCallback:{value:function(){if(!t){var e;this.parentNode&&this.parentNode.hasLoaded&&console.warn("Assets have already loaded. streetmix-assets may have problems"),t=!0,this.innerHTML=((e=this.getAttribute("url"))||(e="https://unpkg.com/streetmix3d@0.0.4/"),console.log("Using streetmix assets from",e),'\n          \x3c!-- audio --\x3e\n          <audio id="ambientmp3" src="'.concat(e,'assets/audio/SSL_16_11_AMB_EXT_SF_ALAMO_SQ.mp3" preload="none" crossorigin="anonymous"></audio>\n          <audio id="tram-pass-mp3" src="').concat(e,'assets/audio/Tram-Pass-By-Fast-shortened.mp3" preload="auto" crossorigin="anonymous"></audio>\n          <audio id="trolley-pass-mp3" src="').concat(e,'assets/audio/Streetcar-passing.mp3" preload="auto" crossorigin="anonymous"></audio>\n          <audio id="suburbs-mp3" src="').concat(e,'assets/audio/AMB_Suburbs_Afternoon_Woods_Spring_Small_ST_MKH8050-30shortened_amplified.mp3" preload="none" crossorigin="anonymous"></audio>\n          <audio id="parking-lot-mp3" src="').concat(e,'assets/audio/Parking_lot_ambience_looping.mp3" preload="none" crossorigin="anonymous"></audio>\n          <audio id="waterfront-mp3" src="').concat(e,'assets/audio/combined_UKdock4_and_water_pier_underneath_ambience.mp3" preload="none" crossorigin="anonymous"></audio>\n          <audio id="suburbs2-mp3" src="').concat(e,'assets/audio/AMB_Suburbs_Spring_Day_Lawnmowers_Birds_MS_ST_MKH8050-30shortened.mp3" preload="none" crossorigin="anonymous"></audio>\n  \n          \x3c!-- sidewalk props --\x3e\n          <a-asset-item id="treemodel3" src="').concat(e,'assets/objects/SM_Env_Tree_03.gltf"></a-asset-item>\n          <a-asset-item id="palmtreemodel" src="').concat(e,'assets/objects/PalmTree.gltf"></a-asset-item>\n          <a-asset-item id="benchmodel" src="').concat(e,'assets/objects/SM_Prop_ParkBench_02.gltf"></a-asset-item>\n          <a-asset-item id="bikerackmodel" src="').concat(e,'assets/objects/bikerack.glb"></a-asset-item>\n          <a-asset-item id="bikesharemodel" src="').concat(e,'assets/objects/bikeshare.glb"></a-asset-item>\n          <a-asset-item id="lamp-modern-glb" src="').concat(e,'assets/objects/lamp-post-modern-centered.glb"></a-asset-item>\n          <a-asset-item id="lamp-traditional-glb" src="').concat(e,'assets/objects/lamp-post-traditional.glb"></a-asset-item>\n          <a-asset-item id="bus-stop-glb" src="').concat(e,'assets/objects/ccFO2EGGIq9-bus-stop.glb"></a-asset-item>\n          <img id="wayfinding-map" src="').concat(e,'assets/objects/wayfinding.jpg" crossorigin="anonymous" />\n  \n          \x3c!-- vehicles --\x3e\n          <a-asset-item id="trammodel" src="').concat(e,'assets/objects/tram_siemens_avenio.gltf"></a-asset-item>\n          <a-asset-item id="trolleymodel" src="').concat(e,'assets/objects/godarvilletram.gltf"></a-asset-item>\n          <a-asset-item id="xd40" src="').concat(e,'assets/objects/bus/xd40-draco.glb"></a-asset-item>\n          <a-asset-item id="carmodel" src="').concat(e,'assets/objects/SM_Veh_Car_Sedan_01.gltf"></a-asset-item>\n  \n          \x3c!-- blocks --\x3e\n          <a-asset-item id="blockmodel" src="').concat(e,'assets/objects/buildings.glb"></a-asset-item>\n          <a-asset-item id="suburbiamodel" src="').concat(e,'assets/objects/suburbia/suburbia-fixwindowuvs-only3-draco.glb"></a-asset-item>\n  \n          <a-asset-item id="fence-model" src="').concat(e,'assets/objects/fence4/fence4.gltf"></a-asset-item>\n          <a-asset-item id="seawall-model" src="').concat(e,'assets/objects/seawall.gltf"></a-asset-item>\n  \n          \x3c!-- lane objects --\x3e\n          <a-asset-item id="trackmodel" src="').concat(e,'assets/objects/track.gltf"></a-asset-item>\n          <a-asset-item id="flexiguide-glb" src="').concat(e,'assets/objects/flexiguide300.glb"></a-asset-item>\n          <img id="stencils-atlas" src="').concat(e,'assets/materials/stencils-atlas_2048.png" crossorigin="anonymous" />\n          <img id="markings-atlas" src="').concat(e,'assets/materials/lane-markings-atlas_1024.png" crossorigin="anonymous" />\n  \n          \x3c!-- optimized textures - used by default --\x3e\n          <img id="seamless-road" src="').concat(e,'assets/materials/TexturesCom_Roads0086_1_seamless_S_rotate.jpg" crossorigin="anonymous">\n          <img id="hatched-base" src="').concat(e,'assets/materials/hatched_Base_Color.jpg" crossorigin="anonymous">\n          <img id="hatched-normal" src="').concat(e,'assets/materials/hatched_Normal.jpg" crossorigin="anonymous">\n          <img id="seamless-sidewalk" src="').concat(e,'assets/materials/TexturesCom_FloorsRegular0301_1_seamless_S.jpg" crossorigin="anonymous">\n          <a-mixin id="drive-lane-t1" geometry="width:3;height:150;primitive:plane" material="repeat:0.3 25;offset:0.55 0;src:#seamless-road;"></a-mixin>\n          <a-mixin id="bike-lane-t1" geometry="width:1.8;height:150;primitive:plane" material="repeat:0.3 25;offset:0.55 0;roughness:1;metalness:0;src:#seamless-road;"></a-mixin>\n          <a-mixin id="sidewalk-t1" anisotropy geometry="width:3;height:150;primitive:plane" material="repeat:1.5 75;src:#seamless-sidewalk;"></a-mixin>\n          <a-mixin id="bus-lane-t1" geometry="width:3;height:150;primitive:plane" material="repeat:0.3 25;offset:0.55 0;src:#seamless-road;"></a-mixin>\n          <a-mixin id="divider-t1" geometry="width:0.3;height:150;primitive:plane" material="repeat:1 150;offset:0.415 0;normalTextureOffset:0.415 0;src:#hatched-base;normalTextureRepeat:0.21 150;normalMap:#hatched-normal"></a-mixin>\n          <a-mixin id="safehit" gltf-model="#flexiguide-glb" scale="1 1 1"></a-mixin>\n  \n          \x3c!-- lane separator markings atlas --\x3e\n          <a-mixin id="markings" anisotropy atlas-uvs="totalRows: 1; totalColumns: 8; row: 1" scale="1 1 1" material="src: #markings-atlas;alphaTest: 0;transparent:true;repeat:1 25;" geometry="primitive: plane; buffer: false; skipCache: true; width:0.2; height:150;"></a-mixin>\n          <a-mixin id="solid-stripe-t1" atlas-uvs="column: 3"></a-mixin>\n          <a-mixin id="dashed-stripe-t1" atlas-uvs="column: 4"></a-mixin>\n          <a-mixin id="short-dashed-stripe-t1" atlas-uvs="column: 4" material="repeat:1 50;"></a-mixin>\n          <a-mixin id="solid-doubleyellow-t1" atlas-uvs="totalColumns: 4; column: 3" geometry="width: 0.5"></a-mixin>\n          <a-mixin id="solid-dashed-t1" atlas-uvs="totalColumns: 4; column: 2" geometry="width: 0.4"></a-mixin>\n  \n          \x3c!-- color modifier mixins --\x3e\n          <a-mixin id="yellow" material="color:#f7d117"></a-mixin>\n          <a-mixin id="surface-green" material="color:#adff83"></a-mixin>\n          <a-mixin id="surface-red" material="color:#ff9393"></a-mixin>\n  \n          \x3c!-- stencils atlas --\x3e\n          <a-mixin id="stencils" anisotropy atlas-uvs="totalRows: 4; totalColumns: 4" scale="2 2 2" material="src: #stencils-atlas;alphaTest: 0;transparent:true;" geometry="primitive: plane; buffer: false; skipCache: true"></a-mixin>\n          <a-mixin id="right" atlas-uvs="column: 3; row: 2"></a-mixin>\n          <a-mixin id="left" atlas-uvs="column: 3; row: 3"></a-mixin>\n          <a-mixin id="both" atlas-uvs="column: 2; row: 1"></a-mixin>\n          <a-mixin id="all" atlas-uvs="column: 3; row: 1"></a-mixin>\n          <a-mixin id="left-straight" atlas-uvs="column: 2; row: 3"></a-mixin>\n          <a-mixin id="right-straight" atlas-uvs="column: 2; row: 2"></a-mixin>\n          <a-mixin id="straight" atlas-uvs="column: 2; row: 4"></a-mixin>\n          <a-mixin id="sharrow" atlas-uvs="totalRows: 4; totalColumns: 8; column: 2; row: 3" scale="1.5 3 1"></a-mixin>\n          <a-mixin id="bike-lane" atlas-uvs="totalRows: 2; totalColumns: 8; column: 1; row: 2" scale="1 4 1"></a-mixin>\n          <a-mixin id="word-bus" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 4" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-lane" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 4" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-taxi" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 3" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-only" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 3" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-yield" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 2" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-slow" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 2" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-xing" atlas-uvs="totalRows: 8; totalColumns: 8; column: 1; row: 1" scale="3 3 3"></a-mixin>\n          <a-mixin id="word-stop" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 1" scale="3 3 3"></a-mixin>\n          <a-mixin id="perpendicular-stalls" atlas-uvs="totalRows: 4; totalColumns: 8; column: 5; row: 4" scale="5 10 5"></a-mixin>\n          <a-mixin id="parking-delimiter" atlas-uvs="totalRows: 8; totalColumns: 8; column: 2; row: 7" scale="1.8 1.8 1.8"></a-mixin>\n  \n          \x3c!-- vehicles --\x3e\n          <a-mixin id="bus" anisotropy gltf-model="#xd40" scale="1.55 1.55 1.55"></a-mixin>\n          <a-mixin id="car" gltf-model="#carmodel"></a-mixin>\n          <a-mixin id="tram" anisotropy gltf-model="#trammodel" sound="src: #tram-pass-mp3;positional:false;volume: 0.4"></a-mixin>\n          <a-mixin id="trolley" gltf-model="#trolleymodel" sound="src: #trolley-pass-mp3;positional:false;volume: 0.4"scale="1 1 1"></a-mixin>\n\n          <img id="shadow-texture" src="').concat(e,'assets/materials/bus-shadow.png" crossorigin="anonymous">\n          <a-mixin id="bus-shadow" geometry="width: 12; height: 3; primitive: plane"  material="src: #shadow-texture; alphaTest: 0;transparent:true; roughness: 1;" ></a-mixin>\n          <a-mixin id="car-shadow" geometry="width: 4.7; height: 2.5; primitive: plane"  material="src: #shadow-texture; alphaTest: 0;transparent:true; roughness: 1;" ></a-mixin>\n  \n          \x3c!-- street props --\x3e\n          <a-mixin id="tree3" gltf-model="#treemodel3" scale="1.25 1.25 1.25"></a-mixin>\n          <a-mixin id="palm-tree" gltf-model="#palmtreemodel" scale="1 1.5 1"></a-mixin>\n          <a-mixin id="bench" gltf-model="#benchmodel" scale="1 1 1"></a-mixin>\n          <a-mixin id="track" gltf-model="#trackmodel" scale="1 1 1"></a-mixin>\n          <a-mixin id="bikerack" gltf-model="#bikerackmodel" scale="0.25 0.25 0.25"></a-mixin>\n          <a-mixin id="bikeshare" gltf-model="#bikesharemodel" scale="1 1 1"></a-mixin>\n          <a-mixin id="lamp-modern" gltf-model="#lamp-modern-glb" scale="0.5 0.5 0.5"></a-mixin>\n          <a-mixin id="lamp-traditional" gltf-model="#lamp-traditional-glb" scale="0.2 0.2 0.2" ></a-mixin>\n          <a-mixin id="pride-flag" position="0.409 3.345 0" rotation="0 0 0" scale="0.5 0.75 0" geometry="width:2;height:2;primitive:plane" material="side:double; src:').concat(e,'assets/materials/rainbow-flag-poles_512.png;transparent: true;"></a-mixin>\n          <a-mixin id="bus-stop" gltf-model="#bus-stop-glb" rotation="-90 0 0" scale="0.001 0.001 0.001" ></a-mixin>\n          <a-mixin id="wayfinding-box" geometry="primitive: box; height: 2; width: 0.84; depth: 0.1" material="color: gray"></a-mixin>\n  \n          \x3c!-- buildings and blocks --\x3e\n          <a-mixin id="block" gltf-model="#blockmodel" scale="1 1 1"></a-mixin>\n          <a-mixin id="suburbia" gltf-model="#suburbiamodel" scale="1 1 1"></a-mixin>\n  \n          <a-mixin id="SM3D_Bld_Mixed_Corner_4fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_Corner_4fl" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_Double_5fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_Double_5fl" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_4fl_2" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_4fl_2" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_5fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_5fl" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM3D_Bld_Mixed_4fl" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #blockmodel; part: SM3D_Bld_Mixed_4fl" model-center="bottomAlign: true"></a-mixin>\n  \n          <a-mixin id="SM_Bld_House_Preset_03_1800" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #suburbiamodel; part: SM_Bld_House_Preset_03_1800" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM_Bld_House_Preset_08_1809" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #suburbiamodel; part: SM_Bld_House_Preset_08_1809" model-center="bottomAlign: true"></a-mixin>\n          <a-mixin id="SM_Bld_House_Preset_09_1845" scale="1 1 1" rotation="0 0 0" gltf-part-plus="src: #suburbiamodel; part: SM_Bld_House_Preset_09_1845" model-center="bottomAlign: true"></a-mixin>\n  \n          <a-mixin id="seawall" gltf-model="#seawall-model" scale="1 1 1" rotation="0 0 0"></a-mixin>\n          <a-mixin id="fence" gltf-model="#fence-model" scale="0.1 0.1 0.1"></a-mixin>\n  \n          \x3c!-- grounds --\x3e\n          <img id="grass-texture" src="').concat(e,'assets/materials/TexturesCom_Grass0052_1_seamless_S.jpg" crossorigin="anonymous">\n          <img id="parking-lot-texture" src="').concat(e,'assets/materials/TexturesCom_Roads0111_1_seamless_S.jpg" crossorigin="anonymous">\n          <img id="asphalt-texture" src="').concat(e,'assets/materials/TexturesCom_AsphaltDamaged0057_1_seamless_S.jpg" crossorigin="anonymous">\n\n          <a-mixin id="ground-grass" rotation="-90 0 0" geometry="primitive:plane;height:150;width:150" material="src:#grass-texture;repeat:5 5;roughness:1"></a-mixin>\n          <a-mixin id="ground-parking-lot" rotation="-90 0 0" geometry="primitive:plane;height:150;width:150" material="src:#parking-lot-texture;repeat:2 4;roughness:1"></a-mixin>\n          <a-mixin id="ground-asphalt" rotation="-90 0 0" geometry="primitive:plane;height:150;width:150" material="src:#asphalt-texture;repeat:5 5;roughness:1"></a-mixin>\n  \n          \x3c!-- ui / future use --\x3e\n          <img id="subtitle" src="').concat(e,'assets/materials/subtitle.png" crossorigin="anonymous" />\n  '));var i=this.parentNode;this.setAttribute("timeout",i.getAttribute("timeout")),this.parentNode.isScene=!0,Object.getPrototypeOf(i).attachedCallback.call(this),this.parentNode.isScene=!1}}},load:{value:function(){AFRAME.ANode.prototype.load.call(this,null,(function(t){return t.isAssetItem&&t.hasAttribute("src")}))}}})}),window.addEventListener("DOMContentLoaded",(function(e){if(!t){var i=document.querySelector("a-assets");i||(i=document.createElement("a-assets")),i.hasLoaded&&console.warn("Assets already loaded. May lead to bugs");var a=document.createElement("streetmix-assets");i.append(a),document.querySelector("a-scene").append(i)}})),document.addEventListener("DOMSubtreeModified",(function t(e){if("A-SCENE"===e.target.nodeName){var i=e.target.querySelector("a-assets");if(i||(i=document.createElement("a-assets"),e.target.append(i)),i.querySelector("streetmix-assets"))document.removeEventListener("DOMSubtreeModified",t);else{var a=document.createElement("streetmix-assets");i.append(a),document.removeEventListener("DOMSubtreeModified",t)}}}),!1)},391:(t,e,i)=>{var a=i(334);AFRAME.registerComponent("create-from-json",{schema:{jsonString:{type:"string",default:""}},update:function(t){var e=this.data,i=this.el;if(t.string&&e.string!==t.string)for(;i.firstChild;)i.removeChild(i.lastChild);a.appendChildElementsFromArray(JSON.parse(e.jsonString),i)}})},579:(t,e,i)=>{var a=i(844);i(234),i(956),i(391),i(415),i(125),i(631),i(485),AFRAME.registerComponent("street",{schema:{JSON:{type:"string"},type:{default:"streetmixSegmentsFeet"},right:{default:""},left:{default:""}},update:function(t){var e=this.data;this.el.innerHTML="";var i=JSON.parse(e.JSON);console.log(i);var n=a.processSegments(i.streetmixSegmentsFeet);this.el.append(n),e.buildings&&a.processBuildings(streetObject,buildingsEl)}})},415:()=>{!function(t){var e={};function i(a){if(e[a])return e[a].exports;var n=e[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=t,i.c=e,i.p="",i(0)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("alongpath",{schema:{curve:{default:""},triggers:{default:"a-curve-point"},triggerRadius:{type:"number",default:.01},dur:{default:1e3},delay:{default:0},loop:{default:!1},rotate:{default:!1},resetonplay:{default:!0}},init:function(){},update:function(t){this.curve=document.querySelector(this.data.curve),this.triggers=this.curve.querySelectorAll(this.data.triggers),this.curve?this.initialPosition=this.el.object3D.position:console.warn("Curve not found. Can't follow anything..."),this.reset()},reset:function(){this.interval=0,this.el.removeState("endofpath"),this.el.removeState("moveonpath"),this.activeTrigger&&(this.activeTrigger.removeState("alongpath-active-trigger"),this.activeTrigger=null)},getI_:function(t,e,i){return t-e>=i?1:t-e<0?0:(t-e)/i},tick:function(t,e){var i=this.curve.components.curve?this.curve.components.curve.curve:null;if(i){if(!this.el.is("endofpath")){this.interval=this.interval+e;var a=this.getI_(this.interval,this.data.delay,this.data.dur);if(!1===this.data.loop&&a>=1)this.el.setAttribute("position",i.points[i.points.length-1]),this.el.removeState("moveonpath"),this.el.addState("endofpath"),this.el.emit("movingended");else if(!0===this.data.loop&&a>=1)this.el.removeState("moveonpath"),this.el.emit("movingended"),this.interval=this.data.delay;else{this.el.is("moveonpath")||(this.el.addState("moveonpath"),this.el.emit("movingstarted"));var n=i.getPoint(a);this.el.setAttribute("position",n)}if(!0===this.data.rotate){var r=this.interval+e,s=i.getPoint(this.getI_(r,this.data.delay,this.data.dur));this.el.object3D.lookAt(s)}this.triggers&&this.triggers.length>0&&this.updateActiveTrigger()}}else console.error("The entity associated with the curve property has no curve component.")},play:function(){this.data.resetonplay&&this.reset()},remove:function(){this.el.object3D.position.copy(this.initialPosition)},updateActiveTrigger:function(){for(var t=0;t<this.triggers.length;t++)if(this.triggers[t].object3D){if(this.triggers[t].object3D.position.distanceTo(this.el.object3D.position)<=this.data.triggerRadius){this.activeTrigger&&this.activeTrigger!=this.triggers[t]?(this.activeTrigger.removeState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-deactivated"),this.activeTrigger=this.triggers[t],this.activeTrigger.addState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-activated")):this.activeTrigger||(this.activeTrigger=this.triggers[t],this.activeTrigger.addState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-activated"));break}this.activeTrigger&&this.activeTrigger==this.triggers[t]&&(this.activeTrigger.removeState("alongpath-active-trigger"),this.activeTrigger.emit("alongpath-trigger-deactivated"),this.activeTrigger=null)}}})}])},199:t=>{t.exports.isSidewalk=function(t){return t.startsWith("sidewalk")||["scooter-drop-zone","bikeshare","flex-zone-curb","transit-shelter"].includes(t)},t.exports.createBuildingsArray=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"narrow";"narrow"===a||"wide"===a?(t=[{id:"SM3D_Bld_Mixed_4fl",width:5.25221},{id:"SM3D_Bld_Mixed_Double_5fl",width:10.9041},{id:"SM3D_Bld_Mixed_4fl_2",width:5.58889},{id:"SM3D_Bld_Mixed_5fl",width:6.47593},{id:"SM3D_Bld_Mixed_Corner_4fl",width:6.94809}],e="41431323432402434130303230234102402341"):"residential"===a&&(t=[{id:"SM_Bld_House_Preset_03_1800",width:20},{id:"SM_Bld_House_Preset_08_1809",width:20},{id:"SM_Bld_House_Preset_09_1845",width:20}],e="12021201210101212021201012012021201210");for(var n=0,r=0,s=[];r<i;){var o=t[parseInt(e[n])],l={tag:"a-entity",mixin:o.id,position:r+o.width/2+" 0 0"};s.push(l),r+=o.width,n++}return s},t.exports.filterBuildingsArrayByMixin=function(t,e){var i=[];return t.forEach((function(t,a){t.mixin===e&&i.push(t)})),i},t.exports.removePropertyFromArray=function(t,e){return t.forEach((function(t,i){delete t[e]})),t},t.exports.createClonedEntitiesArray=function(t){for(var e=t.mixin,i=void 0===e?"":e,a=t.step,n=void 0===a?15:a,r=t.radius,s=void 0===r?60:r,o=t.rotation,l=void 0===o?"0 0 0":o,d=t.positionXYString,c=void 0===d?"0 0":d,u=t.randomY,m=void 0!==u&&u,p=[],h=-1*s;h<=s;h+=n){var g={tag:"a-entity",position:c+" "+h};i&&(g.class=i,g.mixin=i),g.rotation=m?"0 "+Math.floor(361*randomTestable())+" 0":l,p.push(g)}return p},t.exports.getAmbientSoundJSON=function(t){var e={fence:"#suburbs-mp3",grass:"#suburbs-mp3","parking-lot":"#parking-lot-mp3",waterfront:"#waterfront",residential:"#suburbs2-mp3",narrow:"#ambientmp3",wide:"#ambientmp3"},i=[],a=null;return t.forEach((function(t,n){if(!a||a!==e[t]){var r={tag:"a-entity",class:"playme",sound:"src: "+e[t]+"; positional: false; loop: true"};i.push(r),a=e[t]}})),i},t.exports.createGroundArray=function(t){var e=[],i="ground-grass";if("waterfront"===t)return e;["narrow","wide"].includes(t)&&(i="ground-asphalt"),"parking-lot"===t&&(i="ground-parking-lot");var a={tag:"a-entity",position:"0 -0.2 0",mixin:i};return e.push(a),e}},334:t=>{function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],a=!0,n=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);a=!0);}catch(t){n=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=document.createElement(t.tag);delete t.tag;for(var a=0,n=Object.entries(t);a<n.length;a++){var r=e(n[a],2),s=r[0],o=r[1];i.setAttribute(s,o)}return i}t.exports.createElementFromObject=a,t.exports.appendChildElementsFromArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return t.forEach((function(t,i){e.appendChild(a(t))})),e}},394:t=>{t.exports.streetmixUserToAPI=function(t){var e=new URL(t).pathname.split("/"),i=e[1],a=e[2];return"-"===i?"https://streetmix.net/api/v1/streets?namespacedId="+a:"https://streetmix.net/api/v1/streets?namespacedId="+a+"&creatorId="+i},t.exports.streetmixAPIToUser=function(t){function e(t,e){for(var i=t.split("&"),a=0;a<i.length;a++){var n=i[a].split("=");if(decodeURIComponent(n[0])===e)return decodeURIComponent(n[1])}console.log("Query variable %s not found",e)}var i=new URL(t).search.substring(1),a=e(i,"namespacedId"),n=e(i,"creatorId");return void 0===n&&(n="-"),"https://streetmix.net/"+n+"/"+a},t.exports.calcStreetWidth=function(t){var e=0;return t.forEach((function(t){var i=t.width;e+=.3048*i})),e}}},e={},function i(a){if(e[a])return e[a].exports;var n=e[a]={exports:{}};return t[a](n,n.exports,i),n.exports}(579);var t,e}));